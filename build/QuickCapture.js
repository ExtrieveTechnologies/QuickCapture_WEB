!function webpackUniversalModuleDefinition(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var i=n();for(var r in i)("object"==typeof exports?exports:e)[r]=i[r]}}(this,(()=>(()=>{var __webpack_modules__={521:e=>{function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return n};var e,n={},i=Object.prototype,r=i.hasOwnProperty,a=Object.defineProperty||function(e,n,i){e[n]=i.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",h=c.asyncIterator||"@@asyncIterator",p=c.toStringTag||"@@toStringTag";function define(e,n,i){return Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{define({},"")}catch(e){define=function define(e,n,i){return e[n]=i}}function wrap(e,n,i,r){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype),h=new Context(r||[]);return a(u,"_invoke",{value:makeInvokeMethod(e,i,h)}),u}function tryCatch(e,n,i){try{return{type:"normal",arg:e.call(n,i)}}catch(e){return{type:"throw",arg:e}}}n.wrap=wrap;var d="suspendedStart",f="suspendedYield",m="executing",g="completed",v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var w={};define(w,u,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(values([])));b&&b!==i&&r.call(b,u)&&(w=b);var _=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(w);function defineIteratorMethods(e){["next","throw","return"].forEach((function(n){define(e,n,(function(e){return this._invoke(n,e)}))}))}function AsyncIterator(e,n){function invoke(i,a,c,u){var h=tryCatch(e[i],e,a);if("throw"!==h.type){var p=h.arg,d=p.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?n.resolve(d.__await).then((function(e){invoke("next",e,c,u)}),(function(e){invoke("throw",e,c,u)})):n.resolve(d).then((function(e){p.value=e,c(p)}),(function(e){return invoke("throw",e,c,u)}))}u(h.arg)}var i;a(this,"_invoke",{value:function value(e,r){function callInvokeWithMethodAndArg(){return new n((function(n,i){invoke(e,r,n,i)}))}return i=i?i.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(n,i,r){var a=d;return function(c,u){if(a===m)throw Error("Generator is already running");if(a===g){if("throw"===c)throw u;return{value:e,done:!0}}for(r.method=c,r.arg=u;;){var h=r.delegate;if(h){var p=maybeInvokeDelegate(h,r);if(p){if(p===v)continue;return p}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===d)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var w=tryCatch(n,i,r);if("normal"===w.type){if(a=r.done?g:f,w.arg===v)continue;return{value:w.arg,done:r.done}}"throw"===w.type&&(a=g,r.method="throw",r.arg=w.arg)}}}function maybeInvokeDelegate(n,i){var r=i.method,a=n.iterator[r];if(a===e)return i.delegate=null,"throw"===r&&n.iterator.return&&(i.method="return",i.arg=e,maybeInvokeDelegate(n,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var c=tryCatch(a,n.iterator,i.arg);if("throw"===c.type)return i.method="throw",i.arg=c.arg,i.delegate=null,v;var u=c.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,v)}function pushTryEntry(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function resetTryEntry(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(n){if(n||""===n){var i=n[u];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,c=function next(){for(;++a<n.length;)if(r.call(n,a))return next.value=n[a],next.done=!1,next;return next.value=e,next.done=!0,next};return c.next=c}}throw new TypeError(_typeof(n)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,a(_,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),a(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===GeneratorFunction||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,p,"GeneratorFunction")),e.prototype=Object.create(_),e},n.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,h,(function(){return this})),n.AsyncIterator=AsyncIterator,n.async=function(e,i,r,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(e,i,r,a),c);return n.isGeneratorFunction(i)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},defineIteratorMethods(_),define(_,p,"Generator"),define(_,u,(function(){return this})),define(_,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),i=[];for(var r in n)i.push(r);return i.reverse(),function next(){for(;i.length;){var e=i.pop();if(e in n)return next.value=e,next.done=!1,next}return next.done=!0,next}},n.values=values,Context.prototype={constructor:Context,reset:function reset(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!n)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function dispatchException(n){if(this.done)throw n;var i=this;function handle(r,a){return u.type="throw",u.arg=n,i.next=r,a&&(i.method="next",i.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var c=this.tryEntries[a],u=c.completion;if("root"===c.tryLoc)return handle("end");if(c.tryLoc<=this.prev){var h=r.call(c,"catchLoc"),p=r.call(c,"finallyLoc");if(h&&p){if(this.prev<c.catchLoc)return handle(c.catchLoc,!0);if(this.prev<c.finallyLoc)return handle(c.finallyLoc)}else if(h){if(this.prev<c.catchLoc)return handle(c.catchLoc,!0)}else{if(!p)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return handle(c.finallyLoc)}}}},abrupt:function abrupt(e,n){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===e||"continue"===e)&&c.tryLoc<=n&&n<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=e,u.arg=n,c?(this.method="next",this.next=c.finallyLoc,v):this.complete(u)},complete:function complete(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),v},finish:function finish(e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),resetTryEntry(i),v}},catch:function _catch(e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var a=r.arg;resetTryEntry(i)}return a}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(n,i,r){return this.delegate={iterator:values(n),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),v}},n}function asyncGeneratorStep(e,n,i,r,a,c,u){try{var h=e[c](u),p=h.value}catch(e){return void i(e)}h.done?n(p):Promise.resolve(p).then(r,a)}function _asyncToGenerator(e){return function(){var n=this,i=arguments;return new Promise((function(r,a){var c=e.apply(n,i);function _next(e){asyncGeneratorStep(c,r,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(c,r,a,_next,_throw,"throw",e)}_next(void 0)}))}}function _defineProperties(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,n,i){return n&&_defineProperties(e.prototype,n),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,n,i){return(n=_toPropertyKey(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function _toPropertyKey(e){var n=function _toPrimitive(e,n){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,n||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==_typeof(n)?n:n+""}var n=_createClass((function exWebDocViewer(){var e=this;_classCallCheck(this,exWebDocViewer),_defineProperty(this,"init",function(){var n=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(n,c,h){var p,d,f;return _regeneratorRuntime().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if(n){m.next=2;break}return m.abrupt("return");case 2:if(e.viewerElemId=n,e.verifyConfig(c)){m.next=5;break}return m.abrupt("return");case 5:if(e.appConfig=c,e.viewerRoot=document.getElementById(e.viewerElemId),e.viewerRoot){m.next=9;break}return m.abrupt("return");case 9:if(i.process(),p=null,p=h?r.buildBaseUI(e,!1):r.buildBaseUI(e,!0),a.clearChildren(e.viewerRoot),e.viewerRoot.appendChild(p),r.prepareUI(e),d=e.appConfig.SERVICE_URL,f=e.appConfig.APP_NAME,!h){m.next=23;break}return m.next=20,exWebDocViewerCtrl.init(f,d,n,h);case 20:return e.jsImageWiz=m.sent,e.Twain=h.GetScanner(),m.abrupt("return",e.jsImageWiz);case 23:return m.next=25,exWebDocViewerCtrl.init(f,d,n,null);case 25:return e.jsImageWiz=m.sent,e.jsImageWiz.licence="",e.jsImageWiz.serviceTimeOut=10,e.Twain=exWebDocViewerCtrl.getTwain(),e.initViewerContexMenu(),e.initServiceConnect(),e.notifier=new u,e.Twain.appConfig=e.appConfig,e.Twain.getInfo(),e.AttachPulseEvents(),e.do_reserve(),e.initCommonEvents(),e.runStatusUpdater(),e.twainTimer(),m.abrupt("return",e.jsImageWiz);case 40:case"end":return m.stop()}}),_callee)})));return function(e,i,r){return n.apply(this,arguments)}}()),_defineProperty(this,"initViewerContexMenu",(function(){var e=this.viewerRoot.getElementsByClassName("imageCanVasContainer")[0].getElementsByTagName("canvas");c.init(e[0],null,this)})),_defineProperty(this,"initServiceConnect",(function(){e.ServiceConnect.disConnected=!1,e.ServiceConnect.error=!0,e.ServiceConnect.maxRetryLimit=0,e.ServiceConnect.retryCount=0,e.ServiceConnect.triggerServiceLimit=2,e.ServiceConnect.triggeredCount=0,e.ServiceConnect.timer=null})),_defineProperty(this,"verifyConfig",(function(e){if(e&&Object.keys(e).length&&e.SERVICE_URL&&e.APP_NAME&&e.UI_CONFIG)return!0})),_defineProperty(this,"initCommonEvents",(function(){})),_defineProperty(this,"retryTwainConnect",_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(){return _regeneratorRuntime().wrap((function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:if(!exWebDocViewerCtrl.getTwainStatus().isRequestInProgress){n.next=4;break}return n.abrupt("return");case 4:return e.AttachPulseEvents(),e.do_reserve(),n.abrupt("return",!0);case 7:case"end":return n.stop()}}),_callee2)})))),_defineProperty(this,"getServiceInfo",_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(){return _regeneratorRuntime().wrap((function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.Twain.getInfo();case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),_callee3)})))),_defineProperty(this,"setInterface",(function(n){return e.interface=n,!0})),_defineProperty(this,"have_response",(function(n,i){"reserve"==n.method&&e.reserved(n,i)})),_defineProperty(this,"AttachPulseEvents",(function(){e.Twain.have_response=e.have_response,e.Twain.OnReleased=e.onRelease;var n=e.Twain.pulse;e.Twain.have_image=e.have_image,e.Twain.have_output=e.have_image,e.Twain.have_thumbnail=e.have_image,n.addEventListener("acquire/file",e.AcquiredFilePulse),n.addEventListener("acquire/folder",e.AcquiredFolderPulse),n.addEventListener("twain/source/enable",e.AcquiredFilePulse)})),_defineProperty(this,"AcquiredFilePulse",(function(n){var i=e.GetCustomEventData(e.Twain.pulse,n);i.data&&("completed"==i.status?e.AcquiredFileCompleted(i):e.AcquiredPage(i.data.filename,i.data.page,i.data.image_count))})),_defineProperty(this,"AcquiredFolderPulse",(function(n){var i=e.GetCustomEventData(e.Twain.pulse,n);i.data&&("completed"==i.status?e.AcquiredFileCompleted(i):e.AcquiredPage(i.data.filename,i.data.page,i.data.image_count))})),_defineProperty(this,"AcquiredPage",(function(n,i,a){var c=e.interface.Library.Parent,u=e;setTimeout((function(){u.interface.LimitPageRange(0,0),0==c._AttachIndex?u.interface.NavigateToPage(c.AttachDisplayOrder,1):u.interface.NavigateToPage("gotopage",parseInt(c._AttachIndex)),r.ShowPageInfo(u)}))})),_defineProperty(this,"AcquiredFileCompleted",(function(n,i){var r=e;i?r.interface.Library.Parent._AttachIndex=0:setTimeout(r.AcquiredFileCompleted.bind(e,n,!0))})),_defineProperty(this,"AppendFromFileCompleted",(function(n,i){if(!n){var a=e;setTimeout((function(){a.interface.LimitPageRange(0,0),a.interface.NavigateToPage("lastpage",1),r.ShowPageInfo(a)}))}})),_defineProperty(this,"goToPageWithPageNumber",(function(n,i){!n||n<=0||(n>e.interface.TotalElementCount()||(e.ConfirmToSavePage(),e.interface.LimitPageRange(0,0),e.interface.NavigateToPage("gotopage",parseInt(n)),r.ShowPageInfo(i)))})),_defineProperty(this,"viewerInternalScanAppEvent",(function(n){switch(n){case"nextpage":e.ConfirmToSavePage(),e.interface.LimitPageRange(0,0),e.interface.NavigateToPage("nextpage",1),r.ShowPageInfo(e);break;case"prevpage":e.ConfirmToSavePage(),e.interface.LimitPageRange(0,0),e.interface.NavigateToPage("prevpage",1),r.ShowPageInfo(e);break;case"firstpage":e.ConfirmToSavePage(),e.interface.LimitPageRange(0,0),e.interface.NavigateToPage("firstpage",1),r.ShowPageInfo(e);break;case"lastpage":e.ConfirmToSavePage(e),e.interface.LimitPageRange(0,0),e.interface.NavigateToPage("lastpage",1),r.ShowPageInfo();break;case"gotopage":e.ConfirmToSavePage(e),e.interface.LimitPageRange(0,0);var i=prompt("Provide Page Number");e.interface.NavigateToPage("gotopage",parseInt(i)),r.ShowPageInfo(e);break;case"invert":e.interface.LimitPageRange(0,0),e.interface.InvertPage().catch(e.handleGenericaCallError);break;case"appendfromfile":var a=e.interface.AppendFromFile(e.AppendFromFileCompleted).catch(e.handleGenericaCallError);break;case"insertbeforefromfile":a=e.interface.InsertBeforeFromFile(e.AppendFromFileCompleted).catch(e.handleGenericaCallError);break;case"insertafterfromfile":a=e.interface.InsertAfterFromFile(e.AppendFromFileCompleted).catch(e.handleGenericaCallError);break;case"insertatcurrentfromFile":a=e.interface.InsertAtCurrentFromFile(e.AppendFromFileCompleted).catch(e.handleGenericaCallError);break;case"insertafterfromfile":a=e.interface.InsertAfterFromFile(e.AppendFromFileCompleted).catch(e.handleGenericaCallError);break;case"appendfromfolder":a=e.interface.AppendFromFolder(e.AppendFromFileCompleted).catch(e.handleGenericaCallError);break;case"rotate90":var c=90;(a=e.interface.Rotate(c)).then((function(e){})),a.catch(e.handleGenericaCallError);break;case"rotateClockWise":c=90;(a=e.interface.Rotate(c)).then((function(e){})),a.catch(e.handleGenericaCallError);break;case"rotateAntiClockWise":c=-90;(a=e.interface.Rotate(c)).then((function(e){})),a.catch(e.handleGenericaCallError);break;case"fitToWidth":e.interface.SetDisplayOption("fitwidth");break;case"fitheight":e.interface.SetDisplayOption("fitheight");break;case"fitpage":e.interface.SetDisplayOption("fitpage");break;case"zoomin":e.interface.DoZoom("zoomin");break;case"zoomout":e.interface.DoZoom("zoomout");break;case"hrevert":e.interface.SetDisplayOption("HRevert");break;case"vrevert":e.interface.SetDisplayOption("VRevert");break;case"rotateLeft":e.interface.SetDisplayOption("rotateLeft");break;case"rotateRight":e.interface.SetDisplayOption("rotateRight");break;case"reset":e.interface.SetDisplayOption("reset")}})),_defineProperty(this,"handleGenericaCallError",(function(e,n){dataOrErr instanceof Error?alert("runtime error\n"+e):alert("error in xhr call/response, please debug and fix")})),_defineProperty(this,"ConfirmToSavePage",(function(){e.interface.Viewer.Image&&(e.interface.Viewer.Image.Modified&&1==confirm("The changes you have made on this page have not been saved yet. Do you want to save them?")&&e.interface.SaveViewer())})),_defineProperty(this,"reserved",(function(n,i){e.notifier.closeDownloadTwainPopup()})),_defineProperty(this,"releaseTwain",_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(){var n,i,r,a;return _regeneratorRuntime().wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:if(e.Twain){c.next=2;break}return c.abrupt("return");case 2:if(n=e.appConfig.GetServiceURL(),i=localStorage.getItem("TWAIN_RESERVE_INFO"),r=exWebDocViewerCtrl.getTwainStatus(),i){c.next=12;break}if(!r.isRequestInProgress){c.next=9;break}return c.abrupt("return");case 9:return e.Twain.pulse.state="none",e.Twain.Reserve(n),c.abrupt("return");case 12:return localStorage.removeItem("TWAIN_RESERVE_INFO"),c.prev=13,c.next=16,e.Twain.ReleaseRefresh(null,i);case 16:if(a=c.sent){c.next=20;break}return c.abrupt("return");case 20:if("release"!=a.method||"success"!=a.status){c.next=26;break}if(!r.isRequestInProgress){c.next=24;break}return c.abrupt("return");case 24:return e.Twain.Reserve(n),c.abrupt("return");case 26:c.next=30;break;case 28:c.prev=28,c.t0=c.catch(13);case 30:case"end":return c.stop()}}),_callee4,null,[[13,28]])})))),_defineProperty(this,"do_reserve",(function(){e.Twain&&e.releaseTwain()})),_defineProperty(this,"onRelease",(function(n,i){i&&i.status&&"error"==i.status||n||e.Twain.pulse.state})),_defineProperty(this,"GetInterface",(function(){return e.interface})),_defineProperty(this,"GetCustomEventData",(function(e,n){if("jsTwainPulse"===e.constructor.name)return n[e.getEvtDataPropName()]})),_defineProperty(this,"have_image",(function(e,n){})),_defineProperty(this,"triggerHttpTwain",(function(){var e=document.createElement("iframe");e.style.display="none",e.src="Extrieve://";try{document.body.appendChild(e)}catch(e){}setTimeout((function(){document.body.removeChild(e)}),1e3)})),_defineProperty(this,"runStatusUpdater",(function(){e.ServiceConnect.disConnected=!1,e.ServiceConnect.retryCount=0,e.ServiceConnect.timer=setInterval(_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(){var n;return _regeneratorRuntime().wrap((function _callee5$(i){for(;;)switch(i.prev=i.next){case 0:if(n=exWebDocViewerCtrl.getTwainStatus(),e.updateStatusToUI(2),n.active){i.next=13;break}if(e.retryTwainConnect(),e.ServiceConnect.disConnected=!1,e.ServiceConnect.error&&e.updateStatusToUI(3),e.ServiceConnect.retryCount++,!e.ServiceConnect.retryCount||e.ServiceConnect.retryCount!=e.ServiceConnect.maxRetryLimit){i.next=10;break}return i.abrupt("return",clearInterval(e.ServiceConnect.timer));case 10:e.ServiceConnect.error=!1,i.next=16;break;case 13:e.ServiceConnect.disConnected,e.updateStatusToUI(1),e.ServiceConnect.disConnected=!1;case 16:case"end":return i.stop()}}),_callee5)}))),500)})),_defineProperty(this,"updateStatusToUI",(function(n){var i=null,r=document.getElementsByClassName("docViewerContainer")[0];r&&(i=r.getElementsByClassName("statusDiv")[0]),i&&(1==n&&(e.notifier.closeDownloadTwainPopup(),i.style.backgroundColor="#26a541",i.title="connected"),2==n&&(i.style.backgroundColor="#ffc107",i.title="connecting"),3==n&&(i.style.backgroundColor="#f44336",i.title="connection failed"))})),_defineProperty(this,"refreshNav",(function(){return r.ShowPageInfo(e)})),_defineProperty(this,"twainTimer",(function(){var n=0,i=e.notifier;i.showLoader(".imageCanVasContainer","HttpTwain connecting..");var r=window.setInterval(_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(){var e;return _regeneratorRuntime().wrap((function _callee6$(a){for(;;)switch(a.prev=a.next){case 0:if(0!=(e=exWebDocViewerCtrl.getTwainStatus()).active){a.next=14;break}if(!e.status.hasOwnProperty("error")){a.next=7;break}return i.hideLoader(),i.showTwainStatusMsg(),clearTimeout(r),a.abrupt("return");case 7:if(3!=n){a.next=12;break}return i.hideLoader(),i.buildDownloadTwainPopup(),clearTimeout(r),a.abrupt("return");case 12:return n++,a.abrupt("return");case 14:clearTimeout(r),i.hideLoader();case 16:case"end":return a.stop()}}),_callee6)}))),1e3)})),this.Twain=null,this.jsImageWiz=null,this.interface=null,this.viewerRoot=null,this.viewerElemId=null,this.viewerContainerClassName="docViewerContainer",this.appConfig=null,this.notifier=null,this.ServiceConnect={}})),i={process:function processStyles(){var e=document.createElement("style");e.innerText='\n    :root {\n        --gray-2: #f1f3f5;\n        --xs-font-sans-serif: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";\n        --xs-font-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;\n        --xs-gradient: linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0));\n    }\n    *,\n    *::before,\n    *::after {\n    box-sizing: border-box;\n    }\n    :root, html[data-theme=dark] {\n    --color-font-primary: var(--text-color);\n    --color-gray-1: var(--component-background);\n    --color-blue-gray-3: var(--border);\n    --color-blue-gray-5: var(--primary-button);\n    }\n    @media (prefers-reduced-motion: no-preference) {\n    :root {\n        scroll-behavior: smooth;\n    }\n    }\n\n    body {\n    margin: 0;\n    font-family: var(--xs-font-sans-serif);\n    font-size: 1rem;\n    font-weight: 400;\n    line-height: 1.5;\n    color: #212529;\n    background-color: #fff;\n    overflow-x: hidden !important;\n    overflow: hidden;\n    -webkit-text-size-adjust: 100%;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    }\n\n    .container{\n        display: flex;\n        flex-direction: column;\n        width: 100%;\n        height: 100%;\n        margin: 0;\n        padding: 0;\n        background-color: #f1f3f5;\n        -webkit-font-smoothing: antialiased;\n        overflow: hidden;\n    }\n\n    .container .toolBar{\n    padding: 5px 10px;\n    box-shadow: 0 0 2px 0 rgb(0 0 0 / 14%), 0 2px 2px 0 rgb(0 0 0 / 12%), 0 1px 3px 0 rgb(0 0 0 / 12%);\n    border-bottom: 1px solid #c4c4c4;\n    background-color: #fff;\n    border-radius: 0px;\n    }\n\n    .container .imageCanVasContainer{\n    overflow: auto;\n    height: 90vh;\n    width: 100%;\n    padding: 10px 20px 10px 20px;\n    background-color: #f1f3f5;\n    }\n    .container .imageCanVasContainer .imageCanVas {\n    width: 100%;\n    height: auto;\n    /* background-color: #e2e2e2;\n    box-shadow: 0 0 2px 0 rgb(0 0 0 / 14%), 0 2px 2px 0 rgb(0 0 0 / 12%), 0 1px 3px 0 rgb(0 0 0 / 12%);\n    transition: all 0.9s cubic-bezier(.25,.8,.25,1); */\n    }\n    .containerx .imageCanVasContainer canvas{\n    // width: 98.9%;\n    // height: auto;\n    // cursor: default;\n    // position: absolute;\n    // top: 10%;\n    // left: 0.5%;\n    }\n\n    .container .footer {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    z-index: 5;\n    width: 100%;\n    transition: all .3s ease;\n    }\n\n\n    .container .footer .PageNavOverlay {\n    padding: 1px;\n    font-size: 19px;\n    font-weight: 700;\n    color: #485056;\n    display: inline-flex;\n    align-items: center;\n    cursor: pointer;\n    position: relative;\n    left: 50%;\n    transform: translateX(-50%);\n    top: auto;\n    margin-left: auto;\n    margin-right: auto;\n    background: #fff;\n    border-radius: 5px;\n    z-index: 3;\n    bottom: 50px;\n    box-shadow: 0 0 2px 0 rgb(0 0 0 / 14%), 0 2px 2px 0 rgb(0 0 0 / 12%), 0 1px 3px 0 rgb(0 0 0 / 12%);\n    }\n\n    .container .footer .PageNavOverlay .txtpage{\n    width: 12px;\n    min-width: 8px;\n    text-align: right;\n    margin: 0px 10px;\n    border: none;\n    color: inherit;\n    font-size: inherit;\n    background: transparent;\n    cursor: pointer;\n    outline: none;\n    border-bottom: 1px solid #868e96;\n    border-radius: 0;\n    }\n    .container .footer .PageNavOverlay .formContainer {\n    padding: 0px 10px;\n    color: #878787;\n    font-size: medium;\n    user-select: none;\n    }\n\n    :root {\n        --gray-2: #f1f3f5;\n        --xs-font-sans-serif: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";\n        --xs-font-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;\n        --xs-gradient: linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0));\n    }\n    *,\n    *::before,\n    *::after {\n    box-sizing: border-box;\n    }\n    :root, html[data-theme=dark] {\n    --color-font-primary: var(--text-color);\n    --color-gray-1: var(--component-background);\n    --color-blue-gray-3: var(--border);\n    --color-blue-gray-5: var(--primary-button);\n    }\n    @media (prefers-reduced-motion: no-preference) {\n    :root {\n        scroll-behavior: smooth;\n    }\n    }\n\n    body {\n    margin: 0;\n    font-family: var(--xs-font-sans-serif);\n    font-size: 1rem;\n    font-weight: 400;\n    line-height: 1.5;\n    color: #212529;\n    background-color: #fff;\n    overflow-x: hidden !important;\n    overflow: hidden;\n    -webkit-text-size-adjust: 100%;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    }\n\n    .containerx{\n        display: flex;\n        flex-direction: column;\n        width: 100%;\n        height: 100%;\n        margin: 0;\n        padding: 0;\n        background-color: #f1f3f5;\n        -webkit-font-smoothing: antialiased;\n        overflow: hidden;\n        position: absolute;\n        /* z-index: 1200; */\n        height: 100vh;\n        position: relative;\n        /* display: flex; */\n        height: 84vh;\n        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);\n        transition: all 0.3s cubic-bezier(.25,.8,.25,1);\n    }\n\n    .containerxAddon{\n        display: flex;\n        flex-direction: column;\n        width: 100%;\n        height: 100%;\n        margin: 0;\n        padding: 0;\n        background-color: #f1f3f5;\n        -webkit-font-smoothing: antialiased;\n        overflow: hidden;\n        position: absolute;\n        /* z-index: 1200; */\n        height: 100vh;\n        position: relative;\n        /* display: flex; */\n        height: 38vh;\n        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);\n        transition: all 0.3s cubic-bezier(.25,.8,.25,1);\n    }\n\n    .containerx .toolBar{\n    // padding: 5px 10px;\n    box-shadow: 0 0 2px 0 rgb(0 0 0 / 14%), 0 2px 2px 0 rgb(0 0 0 / 12%), 0 1px 3px 0 rgb(0 0 0 / 12%);\n    border-bottom: 1px solid #c4c4c4;\n    background-color: #fff;\n    border-radius: 0px;\n    float: left;\n    width: 100%;\n    }\n\n    .containerx .toolBar .tool{\n        left: 5px;\n        float: left;\n        padding: 3px 8px;\n        color: #607d8b;\n        text-shadow: 15px 0px 11px black;\n    }\n\n    .containerx .toolBar .otherTools{\n    right: 5px;\n    float: right;\n    padding-right: 20px;\n    }\n\n    .containerx .statusDiv{\n        background-color: red;\n        width: 10px;\n        height: 10px;\n        position: absolute;\n        border-radius: 50%;\n        top: 35px;\n        left: 5px;\n        color: white;\n        z-index:2;\n        font-size: 10px;\n        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);\n        transition: all 0.3s cubic-bezier(.25,.8,.25,1);\n    }\n    .containerx .imageCanVasContainer {\n        overflow: auto;\n        height: 100vh;\n        min-height: 80vh;\n        width: 100%;\n        position:relative;\n        padding: 5px 20px 1px 20px;\n        background-color: #e7ebef;\n        //background: url("https://picsum.photos/536/354") no-repeat center;\n        //opacity: 0.2;\n    }\n    .containerx .imageCanVasContainer .imageCanVas {\n    width: 100%;\n    height: auto;\n    /* background-color: #e2e2e2;\n    box-shadow: 0 0 2px 0 rgb(0 0 0 / 14%), 0 2px 2px 0 rgb(0 0 0 / 12%), 0 1px 3px 0 rgb(0 0 0 / 12%);\n    transition: all 0.9s cubic-bezier(.25,.8,.25,1); */\n    }\n\n    .containerx .imageCanVasContainer canvas{\n        box-shadow: 0 1px 3px rgb(0 0 0 / 12%), 0 1px 2px rgb(0 0 0 / 24%);\n        transition: all 0.3s cubic-bezier(.25,.8,.25,1);\n        // display:none;\n    }\n\n    .containerx .imageCanVasContainer CanvasHolder{\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        padding: 1rem;\n        margin: 0 0.5rem 2rem 0;\n    }\n\n    .containerx .footer {\n    position: relative;\n    bottom: 0;\n    left: 0;\n    z-index: 5;\n    width: 100%;\n    transition: all .3s ease;\n    background-color: white;\n    }\n\n\n    .containerx .footer .PageNavOverlay {\n        padding: 5px;\n        font-weight: 700;\n        color: #485056;\n        display: inline-flex;\n        align-items: center;\n        cursor: pointer;\n        position: relative;\n        left: 50%;\n        transform: translateX(-50%);\n        top: auto;\n        margin-left: auto;\n        margin-right: auto;\n        background: #fff;\n        border-radius: 5px;\n        z-index: 3;\n        bottom: 60px;\n        box-shadow: 0 0 2px 0 rgb(0 0 0 / 14%), 0 2px 2px 0 rgb(0 0 0 / 12%), 0 1px 3px 0 rgb(0 0 0 / 12%);\n\n    }\n\n    .containerx .footer .PageNavOverlay button{\n    background-color: unset !important;\n    }\n\n    .containerx .footer .PageNavOverlay .imgNavIcon{\n    width: 30px;\n    }\n\n    .containerx .footer .PageNavOverlay .txtpage{\n    width: 10px;\n    min-width: 10px;\n    text-align: right;\n    border: none;\n    color: inherit;\n    font-size: inherit;\n    background: transparent;\n    cursor: pointer;\n    outline: none;\n    border-bottom: 1px solid #868e96;\n    border-radius: 0;\n    user-select: none;\n    }\n    .containerx .footer .PageNavOverlay .formContainer {\n    padding: 0px 10px;\n    color: #878787;\n    font-size: medium;\n    margin-bottom: 4px;\n    }\n\n    .containerx .footer .PageNavOverlay .formContainer .txtpageTotalht {\n    user-select: none;\n    }\n\n\n    .docTools .tools .tool{\n    padding-right: 20px;\n    cursor: pointer;\n    color: #673ab7;\n    }\n\n    .docTools .tools .tool:hover{\n    color: #f44336;\n    }\n\n    .closeViewer{\n    color: #3f51b5;\n    font-weight: 400;\n    font-size: large;\n    }\n\n    .otherFileDiv{\n    border: 1px solid #b0b0b3;\n    background-color: white;\n    padding: 15%;\n    }\n\n    .downloadButton{\n    text-decoration: none;\n    width: 10px;\n    }\n\n    .downloadButton .fileName{\n    color: #9c27b0;\n        padding-top: 15px;\n    }\n\n    .downloadButton .icon{\n    font-size: 50px;\n    }\n\n\n    .viewerRoot{\n    text-align: center;\n    }\n\n    .container .footer .PageNavOverlay .left{\n    font-size: 2rem;\n    }\n\n    .container .footer .PageNavOverlay .right{\n    font-size: 2rem;\n    }\n\n    /* width */\n    ::-webkit-scrollbar {\n        width: 5px;\n        height: 10px;\n    }\n\n    /* Track */\n    ::-webkit-scrollbar-track {\n    width: 10px;\n    border-radius: 10px;\n    background: none;\n    }\n    \n    /* Handle */\n    ::-webkit-scrollbar-thumb {\n        background-color: #9e9e9e;\n        border-top: 2px solid transparent;\n    }\n\n    /* Handle on hover */\n    ::-webkit-scrollbar-thumb:hover {\n    background: #555; \n    }\n\n\n    .dropbtn {\n    background-color: #3498DB;\n    color: white;\n    padding: 16px;\n    font-size: 16px;\n    border: none;\n    cursor: pointer;\n    }\n\n    .dropbtn:hover, .dropbtn:focus {\n    background-color: #2980B9;\n    }\n\n    .dropdown {\n    position: relative;\n    display: inline-block;\n    }\n\n    .dropdown-content {\n    display: none;\n    position: absolute;\n    background-color: #f1f1f1;\n    min-width: 160px;\n    overflow: auto;\n    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n    z-index: 1;\n    }\n\n    .dropdown-content a {\n    color: black;\n    padding: 12px 16px;\n    text-decoration: none;\n    display: block;\n    }\n\n    .dropdown a:hover {background-color: #ddd;}\n\n    .show {display: block;}\n    /* content */\n\n    .content {\n    padding: 48px 0;\n    border-bottom: solid 2px #cfcfcf;\n    }\n\n    .content__footer {\n    margin-top: 12px;\n    text-align: center;\n    }\n\n    /* footer */\n\n    .primary-footer {\n    padding: 24px 0;\n    color: #898989;\n    font-size: 14px;\n    text-align: center;\n    }\n\n    /* tasks */\n\n    .tasks {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    }\n\n    .task {\n    display: flex;\n    justify-content: space-between;\n    padding: 12px 0;\n    border-bottom: solid 1px #dfdfdf;\n    }\n\n    .task:last-child {\n    border-bottom: none;\n    }\n\n    /* context menu */\n\n    .context-menu, .sub-menu {\n        position: fixed;\n        background-color: #ffffff;\n        background-clip: padding-box;\n        border-radius: 3px;\n        border: 1px solid rgb(0 0 10 / 10%);\n        padding: 3px 0;\n        box-shadow: 0px 1px 5px 0px rgb(0 0 0 / 21%);\n        z-index: 1;\n        user-select: none;\n        overflow: hidden;\n    }\n    \n    .context-menu-inner {\n        width: 100%;\n        height: 100%;\n        overflow-x: hidden;\n        overflow-y: auto;\n    }\n    \n    .context-menu:focus, .context-menu :focus {\n        /* outline: 2px solid blue; */\n        outline: 0;\n    }\n    \n    .menu-item {\n        position: relative;\n        height: 22px;\n        white-space: nowrap;\n        cursor: default;\n        line-height: 0;\n        display: flex;\n        align-items: center;\n    }\n    \n    .menu-item.disabled {\n        color: #666;\n    }\n    \n    .menu-item.disabled:focus {\n        background-color: #ddd;\n    }\n    \n    /* .menu-item:hover {\n        background-color: rgb(217, 229, 255);\n    } */\n    \n    .menu-item.active, .menu-item:focus {\n        background-color: hsl(206, 39%, 86%);\n    }\n    \n    .menu-item-icon {\n        width: 24px;\n        height: 100%;\n        flex-shrink: 0;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    \n    .menu-item.checked .menu-item-icon {\n        background-color: hsl(206, 60%, 80%);\n        font-weight: bold;\n        font-size: 12px;\n    }\n    \n    .menu-item-text {\n        flex-basis: 100%;\n        height: 100%;\n        display: flex;\n        align-items: center;\n        min-width: 120px;\n        max-width: 400px;\n        padding-left: 6px;\n        padding-right: 10px;\n        font-size: 12px;\n        letter-spacing: normal;\n        overflow: hidden;\n    }\n    \n    .menu-item.emphasis>.menu-item-text {\n        font-weight: bold;\n    }\n    \n    .menu-item-shortcut {\n        height: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        padding-right: 12px;\n        font-size: 12px;\n        text-align: right;\n        line-height: normal;\n        color: #666;\n    }\n    \n    .menu-item:not(.disabled):focus>.menu-item-shortcut {\n        color: #000;\n    }\n    \n    .menu-item-arrow {\n        flex-grow: 1;\n        flex-shrink: 0;\n        width: 20px;\n        height: 100%;\n        font-size: 12px;\n        display: flex;\n        align-items: center;\n    }\n    \n    .sub-menu {\n        display: none;\n    }\n    \n    .sub-menu.show {\n        display: initial;\n    }\n    \n    .menu-item-divider {\n        width: 100%;\n        height: 1px;\n        background-color: #ccc;\n        margin: 3px 0;\n    }\n    \n    .context-menu-scroll-button {\n        display: none;\n        position: absolute;\n        width: 100%;\n        height: 22px;\n        background-color: #f2f2f3;\n        z-index: 2;\n    }\n    \n    .context-menu-scroll-button.top {\n        top: 0;\n    }\n    \n    .context-menu-scroll-button.bottom {\n        bottom: 0;\n    }\n    \n    .context-menu-scroll-button.show {\n        display: initial;\n    }\n    \n    .context-menu-scroll-button svg {\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        right: 0;\n        margin: auto;\n    }\n\n    .magnifier {\n        border-radius: 100px;\n        border: 1px solid blue;\n        position: absolute;\n        pointer-events: none;\n        top: 0;\n        left: 0;\n      }\n\n      .img-magnifier-glass {\n        position: absolute;\n        border: 3px solid #673ab7;\n        border-radius: 50%;\n        width: 200px;\n        cursor: none;\n        height: 200px;\n        box-shadow: 0 0 9px 3px rgb(0 0 0 / 57%), 0 2px 2px 0 rgb(0 0 0 / 12%), 0 1px 3px 0 rgb(0 0 0 / 12%);\n      }\n\n      .exNotificMain{\n       \n        width: 100%;\n        height: auto;\n        z-index: 10;\n        margin: -5px -20px -1px -20px;\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n      }\n      .exNotificMain .exNotificBg{\n        background-color: #ffffffba;\n      }\n    ',document.getElementsByTagName("head")[0].appendChild(e)}},r={prepareUI:function prepareUI(e){var n=e.viewerRoot.getElementsByClassName("txtpage")[0];n&&(n.addEventListener("click",(function(e){!n.value||n.value<=0||n.setSelectionRange(0,n.value.length)})),n.addEventListener("keydown",(function(i){!n.value||n.value<=0||13===i.keyCode&&e.goToPageWithPageNumber(n.value,e)})))},ShowPageInfo:function ShowPageInfo(e){var n,i,r;e.appConfig.UI_CONFIG.NAVBAR&&((r=e.viewerRoot.getElementsByClassName("txtpage")[0])&&(n=e.interface.CurrentPage,i=e.interface.RangeEnd>0?e.interface.RangeEnd:e.interface.TotalPageCount(),r&&n>=0?(r.value=i<=0?0:n,r.nextElementSibling.innerText=" / "+i):r.value="",r.style.width=8*(r.value.length+1)+"px"))},buildBaseUI:function buildBaseUI(e,n){return a.create("div",{class:"containerx "+e.viewerContainerClassName},[function(){return r.initStatusDiv(n)},a.create("div",{class:"toolBar"},[function(){return r.buildToolBar(e)}]),a.create("div",{id:e.viewerElemId+"_ImageWiz",class:"imageCanVasContainer"}),a.create("div",{class:"footer"},[function(){return r.buildFooter(e)}])])},initStatusDiv:function initStatusDiv(e){return e?a.create("span",{class:"statusDiv"},[]):a.create("span",{},[])},buildStatus:function buildStatus(){return a.create("span",{class:"statusDiv"},[])},buildToolBar:function buildToolBar(e){return e.appConfig.UI_CONFIG.TOOLBAR?a.create("span",{class:"tools"},[a.create("span",{class:"tool",title:"zoom in"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-zoom-in" viewBox="0 0 16 16">\n                        <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>\n                        <path d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"/>\n                        <path fill-rule="evenodd" d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z"/>\n                        </svg>'],{click:function click(){e.viewerInternalScanAppEvent("zoomin")}}),a.create("span",{class:"tool",title:"zoom out"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-zoom-out" viewBox="0 0 16 16">\n                        <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>\n                        <path d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"/>\n                        <path fill-rule="evenodd" d="M3 6.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"/>\n                    </svg>'],{click:function click(){e.viewerInternalScanAppEvent("zoomout")}}),a.create("span",{class:"tool",title:"Reset"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-wide-connected" viewBox="0 0 16 16">\n                        <path d="M7.068.727c.243-.97 1.62-.97 1.864 0l.071.286a.96.96 0 0 0 1.622.434l.205-.211c.695-.719 1.888-.03 1.613.931l-.08.284a.96.96 0 0 0 1.187 1.187l.283-.081c.96-.275 1.65.918.931 1.613l-.211.205a.96.96 0 0 0 .434 1.622l.286.071c.97.243.97 1.62 0 1.864l-.286.071a.96.96 0 0 0-.434 1.622l.211.205c.719.695.03 1.888-.931 1.613l-.284-.08a.96.96 0 0 0-1.187 1.187l.081.283c.275.96-.918 1.65-1.613.931l-.205-.211a.96.96 0 0 0-1.622.434l-.071.286c-.243.97-1.62.97-1.864 0l-.071-.286a.96.96 0 0 0-1.622-.434l-.205.211c-.695.719-1.888.03-1.613-.931l.08-.284a.96.96 0 0 0-1.186-1.187l-.284.081c-.96.275-1.65-.918-.931-1.613l.211-.205a.96.96 0 0 0-.434-1.622l-.286-.071c-.97-.243-.97-1.62 0-1.864l.286-.071a.96.96 0 0 0 .434-1.622l-.211-.205c-.719-.695-.03-1.888.931-1.613l.284.08a.96.96 0 0 0 1.187-1.186l-.081-.284c-.275-.96.918-1.65 1.613-.931l.205.211a.96.96 0 0 0 1.622-.434l.071-.286zM12.973 8.5H8.25l-2.834 3.779A4.998 4.998 0 0 0 12.973 8.5zm0-1a4.998 4.998 0 0 0-7.557-3.779l2.834 3.78h4.723zM5.048 3.967c-.03.021-.058.043-.087.065l.087-.065zm-.431.355A4.984 4.984 0 0 0 3.002 8c0 1.455.622 2.765 1.615 3.678L7.375 8 4.617 4.322zm.344 7.646.087.065-.087-.065z"/>\n                    </svg>'],{click:function click(){e.viewerInternalScanAppEvent("reset")}}),a.create("span",{class:"tool",title:"Flip Horizontal"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hr" viewBox="0 0 16 16">\n                        <path d="M12 3H4a1 1 0 0 0-1 1v2.5H2V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v2.5h-1V4a1 1 0 0 0-1-1zM2 9.5h1V12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V9.5h1V12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9.5zm-1.5-2a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1H.5z"/>\n                        </svg>'],{click:function click(){e.viewerInternalScanAppEvent("hrevert")}}),a.create("span",{class:"tool",title:"Flip Vertical"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-vr" viewBox="0 0 16 16">\n                        <path d="M3 12V4a1 1 0 0 1 1-1h2.5V2H4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h2.5v-1H4a1 1 0 0 1-1-1zm6.5 1v1H12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H9.5v1H12a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H9.5zM8 16a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 1 0v15a.5.5 0 0 1-.5.5z"/>\n                        </svg>'],{click:function click(){e.viewerInternalScanAppEvent("vrevert")}}),a.create("span",{class:"tool",title:"Rotate Left"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-counterclockwise" viewBox="0 0 16 16">\n                        <path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"/>\n                        <path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"/>\n                    </svg>'],{click:function click(){e.viewerInternalScanAppEvent("rotateLeft")}}),a.create("span",{class:"tool",title:"Rotate Right"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">\n                        <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>\n                        <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>\n                        </svg>'],{click:function click(){e.viewerInternalScanAppEvent("rotateRight")}})]):""},buildFooter:function buildFooter(e){if(!e.appConfig.UI_CONFIG.NAVBAR)return"";var n=[a.create("div",{"aria-label":"Previous page",class:"left"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">\n                        <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>\n                        </svg>'],{click:function click(){return e.viewerInternalScanAppEvent("prevpage")}}),function(){return r.buildNavUI(e)},a.create("div",{"aria-label":"Next page",class:"right bi bi-chevron-right"},['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">\n                        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>\n                        </svg>'],{click:function click(){return e.viewerInternalScanAppEvent("nextpage")}})];return a.create("div",{"data-element":"pageNavOverlay",class:"Overlay PageNavOverlay"},n)},buildNavUI:function buildNavUI(e){return e.appConfig.UI_CONFIG.NAVBAR?a.create("div",{class:"formContainer"},[a.create("input",{type:"text",id:"txtpage",class:"txtpage",title:"enter page to go",tabindex:"-1"},null,{input:function input(e){return r.setWidth(e.target)}}),a.create("span",{class:"txtpageTotalht",id:"txtpageTotalht"})]):""},setWidth:function setWidth(e){var n=a.create("div",{style:"visibility:hidden"});n.style.position="absolute",n.style.top="0",n.style.left="-9999px",n.style.overflow="hidden",n.style.visibility="hidden",n.style.whiteSpace="nowrap",n.style.height="0";var i=window.getComputedStyle(e);n.style.fontFamily=i.fontFamily,n.style.fontSize=i.fontSize,n.style.fontStyle=i.fontStyle,n.style.fontWeight=i.fontWeight,n.style.letterSpacing=i.letterSpacing,n.style.textTransform=i.textTransform,n.style.borderLeftWidth=i.borderLeftWidth,n.style.borderRightWidth=i.borderRightWidth,n.style.paddingLeft=i.paddingLeft,n.style.paddingRight=i.paddingRight,document.body.appendChild(n);var r=e.value||e.getAttribute("placeholder")||"";n.innerHTML=r.replace(/\s/g,"&nbsp;nbsp;"),e.style.width=window.getComputedStyle(n).width}},a=function(){var e={},n="$_$ROUTE$_$",i="$_$OPEN$_$";e.get=function(e,n){if(!e)throw new Error("Please provide a selector.");return n?n.querySelector(e):document.querySelector(e)},e.render=function(e,n,i){if(n&&e){var r=new XMLHttpRequest;r.onreadystatechange=function(n){if(4==r.readyState&&200==r.status){var a=document.createRange().createContextualFragment(r.responseText),c=document.getElementById(e);c.empty(),c.append(a),i&&"function"==typeof i&&i()}},r.open("GET",n,!0),r.setRequestHeader("Content-type","text/html"),r.send()}},e.route=function(i,r,a,c){sessionStorage.setItem(n,JSON.stringify(a)),e.render(i,r,c)},e.routeLoad=function(){var e=sessionStorage.getItem(n);if(e=JSON.parse(e))return e},e.open=function(e,n){sessionStorage.setItem(i,JSON.stringify(n)),window.open(e,"meaningfulName")},e.openLoad=function(){var e=sessionStorage.getItem(i);if(e=JSON.parse(e))return e},e.getAll=function(e,n){if(!e)throw new Error("Please provide a selector.");return n?n.querySelectorAll(e):document.querySelectorAll(e)},e.on=function(e,n,i,r){if(!e)throw new Error("Please provide an element to attach the event to.");if(!n)throw new Error("Please provide an event to listen for.");if(!i||"function"!=typeof i)throw new Error("Please provide a valid callback function to run");e.addEventListener(n,i,r||!1)},e.create=function(e,n,i,c){var u,h=!1;if("string"==typeof e?u=document.createElement(e.trim()):e instanceof HTMLElement&&(u=e),n)for(var p in n)u.setAttribute(p,n[p]);if(h=h||null,i&&1==i.length&&"string"==typeof i[0]?r(i[0])?a(u,i[0],!0):a(u,i,!1):(i||0==i)&&a(u,i,h),c&&Object.keys(c).length)for(var d in c){var f=c[d];d&&"function"==typeof f&&u.addEventListener(d,f)}return u};var r=function containsHTML(e){return/<[a-z][\s\S]*>/i.test(e)};e.request=function(e,n,i,r,a,c){var u,h;try{(u=new XMLHttpRequest).onreadystatechange=function(){"function"==typeof c&&4==u.readyState&&c(u,a)},u.open(n,e,!0),h=i?h=i:null,r&&(u.responseType=r),u.send(h)}catch(e){}};var a=function append(e,n,i){e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement?n instanceof Text||"string"==typeof n||"number"==typeof n?e.value=n:n instanceof Array?n.forEach((function(n){append(e,n)})):"function"==typeof n&&append(e,n()):n instanceof HTMLElement||n instanceof Text?e.appendChild(n):"string"==typeof n||"number"==typeof n?i?e.innerHTML+=n:e.appendChild(document.createTextNode(n)):n instanceof Array?n.forEach((function(n){append(e,n)})):"function"==typeof n&&append(e,n())};return e.clearChildren=function(e){if(e)for(;e.lastElementChild;)e.removeChild(e.lastElementChild)},e}(),c=function(){"use strict";var e="white",n=null,i={Enter:"Enter",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",Escape:"Escape",Space:" "},r='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="6 15 12 9 18 15" /></svg>',a='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="6 9 12 15 18 9" /></svg>',c='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" /></svg>';function hoverHold(e,n){var i;function onMouseLeave(){cancelAnimationFrame(i),setTimeout((function(){cancelAnimationFrame(i)}),50),e.removeEventListener("mouseleave",onMouseLeave,!1)}function timer(){i=requestAnimationFrame(timer),"function"==typeof n&&n()}e.addEventListener("mouseenter",(function onMouseEnter(){i=requestAnimationFrame(timer),e.addEventListener("mouseleave",onMouseLeave,!1)}),!1)}function SubMenu(e,n,c,u,h){var p,d=c.length,f=0,m=[],g=-1,v={close:function close(){n.setActive(!1),w.classList.remove("show"),closeOpeningSubMenu()}},w=document.createElement("div");w.className="sub-menu";var y=document.createElement("div");y.className="context-menu-scroll-button top",y.innerHTML=r,w.appendChild(y);var b=document.createElement("div");b.className="context-menu-scroll-button bottom",b.innerHTML=a,w.appendChild(b);var _,x=document.createElement("div");function checkButton(){x.scrollTop<=10?y.classList.remove("show"):y.classList.add("show"),x.scrollTop+x.getBoundingClientRect().height>=x.scrollHeight-10?b.classList.remove("show"):b.classList.add("show")}x.tabIndex=-1,x.className="context-menu-inner",x.onkeydown=function onkeydown(e){e.key===i.ArrowLeft&&(e.stopPropagation(),w.classList.remove("show"),n.setActive(!1),n.element.focus());if(e.key===i.ArrowRight)e.stopPropagation(),-1===g&&m[g=0].element.focus();else if(e.key===i.ArrowUp){if(e.stopPropagation(),e.preventDefault(),-1===g)g=m.length-1,m[g].element.focus();else{var r=m[g-1];r?r.element.focus():m[m.length-1].element.focus()}closeOpeningSubMenu()}else if(e.key===i.ArrowDown){if(e.stopPropagation(),e.preventDefault(),-1===g)m[g=0].element.focus();else{var a=m[g+1];a?a.element.focus():m[0].element.focus()}closeOpeningSubMenu()}},x.addEventListener("scroll",(function(){checkButton()}),!1),hoverHold(y,(function decreScrollTop(){x.scrollTop-=4})),hoverHold(b,(function increScrollTop(){x.scrollTop+=4})),w.appendChild(x),n.element.appendChild(w);for(var I=0;I<d;I++){var k=c[I];if(k.divider){var T=document.createElement("div");T.className="menu-item-divider",x.appendChild(T)}else{var C=MenuItem(k,f,{onEnter:u,onFocus:onItemFocus,onHover:onItemHover});x.appendChild(C.element),void 0!==k.children&&null!==k.children&&k.children instanceof Array&&k.children.length>0&&!k.disabled&&SubMenu(w,C,k.children,u,onSubMenuShow),m.push(C),f+=1}}function onSubMenuShow(e){p=e}function onItemHover(){closeOpeningSubMenu()}function onItemFocus(e){g=e}function show(i){var r=window.innerWidth,a=window.innerHeight;n.setActive(!0),w.classList.add("show");var c=e.getBoundingClientRect(),u=n.element.getBoundingClientRect(),p=c.left+c.width,d=u.top,f=w.getBoundingClientRect();_||(_=f);var g=x.getBoundingClientRect();c.left+c.width+f.width>r&&(p=c.left-f.width),d+f.height>=a?d=a-f.height-3:d-=3,g.height>=a&&(d=10,w.style.height=a-20+"px"),g=x.getBoundingClientRect(),x.scrollHeight>g.height&&(w.style.width=_.width+"px",x.style.width=_.width+20+"px"),w.style.top=d+"px",w.style.left=p+"px",checkButton(),i&&m[0].element.focus(),h(v)}function closeOpeningSubMenu(){p&&p.close()}return n.element.addEventListener("keydown",(function(e){e.key!==i.ArrowRight&&e.key!==i.Enter||(e.stopPropagation(),show(!0))}),!1),n.element.addEventListener("mouseenter",(function(e){e.stopPropagation(),show(!1)}),!1),v}function MenuItem(e,n,r){var a=void 0!==e.children&&null!==e.children&&e.children instanceof Array&&e.children.length>0,u=document.createElement("div");u.className="menu-item",u.tabIndex=-1,e.disabled?u.classList.add("disabled"):(u.onclick=function onclick(e){e.stopPropagation(),onSubmit()},u.onkeydown=function onkeydown(e){e.key===i.Enter&&(e.stopPropagation(),onSubmit())}),u.onfocus=function onfocus(e){e.stopPropagation(),r.onFocus(n)},u.onmouseenter=function onmouseenter(e){e.stopPropagation(),e.currentTarget.focus(),r.onHover(n)};var h=document.createElement("div");h.className="menu-item-icon",e.checked?(u.classList.add("checked"),h.innerHTML=c):e.icon instanceof Node?h.appendChild(e.icon):h.innerHTML=e.icon||"",e.emphasis&&u.classList.add("emphasis"),u.appendChild(h);var p=document.createElement("div");if(p.className="menu-item-text",p.textContent=e.text||"",u.appendChild(p),e.shortcut){var d=document.createElement("div");d.className="menu-item-shortcut",d.textContent=e.shortcut,u.appendChild(d)}if(a){var f=document.createElement("div");f.className="menu-item-arrow",f.textContent="🡢",u.appendChild(f)}function onSubmit(){a||r.onEnter(e),"function"==typeof e.onClick&&e.onClick()}return{element:u,setActive:function setActive(e){u.classList[e?"add":"remove"]("active")}}}function createColorIcon(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" stroke="#ccc" stroke-width="1" fill="'.concat(e,'">\n  <circle cx="12" cy="12" r="11"/>\n</svg>')}function oncontextmenu(e,n){((e=e||window.event).preventDefault(),n)&&function ContextMenu(e,n){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];window.lastContextMenu&&window.lastContextMenu.close();var h,p,d=window.innerWidth,f=window.innerHeight,m=[],g=-1,v=0,w=c.length;function onItemFocus(e){g=e}function closeOpeningSubMenu(){p&&p.close()}function onItemHover(){closeOpeningSubMenu()}(h=document.createElement("div")).className="context-menu";var y=document.createElement("div");y.className="context-menu-scroll-button top",y.innerHTML=r,h.appendChild(y);var b=document.createElement("div");b.className="context-menu-scroll-button bottom",b.innerHTML=a,h.appendChild(b);var _=document.createElement("div");function checkButton(){_.scrollTop<=10?y.classList.remove("show"):y.classList.add("show");var e=_.getBoundingClientRect();_.scrollTop+e.height>=_.scrollHeight-10?b.classList.remove("show"):b.classList.add("show")}_.tabIndex=-1,_.className="context-menu-inner",_.onkeydown=function onkeydown(e){if(e.key===i.ArrowRight)-1===g&&m[g=0].element.focus();else if(e.key===i.ArrowUp){if(e.preventDefault(),-1===g)g=m.length-1,m[g].element.focus();else{var n=m[g-1];n?n.element.focus():m[m.length-1].element.focus()}closeOpeningSubMenu()}else if(e.key===i.ArrowDown){if(e.preventDefault(),-1===g)m[g=0].element.focus();else{var r=m[g+1];r?r.element.focus():m[0].element.focus()}closeOpeningSubMenu()}else e.key===i.Escape&&close()},_.addEventListener("scroll",(function(){checkButton()}),!1),hoverHold(y,(function decreScrollTop(){_.scrollTop-=4})),hoverHold(b,(function increScrollTop(){_.scrollTop+=4})),h.appendChild(_),document.body.appendChild(h);for(var x=0;x<w;x++){var I=c[x];if(I.divider){var k=document.createElement("div");k.className="menu-item-divider",_.appendChild(k)}else{var T=MenuItem(I,v,{onEnter:onItemClick,onFocus:onItemFocus,onHover:onItemHover});_.appendChild(T.element),void 0!==I.children&&null!==I.children&&I.children instanceof Array&&I.children.length>0&&!I.disabled&&SubMenu(h,T,I.children,onItemClick,onSubMenuOpen),m.push(T),v+=1}}setTimeout((function(){u?m[0].element.focus():_.focus()}),0);var C={top:e.top,left:e.left},R=h.getBoundingClientRect(),P=_.getBoundingClientRect();function onItemClick(){close()}function onResize(){close()}function onDocumentMouseDown(e){h.contains(e.target)||close()}function close(){window.removeEventListener("scroll",onResize,!1),document.removeEventListener("mousedown",onDocumentMouseDown,!1),h.remove(),setTimeout((function(){n.focus()}),0)}function onSubMenuOpen(e){p=e}C.left+R.width>d&&(C.left=C.left-R.width),C.top+R.height>f&&(C.top=f-R.height-3),P.height>f&&(C.top=10,h.style.height=f-20+"px"),P=_.getBoundingClientRect(),_.scrollHeight>P.height&&(h.style.width=R.width+"px",_.style.width=R.width+20+"px"),h.style.left=C.left+"px",h.style.top=C.top+"px",checkButton(),window.addEventListener("resize",onResize,!1),document.addEventListener("mousedown",onDocumentMouseDown,!1),window.lastContextMenu={close}}({left:e.x,top:e.y},e.currentTarget,n,-1===e.button)}return{init:function initialise(i,r,a){i&&(a&&(n=a),i.oncontextmenu=function(i){oncontextmenu(i,function getTemplate(){return[{text:"Fit Image",children:[{icon:createColorIcon("aliceblue"),text:"Fit Width",checked:"aliceblue"===e,onClick:n.viewerInternalScanAppEvent.bind(null,"fitToWidth")},{icon:createColorIcon("aliceblue"),text:"Fit Height",checked:"aliceblue"===e,onClick:n.viewerInternalScanAppEvent.bind(null,"fitpage")}]},{divider:!0},{icon:createColorIcon("aliceblue"),text:"Zoom In",checked:"aliceblue"===e,onClick:n.viewerInternalScanAppEvent.bind(null,"zoomin")},{icon:createColorIcon("aliceblue"),text:"Zoom Out",checked:"aliceblue"===e,onClick:n.viewerInternalScanAppEvent.bind(null,"zoomout")},{divider:!0},{text:"Flip Image",children:[{icon:createColorIcon("aliceblue"),text:"Flip Horizondal",checked:"aliceblue"===e,onClick:n.viewerInternalScanAppEvent.bind(null,"hrevert")},{icon:createColorIcon("aliceblue"),text:"Flip Vertical",checked:"aliceblue"===e,onClick:n.viewerInternalScanAppEvent.bind(null,"vrevert")}]},{icon:createColorIcon("aliceblue"),text:"Reset",checked:"aliceblue"===e,onClick:n.viewerInternalScanAppEvent.bind(null,"reset")},{divider:!0},{text:"Close"}]}())})}}}(),u=_createClass((function exNotifier(){var e=this;_classCallCheck(this,exNotifier),_defineProperty(this,"showLoader",(function(n,i){var r=document.getElementById("exNotificBlockWraper");if(r&&r.remove(),!("string"!=typeof n||(n||"").length<1||1===(n||"").length&&("#"===(n||"")[0]||"."===(n||"")[0]))){var a=document.querySelector(n);if(a){var c='<div id="exNotificBlockWraper" class="Notific-block-wrap with-animation" style="position: absolute; z-index: 1000; height:675px; background: rgba(255, 255, 255, 0.36); animation-duration: 300ms; font-family: Quicksand, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; display: flex; flex-flow: column wrap; align-items: center; justify-content: center;">\n        <span class="Notific-block-icon" style="width:45px;height:45px;">\n           <svg xmlns="http://www.w3.org/2000/svg" width="45px" height="45px" viewBox="25 25 50 50" style="-webkit-animation:rotate 2s linear infinite;animation:rotate 2s linear infinite;height:45px;-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center;width:45px;position:absolute;top:0;left:0;margin:auto">\n              <style>@-webkit-keyframes rotate{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35}to{stroke-dasharray:89,200;stroke-dashoffset:-124}}@keyframes dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35}to{stroke-dasharray:89,200;stroke-dashoffset:-124}}</style>\n              <circle cx="50" cy="50" r="20" fill="none" stroke="#383838" stroke-width="2" style="-webkit-animation:dash 1.5s ease-in-out infinite,color 1.5s ease-in-out infinite;animation:dash 1.5s ease-in-out infinite,color 1.5s ease-in-out infinite" stroke-dasharray="150 200" stroke-dashoffset="-10" stroke-linecap="round"></circle>\n           </svg>\n        </span>\n        <span style="font-size:14px;color:#383838;" class="Notific-block-message" id="loaderMsg">'.concat(i,"</span>\n     </div>");a.insertAdjacentHTML("beforeend",c),e.addExNotifierStyles()}}})),_defineProperty(this,"updateLoaderMessage",(function(e,n){var i=document.querySelector(e);i&&(i.textContent=n)})),_defineProperty(this,"hideLoader",(function(){var e=document.getElementById("exNotificBlockWraper");e&&e.remove()})),_defineProperty(this,"addExNotifierStyles",(function(){var e=document.createElement("style");e.innerText='[id^=NotificNotifyWrap]{pointer-events:none;position:fixed;z-index:4001;opacity:1;right:10px;top:10px;width:280px;max-width:96%;-webkit-box-sizing:border-box;box-sizing:border-box;background:transparent }[id^=NotificNotifyWrap].nx-flex-center-center{max-height:calc(100vh - 20px);overflow-x:hidden;overflow-y:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:auto }[id^=NotificNotifyWrap]::-webkit-scrollbar{width:0;height:0 }[id^=NotificNotifyWrap]::-webkit-scrollbar-thumb{background:transparent }[id^=NotificNotifyWrap]::-webkit-scrollbar-track{background:transparent }[id^=NotificNotifyWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box }[id^=NotificNotifyOverlay]{-webkit-transition:background .3s ease-in-out;-o-transition:background .3s ease-in-out;transition:background .3s ease-in-out }[id^=NotificNotifyWrap]>div{pointer-events:all;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;width:100%;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;position:relative;margin:0 0 10px;border-radius:5px;background:#1e1e1e;color:#fff;padding:10px 12px;font-size:14px;line-height:1.4 }[id^=NotificNotifyWrap]>div:last-child{margin:0 }[id^=NotificNotifyWrap]>div.with-callback{cursor:pointer }[id^=NotificNotifyWrap]>div.with-icon{padding:8px;min-height:56px }[id^=NotificNotifyWrap]>div.nx-paused{cursor:auto }[id^=NotificNotifyWrap]>div.click-to-close{cursor:pointer }[id^=NotificNotifyWrap]>div.with-close-button{padding:10px 30px 10px 12px }[id^=NotificNotifyWrap]>div.with-icon.with-close-button{padding:6px 30px 6px 6px }[id^=NotificNotifyWrap]>div>span.the-message{cursor:inherit;font-weight:normal;font-family:inherit!important;word-break:break-all;word-break:break-word }[id^=NotificNotifyWrap]>div>span.notify-close-button{cursor:pointer;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out;position:absolute;right:8px;top:0;bottom:0;margin:auto;color:inherit;width:16px;height:16px }[id^=NotificNotifyWrap]>div>span.notify-close-button:hover{-webkit-transform:rotate(90deg);transform:rotate(90deg) }[id^=NotificNotifyWrap]>div>span.notify-close-button>svg{position:absolute;width:16px;height:16px;right:0;top:0 }[id^=NotificNotifyWrap]>div>.nmi{position:absolute;width:40px;height:40px;font-size:30px;line-height:40px;text-align:center;left:8px;top:0;bottom:0;margin:auto;border-radius:inherit }[id^=NotificNotifyWrap]>div>.wfa.shadow{color:inherit;background:rgba(0,0,0,.15);box-shadow:inset 0 0 34px rgba(0,0,0,.2);text-shadow:0 0 10px rgba(0,0,0,.3) }[id^=NotificNotifyWrap]>div>span.with-icon{position:relative;float:left;width:calc(100% - 40px);margin:0 0 0 40px;padding:0 0 0 10px;-webkit-box-sizing:border-box;box-sizing:border-box }[id^=NotificNotifyWrap]>div.rtl-on>.nmi{left:auto;right:8px }[id^=NotificNotifyWrap]>div.rtl-on>span.with-icon{padding:0 10px 0 0;margin:0 40px 0 0 }[id^=NotificNotifyWrap]>div.rtl-on>span.notify-close-button{right:auto;left:8px }[id^=NotificNotifyWrap]>div.with-icon.with-close-button.rtl-on{padding:6px 6px 6px 30px }[id^=NotificNotifyWrap]>div.with-close-button.rtl-on{padding:10px 12px 10px 30px }[id^=NotificNotifyOverlay].with-animation,[id^=NotificNotifyWrap]>div.with-animation.nx-fade{-webkit-animation:notify-animation-fade .3s ease-in-out 0s normal;animation:notify-animation-fade .3s ease-in-out 0s normal }@-webkit-keyframes notify-animation-fade{0%{opacity:0 }100%{opacity:1 }}@keyframes notify-animation-fade{0%{opacity:0 }100%{opacity:1 }}[id^=NotificNotifyWrap]>div.with-animation.nx-zoom{-webkit-animation:notify-animation-zoom .3s ease-in-out 0s normal;animation:notify-animation-zoom .3s ease-in-out 0s normal }@-webkit-keyframes notify-animation-zoom{0%{-webkit-transform:scale(0);transform:scale(0) }50%{-webkit-transform:scale(1.05);transform:scale(1.05) }100%{-webkit-transform:scale(1);transform:scale(1) }}@keyframes notify-animation-zoom{0%{-webkit-transform:scale(0);transform:scale(0) }50%{-webkit-transform:scale(1.05);transform:scale(1.05) }100%{-webkit-transform:scale(1);transform:scale(1) }}[id^=NotificNotifyWrap]>div.with-animation.nx-from-right{-webkit-animation:notify-animation-from-right .3s ease-in-out 0s normal;animation:notify-animation-from-right .3s ease-in-out 0s normal }@-webkit-keyframes notify-animation-from-right{0%{right:-300px;opacity:0 }50%{right:8px;opacity:1 }100%{right:0;opacity:1 }}@keyframes notify-animation-from-right{0%{right:-300px;opacity:0 }50%{right:8px;opacity:1 }100%{right:0;opacity:1 }}[id^=NotificNotifyWrap]>div.with-animation.nx-from-left{-webkit-animation:notify-animation-from-left .3s ease-in-out 0s normal;animation:notify-animation-from-left .3s ease-in-out 0s normal }@-webkit-keyframes notify-animation-from-left{0%{left:-300px;opacity:0 }50%{left:8px;opacity:1 }100%{left:0;opacity:1 }}@keyframes notify-animation-from-left{0%{left:-300px;opacity:0 }50%{left:8px;opacity:1 }100%{left:0;opacity:1 }}[id^=NotificNotifyWrap]>div.with-animation.nx-from-top{-webkit-animation:notify-animation-from-top .3s ease-in-out 0s normal;animation:notify-animation-from-top .3s ease-in-out 0s normal }@-webkit-keyframes notify-animation-from-top{0%{top:-50px;opacity:0 }50%{top:8px;opacity:1 }100%{top:0;opacity:1 }}@keyframes notify-animation-from-top{0%{top:-50px;opacity:0 }50%{top:8px;opacity:1 }100%{top:0;opacity:1 }}[id^=NotificNotifyWrap]>div.with-animation.nx-from-bottom{-webkit-animation:notify-animation-from-bottom .3s ease-in-out 0s normal;animation:notify-animation-from-bottom .3s ease-in-out 0s normal }@-webkit-keyframes notify-animation-from-bottom{0%{bottom:-50px;opacity:0 }50%{bottom:8px;opacity:1 }100%{bottom:0;opacity:1 }}@keyframes notify-animation-from-bottom{0%{bottom:-50px;opacity:0 }50%{bottom:8px;opacity:1 }100%{bottom:0;opacity:1 }}[id^=NotificNotifyOverlay].with-animation.remove,[id^=NotificNotifyWrap]>div.with-animation.nx-fade.remove{opacity:0;-webkit-animation:notify-remove-fade .3s ease-in-out 0s normal;animation:notify-remove-fade .3s ease-in-out 0s normal }@-webkit-keyframes notify-remove-fade{0%{opacity:1 }100%{opacity:0 }}@keyframes notify-remove-fade{0%{opacity:1 }100%{opacity:0 }}[id^=NotificNotifyWrap]>div.with-animation.nx-zoom.remove{-webkit-transform:scale(0);transform:scale(0);-webkit-animation:notify-remove-zoom .3s ease-in-out 0s normal;animation:notify-remove-zoom .3s ease-in-out 0s normal }@-webkit-keyframes notify-remove-zoom{0%{-webkit-transform:scale(1);transform:scale(1) }50%{-webkit-transform:scale(1.05);transform:scale(1.05) }100%{-webkit-transform:scale(0);transform:scale(0) }}@keyframes notify-remove-zoom{0%{-webkit-transform:scale(1);transform:scale(1) }50%{-webkit-transform:scale(1.05);transform:scale(1.05) }100%{-webkit-transform:scale(0);transform:scale(0) }}[id^=NotificNotifyWrap]>div.with-animation.nx-from-top.remove{opacity:0;-webkit-animation:notify-remove-to-top .3s ease-in-out 0s normal;animation:notify-remove-to-top .3s ease-in-out 0s normal }@-webkit-keyframes notify-remove-to-top{0%{top:0;opacity:1 }50%{top:8px;opacity:1 }100%{top:-50px;opacity:0 }}@keyframes notify-remove-to-top{0%{top:0;opacity:1 }50%{top:8px;opacity:1 }100%{top:-50px;opacity:0 }}[id^=NotificNotifyWrap]>div.with-animation.nx-from-right.remove{opacity:0;-webkit-animation:notify-remove-to-right .3s ease-in-out 0s normal;animation:notify-remove-to-right .3s ease-in-out 0s normal }@-webkit-keyframes notify-remove-to-right{0%{right:0;opacity:1 }50%{right:8px;opacity:1 }100%{right:-300px;opacity:0 }}@keyframes notify-remove-to-right{0%{right:0;opacity:1 }50%{right:8px;opacity:1 }100%{right:-300px;opacity:0 }}[id^=NotificNotifyWrap]>div.with-animation.nx-from-bottom.remove{opacity:0;-webkit-animation:notify-remove-to-bottom .3s ease-in-out 0s normal;animation:notify-remove-to-bottom .3s ease-in-out 0s normal }@-webkit-keyframes notify-remove-to-bottom{0%{bottom:0;opacity:1 }50%{bottom:8px;opacity:1 }100%{bottom:-50px;opacity:0 }}@keyframes notify-remove-to-bottom{0%{bottom:0;opacity:1 }50%{bottom:8px;opacity:1 }100%{bottom:-50px;opacity:0 }}[id^=NotificNotifyWrap]>div.with-animation.nx-from-left.remove{opacity:0;-webkit-animation:notify-remove-to-left .3s ease-in-out 0s normal;animation:notify-remove-to-left .3s ease-in-out 0s normal }@-webkit-keyframes notify-remove-to-left{0%{left:0;opacity:1 }50%{left:8px;opacity:1 }100%{left:-300px;opacity:0 }}@keyframes notify-remove-to-left{0%{left:0;opacity:1 }50%{left:8px;opacity:1 }100%{left:-300px;opacity:0 }}[id^=NotificReportWrap]{position:fixed;z-index:4002;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;left:0;top:0;padding:10px;color:#1e1e1e;border-radius:25px;background:transparent;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center }[id^=NotificReportWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box }[id^=NotificReportWrap]>div[class*="-overlay"]{width:100%;height:100%;left:0;top:0;background:rgba(255,255,255,.5);position:fixed;z-index:0 }[id^=NotificReportWrap]>div[class*="-content"]{width:320px;max-width:100%;max-height:96vh;overflow-x:hidden;overflow-y:auto;border-radius:inherit;padding:10px;-webkit-filter:drop-shadow(0 0 5px rgba(0, 0, 0, .05));filter:drop-shadow(0 0 5px rgba(0, 0, 0, .05));border:1px solid rgba(0,0,0,.03);background:#f8f8f8;position:relative;z-index:1 }[id^=NotificReportWrap]>div[class*="-content"]::-webkit-scrollbar{width:0;height:0 }[id^=NotificReportWrap]>div[class*="-content"]::-webkit-scrollbar-thumb{background:transparent }[id^=NotificReportWrap]>div[class*="-content"]::-webkit-scrollbar-track{background:transparent }[id^=NotificReportWrap]>div[class*="-content"]>div[class$="-icon"]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:110px;height:110px;display:block;margin:6px auto 12px }[id^=NotificReportWrap]>div[class*="-content"]>div[class$="-icon"] svg{min-width:100%;max-width:100%;height:auto }[id^=NotificReportWrap]>*>h5{word-break:break-all;word-break:break-word;font-family:inherit!important;font-size:16px;font-weight:500;line-height:1.4;margin:0 0 10px;padding:0 0 10px;border-bottom:1px solid rgba(0,0,0,.1);float:left;width:100%;text-align:center }[id^=NotificReportWrap]>*>p{word-break:break-all;word-break:break-word;font-family:inherit!important;font-size:13px;line-height:1.4;font-weight:normal;float:left;width:100%;padding:0 10px;margin:0 0 10px }[id^=NotificReportWrap] a#NXReportButton{word-break:break-all;word-break:break-word;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:inherit!important;-webkit-transition:all .25s ease-in-out;-o-transition:all .25s ease-in-out;transition:all .25s ease-in-out;cursor:pointer;float:right;padding:7px 17px;background:#32c682;font-size:14px;line-height:1.4;font-weight:500;border-radius:inherit!important;color:#fff }[id^=NotificReportWrap] a#NXReportButton:hover{box-shadow:inset 0 -60px 5px -5px rgba(0,0,0,.25) }[id^=NotificReportWrap].rtl-on a#NXReportButton{float:left }[id^=NotificReportWrap]>div[class*="-overlay"].with-animation{-webkit-animation:report-overlay-animation .3s ease-in-out 0s normal;animation:report-overlay-animation .3s ease-in-out 0s normal }@-webkit-keyframes report-overlay-animation{0%{opacity:0 }100%{opacity:1 }}@keyframes report-overlay-animation{0%{opacity:0 }100%{opacity:1 }}[id^=NotificReportWrap]>div[class*="-content"].with-animation.nx-fade{-webkit-animation:report-animation-fade .3s ease-in-out 0s normal;animation:report-animation-fade .3s ease-in-out 0s normal }@-webkit-keyframes report-animation-fade{0%{opacity:0 }100%{opacity:1 }}@keyframes report-animation-fade{0%{opacity:0 }100%{opacity:1 }}[id^=NotificReportWrap]>div[class*="-content"].with-animation.nx-zoom{-webkit-animation:report-animation-zoom .3s ease-in-out 0s normal;animation:report-animation-zoom .3s ease-in-out 0s normal }@-webkit-keyframes report-animation-zoom{0%{opacity:0;-webkit-transform:scale(.5);transform:scale(.5) }50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05) }100%{opacity:1;-webkit-transform:scale(1);transform:scale(1) }}@keyframes report-animation-zoom{0%{opacity:0;-webkit-transform:scale(.5);transform:scale(.5) }50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05) }100%{opacity:1;-webkit-transform:scale(1);transform:scale(1) }}[id^=NotificReportWrap].remove>div[class*="-overlay"].with-animation{opacity:0;-webkit-animation:report-overlay-animation-remove .3s ease-in-out 0s normal;animation:report-overlay-animation-remove .3s ease-in-out 0s normal }@-webkit-keyframes report-overlay-animation-remove{0%{opacity:1 }100%{opacity:0 }}@keyframes report-overlay-animation-remove{0%{opacity:1 }100%{opacity:0 }}[id^=NotificReportWrap].remove>div[class*="-content"].with-animation.nx-fade{opacity:0;-webkit-animation:report-animation-fade-remove .3s ease-in-out 0s normal;animation:report-animation-fade-remove .3s ease-in-out 0s normal }@-webkit-keyframes report-animation-fade-remove{0%{opacity:1 }100%{opacity:0 }}@keyframes report-animation-fade-remove{0%{opacity:1 }100%{opacity:0 }}[id^=NotificReportWrap].remove>div[class*="-content"].with-animation.nx-zoom{opacity:0;-webkit-animation:report-animation-zoom-remove .3s ease-in-out 0s normal;animation:report-animation-zoom-remove .3s ease-in-out 0s normal }@-webkit-keyframes report-animation-zoom-remove{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1) }50%{opacity:.5;-webkit-transform:scale(1.05);transform:scale(1.05) }100%{opacity:0;-webkit-transform:scale(0);transform:scale(0) }}@keyframes report-animation-zoom-remove{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1) }50%{opacity:.5;-webkit-transform:scale(1.05);transform:scale(1.05) }100%{opacity:0;-webkit-transform:scale(0);transform:scale(0) }}[id^=NotificConfirmWrap]{position:fixed;z-index:4003;width:100%;height:100%;left:0;top:0;padding:10px;-webkit-box-sizing:border-box;box-sizing:border-box;background:transparent;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center }[id^=NotificConfirmWrap].nx-position-center-top{-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start }[id^=NotificConfirmWrap].nx-position-center-bottom{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end }[id^=NotificConfirmWrap].nx-position-left-top{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start }[id^=NotificConfirmWrap].nx-position-left-center{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start }[id^=NotificConfirmWrap].nx-position-left-bottom{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end }[id^=NotificConfirmWrap].nx-position-right-top{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start }[id^=NotificConfirmWrap].nx-position-right-center{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end }[id^=NotificConfirmWrap].nx-position-right-bottom{-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end }[id^=NotificConfirmWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box }[id^=NotificConfirmWrap]>div[class*="-overlay"]{width:100%;height:100%;left:0;top:0;background:rgba(255,255,255,.5);position:fixed;z-index:0 }[id^=NotificConfirmWrap]>div[class*="-overlay"].with-animation{-webkit-animation:confirm-overlay-animation .3s ease-in-out 0s normal;animation:confirm-overlay-animation .3s ease-in-out 0s normal }@-webkit-keyframes confirm-overlay-animation{0%{opacity:0 }100%{opacity:1 }}@keyframes confirm-overlay-animation{0%{opacity:0 }100%{opacity:1 }}[id^=NotificConfirmWrap].remove>div[class*="-overlay"].with-animation{opacity:0;-webkit-animation:confirm-overlay-animation-remove .3s ease-in-out 0s normal;animation:confirm-overlay-animation-remove .3s ease-in-out 0s normal }@-webkit-keyframes confirm-overlay-animation-remove{0%{opacity:1 }100%{opacity:0 }}@keyframes confirm-overlay-animation-remove{0%{opacity:1 }100%{opacity:0 }}[id^=NotificConfirmWrap]>div[class*="-content"]{width:300px;max-width:100%;max-height:96vh;overflow-x:hidden;overflow-y:auto;border-radius:25px;padding:10px;margin:0;-webkit-filter:drop-shadow(0 0 5px rgba(0, 0, 0, .05));filter:drop-shadow(0 0 5px rgba(0, 0, 0, .05));background:#f8f8f8;color:#1e1e1e;position:relative;z-index:1;text-align:center }[id^=NotificConfirmWrap]>div[class*="-content"]::-webkit-scrollbar{width:0;height:0 }[id^=NotificConfirmWrap]>div[class*="-content"]::-webkit-scrollbar-thumb{background:transparent }[id^=NotificConfirmWrap]>div[class*="-content"]::-webkit-scrollbar-track{background:transparent }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]{float:left;width:100%;text-align:inherit }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]>h5{float:left;width:100%;margin:0;padding:0 0 10px;border-bottom:1px solid rgba(0,0,0,.1);color:#32c682;font-family:inherit!important;font-size:16px;line-height:1.4;font-weight:500;text-align:inherit }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div{font-family:inherit!important;margin:15px 0 20px;padding:0 10px;float:left;width:100%;font-size:14px;line-height:1.4;font-weight:normal;color:inherit;text-align:inherit }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div{font-family:inherit!important;float:left;width:100%;margin:15px 0 0;padding:0 }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input{font-family:inherit!important;float:left;width:100%;height:40px;margin:0;padding:0 15px;border:1px solid rgba(0,0,0,.1);border-radius:25px;font-size:14px;font-weight:normal;line-height:1;-webkit-transition:all .25s ease-in-out;-o-transition:all .25s ease-in-out;transition:all .25s ease-in-out;text-align:left }[id^=NotificConfirmWrap].rtl-on>div[class*="-content"]>div[class*="-head"]>div>div>input{text-align:right }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input:hover{border-color:rgba(0,0,0,.1) }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input:focus{border-color:rgba(0,0,0,.3) }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input.nx-validation-failure{border-color:#ff5549 }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-head"]>div>div>input.nx-validation-success{border-color:#32c682 }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-radius:inherit;float:left;width:100%;text-align:inherit }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a{cursor:pointer;font-family:inherit!important;-webkit-transition:all .25s ease-in-out;-o-transition:all .25s ease-in-out;transition:all .25s ease-in-out;float:left;width:48%;padding:9px 5px;border-radius:inherit!important;font-weight:500;font-size:15px;line-height:1.4;color:#f8f8f8;text-align:inherit }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a.confirm-button-ok{margin:0 2% 0 0;background:#32c682 }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a.confirm-button-cancel{margin:0 0 0 2%;background:#a9a9a9 }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a.full{margin:0;width:100% }[id^=NotificConfirmWrap]>div[class*="-content"]>div[class*="-buttons"]>a:hover{box-shadow:inset 0 -60px 5px -5px rgba(0,0,0,.25) }[id^=NotificConfirmWrap].rtl-on>div[class*="-content"]>div[class*="-buttons"],[id^=NotificConfirmWrap].rtl-on>div[class*="-content"]>div[class*="-buttons"]>a{-webkit-transform:rotateY(180deg);transform:rotateY(180deg) }[id^=NotificConfirmWrap].with-animation.nx-fade>div[class*="-content"]{-webkit-animation:confirm-animation-fade .3s ease-in-out 0s normal;animation:confirm-animation-fade .3s ease-in-out 0s normal }@-webkit-keyframes confirm-animation-fade{0%{opacity:0 }100%{opacity:1 }}@keyframes confirm-animation-fade{0%{opacity:0 }100%{opacity:1 }}[id^=NotificConfirmWrap].with-animation.nx-zoom>div[class*="-content"]{-webkit-animation:confirm-animation-zoom .3s ease-in-out 0s normal;animation:confirm-animation-zoom .3s ease-in-out 0s normal }@-webkit-keyframes confirm-animation-zoom{0%{opacity:0;-webkit-transform:scale(.5);transform:scale(.5) }50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05) }100%{opacity:1;-webkit-transform:scale(1);transform:scale(1) }}@keyframes confirm-animation-zoom{0%{opacity:0;-webkit-transform:scale(.5);transform:scale(.5) }50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05) }100%{opacity:1;-webkit-transform:scale(1);transform:scale(1) }}[id^=NotificConfirmWrap].with-animation.nx-fade.remove>div[class*="-content"]{opacity:0;-webkit-animation:confirm-animation-fade-remove .3s ease-in-out 0s normal;animation:confirm-animation-fade-remove .3s ease-in-out 0s normal }@-webkit-keyframes confirm-animation-fade-remove{0%{opacity:1 }100%{opacity:0 }}@keyframes confirm-animation-fade-remove{0%{opacity:1 }100%{opacity:0 }}[id^=NotificConfirmWrap].with-animation.nx-zoom.remove>div[class*="-content"]{opacity:0;-webkit-animation:confirm-animation-zoom-remove .3s ease-in-out 0s normal;animation:confirm-animation-zoom-remove .3s ease-in-out 0s normal }@-webkit-keyframes confirm-animation-zoom-remove{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1) }50%{opacity:.5;-webkit-transform:scale(1.05);transform:scale(1.05) }100%{opacity:0;-webkit-transform:scale(0);transform:scale(0) }}@keyframes confirm-animation-zoom-remove{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1) }50%{opacity:.5;-webkit-transform:scale(1.05);transform:scale(1.05) }100%{opacity:0;-webkit-transform:scale(0);transform:scale(0) }}[id^=NotificLoadingWrap]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:fixed;z-index:4000;width:100%;height:100%;left:0;top:0;right:0;bottom:0;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box;background:rgba(0,0,0,.8);font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif }[id^=NotificLoadingWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box }[id^=NotificLoadingWrap].click-to-close{cursor:pointer }[id^=NotificLoadingWrap]>div[class*="-icon"]{width:60px;height:60px;position:relative;-webkit-transition:top .2s ease-in-out;-o-transition:top .2s ease-in-out;transition:top .2s ease-in-out;margin:0 auto }[id^=NotificLoadingWrap]>div[class*="-icon"] img,[id^=NotificLoadingWrap]>div[class*="-icon"] svg{max-width:unset;max-height:unset;width:100%;height:100%;position:absolute;left:0;top:0 }[id^=NotificLoadingWrap]>p{position:relative;margin:10px auto 0;font-family:inherit!important;font-weight:normal;font-size:15px;line-height:1.4;padding:0 10px;width:100%;text-align:center }[id^=NotificLoadingWrap].with-animation{-webkit-animation:loading-animation-fade .3s ease-in-out 0s normal;animation:loading-animation-fade .3s ease-in-out 0s normal }@-webkit-keyframes loading-animation-fade{0%{opacity:0 }100%{opacity:1 }}@keyframes loading-animation-fade{0%{opacity:0 }100%{opacity:1 }}[id^=NotificLoadingWrap].with-animation.remove{opacity:0;-webkit-animation:loading-animation-fade-remove .3s ease-in-out 0s normal;animation:loading-animation-fade-remove .3s ease-in-out 0s normal }@-webkit-keyframes loading-animation-fade-remove{0%{opacity:1 }100%{opacity:0 }}@keyframes loading-animation-fade-remove{0%{opacity:1 }100%{opacity:0 }}[id^=NotificLoadingWrap]>p.new{-webkit-animation:loading-new-message-fade .3s ease-in-out 0s normal;animation:loading-new-message-fade .3s ease-in-out 0s normal }@-webkit-keyframes loading-new-message-fade{0%{opacity:0 }100%{opacity:1 }}@keyframes loading-new-message-fade{0%{opacity:0 }100%{opacity:1 }}[id^=exNotificBlockWraper]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1000;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;background:rgba(255,255,255,.9);text-align:center;animation-duration:.4s;width:100%;height:100%;left:0;top:0;border-radius:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center }[id^=exNotificBlockWraper] *{-webkit-box-sizing:border-box;box-sizing:border-box }[id^=exNotificBlockWraper]>span[class*="-icon"]{display:block;width:45px;height:45px;position:relative;margin:0 auto }[id^=exNotificBlockWraper]>span[class*="-icon"] svg{width:inherit;height:inherit }[id^=exNotificBlockWraper]>span[class*="-message"]{position:relative;display:block;width:100%;margin:10px auto 0;padding:0 10px;font-family:inherit!important;font-weight:normal;font-size:14px;line-height:1.4 }[id^=exNotificBlockWraper].with-animation{-webkit-animation:block-animation-fade .3s ease-in-out 0s normal;animation:block-animation-fade .3s ease-in-out 0s normal }@-webkit-keyframes block-animation-fade{0%{opacity:0 }100%{opacity:1 }}@keyframes block-animation-fade{0%{opacity:0 }100%{opacity:1 }}[id^=exNotificBlockWraper].with-animation.remove{opacity:0;-webkit-animation:block-animation-fade-remove .3s ease-in-out 0s normal;animation:block-animation-fade-remove .3s ease-in-out 0s normal }@-webkit-keyframes block-animation-fade-remove{0%{opacity:1 }100%{opacity:0 }}@keyframes block-animation-fade-remove{0%{opacity:1 }100%{opacity:0 }}',document.querySelectorAll("head")[0].append(e)})),_defineProperty(this,"buildDownloadTwainPopup",(function(n){var i=document.querySelector("#dtwain-main-container");i&&i.remove(),n?(e.selectorId=n,e.imgCanvasContainer=document.querySelector(n)):e.imgCanvasContainer=document.querySelector(".imageCanVasContainer"),e.imgCanvasContainer.insertAdjacentHTML("beforeend",'<div id=dtwain-main-container>\n        <div class=dTwainOpaqueLayer></div>\n        <div class=downloadTwainPopup-wrap>\n        <div class=downloadTwainPopup-title>\n        <h4>\n        <span>HttpTwain Service</span>\n        </h4>\n        <div class=downloadTwainPopupClose id=downloadTwainPopupClose>\n        <svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=currentColor class="bi bi-x-lg" viewBox="0 0 16 16">\n        <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>\n        </svg>\n        </div>\n        </div>\n        <div class="downloadTwainPopup-description dTwain-add-in-tc">\n        <p class=f16>\n        You will see the following window after you click continue, please click Open <strong> http_twain </strong>to continue the launch process.</p>\n        <p></p>\n        <div class=addin-image-div>\n        <div class=addin-image>\n        <h6><span>Open http_twain</span>?</h6>\n        <p class=open-application>https://extrieve.com wants to open this application</p>\n        <p class=open-application1>\n        <input type=checkbox disabled>\n        <span class=open-links>Always allow extrieve.com to open links of this type in the associated app</span>\n        </p>\n        <div class=btns>\n        <button class=open>Open http_twain</button>\n        <button class=cancel>Cancel</button>\n        </div>\n        </div>\n        </div>\n        <div class="downloadTwainPopup-description dTwain-instruction">\n        <h3>How to install HttpTwain Service</h3>\n        <p>\n        <strong style=margin-right:8px><svg xmlns=http://www.w3.org/2000/svg width=25 height=25 fill=currentColor class="bi bi-download" viewBox="0 0 16 16">\n        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n        </svg></strong><span>Click Download button. </span>\n        </p>\n        <p>\n        <strong style=margin-right:8px><svg xmlns=http://www.w3.org/2000/svg width=25 height=25 fill=currentColor class="bi bi-play-fill" viewBox="0 0 16 16">\n        <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/>\n        </svg></strong><span>Run the downloaded <strong>http_twain.msi</strong> file.</span>\n        </p>\n        <p>\n        <strong style=margin-right:8px><svg xmlns=http://www.w3.org/2000/svg width=25 height=25 fill=currentColor class="bi bi-fast-forward-circle-fill" viewBox="0 0 16 16">\n        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16ZM4.79 5.093 8 7.386V5.5a.5.5 0 0 1 .79-.407l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 8 10.5V8.614l-3.21 2.293A.5.5 0 0 1 4 10.5v-5a.5.5 0 0 1 .79-.407Z"/>\n        </svg></strong><span>Complete the installation process.</span>\n        </p>\n        <p style="color:blue;font-size:small;margin:10px 10px 0px 10px;"><i>&#8220;Ensure you have the necessary administrative privileges for this installation. If you encounter issues, attempt the installation with elevated admin rights or consult your system administrator or relevant team for assistance.&#8221;</i><p>\n        <div class="btnsContainer">\n        <button id="downloadTwain">Download</button>\n        </div>\n        </div>\n        <div class="dTwain-loading-img">\n        <svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink style=margin:auto;background:white;display:block width=100px height=100px viewBox="0 0 100 100" preserveAspectRatio=xMidYMid>\n        <circle cx=50 cy=50 r=32 stroke-width=3 stroke=#1d3f72 stroke-dasharray="50.26548245743669 50.26548245743669" fill=none stroke-linecap=round>\n        <animateTransform attributeName=transform type=rotate dur=1.5384615384615383s repeatCount=indefinite keyTimes=0;1 values="0 50 50;360 50 50"></animateTransform>\n        </circle>\n        <circle cx=50 cy=50 r=28 stroke-width=3 stroke=#5699d2 stroke-dasharray="43.982297150257104 43.982297150257104" stroke-dashoffset=43.982297150257104 fill=none stroke-linecap=round>\n        <animateTransform attributeName=transform type=rotate dur=1.5384615384615383s repeatCount=indefinite keyTimes=0;1 values="0 50 50;-360 50 50"></animateTransform>\n        </circle><text x=30 y=52 font-family=Arial font-size=10 fill=black>Checking</text>\n        </svg>\n        </div>\n        <div class="faq-container"></div>\n        <div id=continueBtn class=btnsContainer>\n        <button>Continue</button>\n        </div>\n        <div id=tryAgainBtn class=btnsContainer>\n        <button>Try Again</button>\n        </div>\n        <div id=switchToviewerCon>\n        <button id=yesToSwitch>Yes</button>\n        <button id=noToSwitch>No</button>\n        </div>\n        <div class=not-see-window-tip><svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=currentColor class="bi bi-info-circle" viewBox="0 0 16 16">\n        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>\n        <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>\n        </svg><span>If you do not see above window, download <strong>http_twain</strong> Service</span> &nbsp;<span class="not-see blue" id="downloadTwainHere">here</span></div>\n        <div class="faq-btn">\n        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#294e95" class="bi bi-chat" viewBox="0 0 16 16">\n        <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894m-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"></path>\n        <text x="3" y="10" font-family="Arial" font-size="5" fill="black">FAQ</text></svg>\n        </div>\n        </div>\n        </div>\n        </div>'),e.addDownloadTwainPopupStyles(),e.divContents=document.querySelector(".dTwain-add-in-tc"),e.popUptitle=document.querySelector(".downloadTwainPopup-title"),e.paraParent=document.querySelector(".dTwain-add-in-tc"),e.loader=document.querySelector(".dTwain-loading-img"),e.retryBtn=document.getElementById("tryAgainBtn"),e.continueBtn=document.getElementById("continueBtn"),e.downloadLink=document.querySelector(".not-see-window-tip"),e.instruction=document.querySelector(".dTwain-instruction"),e.downloadTwain=document.querySelector("#downloadTwain"),e.faqContainer=document.querySelector(".faq-container"),e.switchToviewerCon=document.querySelector("#switchToviewerCon"),e.faqBtn=document.querySelector(".faq-btn"),e.openAppUrl=document.querySelector(".open-application"),e.openApplinks=document.querySelector(".open-links"),e.twainDownloadPopupClose=document.querySelector("#downloadTwainPopupClose"),e.downloadTwainHere=document.querySelector("#downloadTwainHere"),e.prepareUIasPerScreens(),e.attachTwainDownloadEvents();var r=document.querySelector(".CanvasHolder");if(r)var a=r.querySelector("canvas");if(a)var c=a.height;var u=document.querySelector(".dTwainOpaqueLayer");u&&c>675&&(u.style.height=c+50+"px")})),_defineProperty(this,"addDownloadTwainPopupStyles",(function(){var e=document.createElement("style");e.innerText='#dtwain-main-container{display:flex;align-items:center;justify-content:center;}@-webkit-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}.downloadTwainPopup-wrap{box-shadow:rgba(0, 0, 0, 0.12) 0px 1px 3px, rgba(0, 0, 0, 0.24) 0px 1px 3px; position:absolute;top:5%;width:600px;height:auto;padding:10px 20px;box-sizing:border-box;background:#fff;z-index:10;animation:.3s fadeIn;-webkit-animation:.3s fadeIn;border:4px;color:#000;border-radius:4px;line-height:1.4;font-family:"Lato","museo_sans300",Arial,sans-serif;font-size:14px}.downloadTwainPopup-wrap p{margin:0 0 5px; padding: 10px 4px;}.downloadTwainPopup-wrap [type=checkbox]{margin:4px 8px 0 0}.downloadTwainPopup-wrap .hide{display:none!important}.downloadTwainPopup-wrap .downloadTwainPopup-title{font-size:1.5rem;display:flex;justify-content:space-between;align-items:baseline}.downloadTwainPopupClose{cursor:pointer;}.downloadTwainPopupClose>svg{height:21px;width:22px}.downloadTwainPopupClose > svg :hover{cursor:pointer;}.downloadTwainPopup-wrap h3,.downloadTwainPopup-wrap h4,.downloadTwainPopup-wrap h6{font-family:inherit;font-weight:500;color:inherit;margin:0 0 10px;}.downloadTwainPopup-wrap .downloadTwainPopup-title h4{font-weight:400;padding-bottom:10px;margin:10px 0 0;font-size:20px;color:blue;}.downloadTwainPopup-wrap .downloadTwainPopup-title h4 .icon-lsb{margin-right:6px;font-size:22px;vertical-align:middle}.downloadTwainPopup-wrap .downloadTwainPopup-title .icon-close{position:absolute;right:13px;top:8px;display:block;font-size:16px;cursor:pointer}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-confirm h3.subtitle{text-align:center;font-weight:400;font-size:18px;margin:24px 0}.downloadTwainPopup-wrap .downloadTwainPopup-description{max-height:400px;overflow:auto}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-confirm .dTwain-tiles{margin-top:20px}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-confirm .dTwain-tiles .dTwain-tile{font-size:16px;display:flex;align-items:center}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-confirm .dTwain-tiles .dTwain-tile .icon{font-size:26px;display:block;margin-right:8px}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-confirm .dTwain-tiles .dTwain-tile p{margin:12px 0}.downloadTwainPopup-wrap .downloadTwainPopup-description .dTwain-v5-download-confirm{position:relative;display:inline-block;margin-top:20px;margin-bottom:15px;font-size:14px;background:#f8f8f8;border:1px solid #e3e3e3;padding:12px 12px 12px 40px}.terms-and-privacy{margin:0 3px}.downloadTwainPopup-wrap .downloadTwainPopup-description .dTwain-v5-download-confirm a{color:#294e95;text-decoration:underline}.downloadTwainPopup-wrap .downloadTwainPopup-description .dTwain-v5-download-confirm input{font-size:14px;width:16px;height:16px;position:absolute;left:12px;top:10px}.downloadTwainPopup-wrap .downloadTwainPopup-description .dTwain-v5-download-confirm input:after{position:absolute;width:16px;height:16px;top:0;content:" ";color:#fff;display:inline-block;visibility:visible;padding:0 3px;border-radius:3px;background:#fff;border:1px solid #294e95}.downloadTwainPopup-wrap .downloadTwainPopup-description .dTwain-v5-download-confirm input:checked:after{font-size:12px;font-weight:600;background-color:#294e95;border:none}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-confirm .dTwain-v5-download-start{padding:10px 15px;background:#294e95;color:#fff;margin:10px auto;font-weight:700;border:1px solid #294e95;border-radius:4px;cursor:pointer;display:block}.dTwain-add-in-tc .open-agreement:disabled,.dTwain-add-in-tc button:disabled,.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-confirm .dTwain-v5-download-start.disabled{background:#fff;color:#ccc;border-color:#ccc;cursor:default;outline:0}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-checking>p{margin-top:10px}.downloadTwainPopup-wrap .dTwain-loading-img{width:100px;height:100px;margin:10px auto;position:relative}.dTwain-loading-img{display:contents}.btnsContainer{display:flex}.downloadTwainPopup-wrap .dTwain-loading-img p{position:absolute;top:40px;left:0;width:100%;height:20px;line-height:20px;text-align:center;margin:0}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-instruction h3{font-size:16px;margin:15px 0;font-weight:400}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-instruction h3.downloadTwainPopup-description-tips{font-size:14px;font-weight:400}.blue,.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-instruction p {display:flex;align-items:center;padding:4px;}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-instruction p a{color:#294e95}.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-overdue p,.downloadTwainPopup-wrap .downloadTwainPopup-description.dTwain-requestInterrupt p{text-align:center;font-size:18px;margin:24px 0}.downloadTwainPopup-wrap .downloadTwainPopup-description .dTwain-v5-download-ie-tips{padding:0 20px;display:none}@-webkit-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}.dTwain-add-in-tc button{display:inline-block;padding:10px;background:#294e95;color:#fff;margin:10px auto;font-weight:500;border:1px solid #294e95;border-radius:4px;cursor:pointer}.downloadTwainPopup-wrap .addin-image-div{background:#eaeef5;padding:10px;}.downloadTwainPopup-wrap .addin-image-div .addin-image{background-color:#fff;padding: 10px;}.downloadTwainPopup-wrap .addin-image h6,.f16{font-size:16px}.downloadTwainPopup-wrap .addin-image p{font-size:12px;padding:4px;padding-left:18px;}.downloadTwainPopup-wrap .addin-image .open-application{font-size:14px;padding-top:10px;}.downloadTwainPopup-wrap .addin-image .open-application1{padding-top:0;padding-bottom:15px;}.downloadTwainPopup-wrap .addin-image .open{color:#0075e8;background:#fff;border:1px solid #ebebeb;}.downloadTwainPopup-wrap .addin-image .cancel{background:#0075e8;color:#fff;border-color:#0075e8}.downloadTwainPopup-wrap .addin-image .btns{text-align:right}.downloadTwainPopup-wrap .addin-image .btns button{display:inline-block;margin:0px auto;font-weight:400;border-radius:4px;cursor:auto;padding:8px;}.downloadTwainPopup-wrap .find-admin-wrap{position:relative;border:1px solid #c73d00;background:#f8e9de;padding:14px 14px 0 43px;border-radius:4px;margin:10px;display:none}.downloadTwainPopup-wrap .find-admin-wrap .icon{position:absolute;left:15px;top:12px;font-size:20px;color:#c73d00}.downloadTwainPopup-wrap .downloadTwainPopup-description a.open-agreement{visibility:hidden;height:0;display:inherit}.dTwain-add-in-tc .open-agreement:disabled{pointer-events:none}.dTwain-add-in-tc-no-launched .btns,.downloadTwainPopup-wrap .tc{text-align:center}.dTwain-add-in-tc-no-launched button{padding:14px 24px;background:#294e95;color:#fff;margin:0 5px 15px;font-weight:700;border:1px solid #294e95;border-radius:4px;cursor:pointer;outline:0;vertical-align:middle}.not-see-window-tip>svg,.notice-icon{margin-right:10px}.dTwain-add-in-tc-no-launched .stop-journey{background:#fff;color:#294e95}.dTwain-add-in-tc-no-launched .not-see,.dTwain-add-in-tc-try-again .not-see{cursor:pointer}.dTwain-add-in-tc-no-launched i{font-style:normal}.notice-icon{font-size:20px;color:#b92a33;vertical-align:middle}.not-see-window-tip{font-size:16px;display:flex;justify-content:center;align-items:center}.not-see-window-tip .not-see{text-decoration:underline;cursor:pointer;}.dTwainOpaqueLayer{display:block;width:100%;height:675px;position:absolute;top:0;left:0;background-color:#C5CAE9;z-index:1}.twain-prompt-img{width:90%;height:auto;}.serviceBusyStyles{display:flex;align-items:center;width:30%;justify-content:space-evenly;}.dTwain-accordion{background-color:#7986CB !important;color:white !important;cursor:pointer;padding:10px;width:99%;border:none !important;text-align:left;outline:0;font-size:16px;margin:5px auto !important;transition:.4s}.dTwain-accordion:hover,.dTwain-active{background-color:#897f7c !important}.dTwain-accordion:after{content:\'\\002B\';color:white;font-weight:700;float:right;margin-left:5px}.dTwain-active:after{content:\'\\2212\'}.dTwain-panel{padding:0 10px;background-color:#fff;max-height:0;overflow:hidden;transition:max-height .2s ease-out}.faq-container{display:none;}.faq-container #faq-items{height:300px;overflow:auto;}.faq-btn{position:absolute;bottom:10%;left:88%;cursor:pointer;}#switchToviewerCon{display:none;text-align:center;}}',document.querySelector("head").append(e)})),_defineProperty(this,"attachTwainDownloadEvents",(function(){if(e.continueBtn){var n=e.continueBtn.getElementsByTagName("button")[0];n&&n.addEventListener("click",(function(){e.prepareUIasPerScreens("loaderScreen")}))}if(e.retryBtn){var i=e.retryBtn.getElementsByTagName("button")[0];i&&i.addEventListener("click",(function(){e.prepareUIasPerScreens("loaderScreen")}))}e.twainDownloadPopupClose&&e.twainDownloadPopupClose.addEventListener("click",(function(){e.closeDownloadTwainPopup()})),e.downloadTwainHere&&e.downloadTwainHere.addEventListener("click",(function(){e.prepareUIasPerScreens("twainDownloadScreen")})),e.downloadTwain&&e.downloadTwain.addEventListener("click",(function(){e.selectorId?(e.showHideElements([e.loader],"none"),e.showHideElements([e.downloadTwain],"block")):(e.showHideElements([e.loader],"contents"),e.showHideElements([e.downloadTwain],"none"),e.downloadTwainClicked=!0),e.downloadInstaller()})),e.faqBtn&&e.faqBtn.addEventListener("click",(function(){e.showFAQpopUp()}))})),_defineProperty(this,"closeDownloadTwainPopup",(function(){var e=document.querySelector("#dtwain-main-container"),n=document.querySelector(".dTwainOpaqueLayer");e&&e.remove(),n&&(n.style.height="100%")})),_defineProperty(this,"prepareUIasPerScreens",(function(n){switch(n){case"loaderScreen":e.popUpSecondScreen();break;case"twainDownloadScreen":e.popUpFourthScreen();break;default:e.popUpfirstScreen()}})),_defineProperty(this,"popUpfirstScreen",(function(){e.openAppUrl.textContent=window.location.origin+" wants to open this application.",e.openApplinks.textContent=" Always allow "+window.location.origin+" to open links of this type in the associated app.",e.showHideElements([e.loader,e.retryBtn,e.downloadLink,e.instruction,e.divContents.querySelectorAll("p")[1],e.faqBtn],"none")})),_defineProperty(this,"popUpSecondScreen",(function(){e.showHideElements([e.loader],"contents"),e.showHideElements([e.continueBtn,e.retryBtn,e.downloadLink,e.instruction,e.faqBtn],"none");var n=0;e.internalTriggerHttpTwain();var i=setInterval((function(){if(n<5){var r=exWebDocViewerCtrl.getTwainStatus();if(r.active)return clearInterval(i),void e.closeDownloadTwainPopup();0==r.active&&n++,4===n&&e.popUpThirdScreen()}else clearInterval(i)}),1e3)})),_defineProperty(this,"popUpThirdScreen",(function(){e.showHideElements([e.loader,e.continueBtn,e.instruction,e.faqBtn],"none"),e.showHideElements([e.retryBtn,e.downloadLink],"flex"),e.downloadLink.onClick=function(){this.prepareUIasPerScreens("twainDownloadScreen")}})),_defineProperty(this,"popUpFourthScreen",(function(){e.showHideElements([e.loader,e.retryBtn,e.continueBtn,e.downloadLink,e.divContents.querySelector("p"),e.divContents.querySelector(".addin-image-div")],"none"),e.title=e.popUptitle.querySelector("span"),e.title.textContent="Download HttpTwain Service.",e.showHideElements([e.instruction,e.faqBtn],"block")})),_defineProperty(this,"showTwainStatusMsg",(function(n,i,r,a){var c=document.querySelector("#dtwain-main-container");if(!(n&&i&&c)){e.buildDownloadTwainPopup(),e.showHideElements([e.loader,e.retryBtn,e.continueBtn,e.downloadLink,e.instruction,e.divContents.querySelector(".addin-image-div")],"none");e.popUptitle.querySelector("h4").insertAdjacentHTML("afterbegin",'<svg xmlns=http://www.w3.org/2000/svg width=20 height=20 fill=currentColor class="bi bi-exclamation-triangle" viewBox="0 0 16 16">\n        <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z"/>\n        <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z"/>\n        </svg>'),e.popUptitle.querySelector("h4").className="serviceBusyStyles",e.title=e.popUptitle.querySelector("span"),e.title.textContent=r?"Service Lost":"Service Busy";var u=JSON.parse(localStorage.getItem("TWAIN_RESERVE_INFO"))?JSON.parse(localStorage.getItem("TWAIN_RESERVE_INFO")).app_name:null;e.divContents.querySelectorAll("p")[0].textContent=u?"Viewer service is currently in use by: ".concat(u,"."):r?"Current viewer service is lost.":"Viewer service is currently in use.",e.showHideElements([e.divContents.querySelectorAll("p")[1]],"block"),e.divContents.querySelectorAll("p")[1].textContent=r?"Due to other viewer instance service is activated.":"Please close other viewer instance to continue access."}})),_defineProperty(this,"downloadInstaller",(function(e){var n=document.createElement("a"),i=e||"https://expack.extrieve.in/share/httptwain/v2.0.10/978872ff3242cbadd2dcee50b2ecf150e7db06583163802c2981c8be01271801/HttpTwainSetup.msi";n.setAttribute("href",i),n.setAttribute("download","HttpTwainSetup.msi"),n.click(),n.remove()})),_defineProperty(this,"internalTriggerHttpTwain",(function(){var e=document.createElement("iframe");e.style.display="none",e.src="Extrieve://";try{document.body.appendChild(e)}catch(e){}setTimeout((function(){document.body.removeChild(e)}),1e3)})),_defineProperty(this,"showHideElements",(function(e,n){for(var i=0;i<e.length;i++)e[i].style.display=n})),_defineProperty(this,"fetchFaqData",(function(){return JSON.parse(h.faqData)})),_defineProperty(this,"showFAQpopUp",(function(){var n=e.fetchFaqData(),i=document.createElement("div");i.id="faq-items";for(var r=e,a=function _loop(){var e=document.createElement("button"),a=document.createElement("div"),u=document.createElement("p");e.className="dTwain-accordion",e.textContent=n[c].question,u.textContent=n[c].answer,a.className="dTwain-panel",a.append(u),i.append(e,a),e.addEventListener("click",(function(){r.toggleFAQ(e),e.classList.toggle("dTwain-active");var n=e.nextElementSibling;n.style.maxHeight?n.style.maxHeight=null:n.style.maxHeight=n.scrollHeight+"px"}))},c=0;c<n.length;c++)a();e.faqContainer.innerHTML="",e.faqContainer.append(i),e.faqContainer.insertAdjacentHTML("beforeend",'<div class=btnsContainer><button id="closeFAQ">Close</button></div>'),"contents"===e.loader.style.display&&e.showHideElements([e.loader],"none"),e.showHideElements([e.instruction,e.faqBtn],"none"),e.title=e.popUptitle.querySelector("span"),e.title.textContent="Frequently Asked Questions.",e.showHideElements([e.faqContainer],"block"),document.getElementById("closeFAQ").addEventListener("click",(function(){e.closeFAQpopUp()}))})),_defineProperty(this,"closeFAQpopUp",(function(){e.showHideElements([e.instruction,e.faqBtn],"block"),e.title=e.popUptitle.querySelector("span"),e.title.textContent="Download HttpTwain Service.",e.showHideElements([e.faqContainer],"none"),e.downloadTwainClicked&&e.showHideElements([e.loader],"contents")})),_defineProperty(this,"toggleFAQ",(function(e){for(var n=document.querySelectorAll(".dTwain-accordion"),i=0;i<n.length;i++)if(n[i].classList.contains("dTwain-active")&&n[i]!=e){n[i].classList.toggle("dTwain-active");var r=n[i].nextElementSibling;r.style.maxHeight?r.style.maxHeight=null:r.style.maxHeight=r.scrollHeight+"px"}})),this.popUptitle=null,this.paraParent=null,this.loader=null,this.retryBtn=null,this.continueBtn=null,this.downloadLink=null,this.instruction=null,this.divContents=null,this.downloadTwainClicked=null})),h={faqData:'[\n        {\n            "question": "What are the prerequisites for ensuring successful installation ?",\n            "answer": "Ensure you have the necessary administrative privileges for this installation. If you encounter issues, attempt the installation with elevated admin rights or consult your system administrator or relevant team for assistance."\n        },\n        {\n            "question": "The installation process is taking too long. Is this normal?",\n            "answer": "Installation times can vary, but if it\'s significantly prolonged, ensure that you have a stable internet connection. You may also want to check if there are any background processes affecting system performance."\n        },\n        {\n            "question": "I\'m getting an error during installation. What should I do?",\n            "answer": "Take note of the error message. Common issues include incompatible operating systems, insufficient system resources, or conflicting drivers. Verify system requirements and ensure you have the necessary permissions for installation."\n        },\n        {\n            "question": "The HttpTwain is installed, but my device is not recognized.",\n            "answer": "Ensure that the device is properly connected and powered on. Check if the device is compatible with the installed HttpTwain version. Reinstall the HttpTwain."\n        },\n        {\n            "question": "I can\'t find the HttpTwain after installation. Where is it located?",\n            "answer": "HttpTwain may be located in the Extrieve directory in program files. eg :(C:Program Files (x86)ExtrieveHttpTwain)."\n        },\n        {\n            "question": "The HttpTwain is installed, but it\'s not functioning correctly.",\n            "answer": "Check the HttpTwain service is installed properly in your system. if so please try to restart your system and try again."\n        },\n        {\n            "question": "The HttpTwain is getting crash, what should I do?",\n            "answer": "Please try to restart your system and start the process from the beginning."\n        }\n    ]'};e.exports={exNotifier:u,exWebDocViewer:n}},556:module=>{function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,n,i){return n&&_defineProperties(e.prototype,n),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var n=_toPrimitive(e,"string");return"symbol"==_typeof(n)?n:n+""}function _toPrimitive(e,n){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,n||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return n};var e,n={},i=Object.prototype,r=i.hasOwnProperty,a=Object.defineProperty||function(e,n,i){e[n]=i.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",h=c.asyncIterator||"@@asyncIterator",p=c.toStringTag||"@@toStringTag";function define(e,n,i){return Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{define({},"")}catch(e){define=function define(e,n,i){return e[n]=i}}function wrap(e,n,i,r){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype),h=new Context(r||[]);return a(u,"_invoke",{value:makeInvokeMethod(e,i,h)}),u}function tryCatch(e,n,i){try{return{type:"normal",arg:e.call(n,i)}}catch(e){return{type:"throw",arg:e}}}n.wrap=wrap;var d="suspendedStart",f="suspendedYield",m="executing",g="completed",v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var w={};define(w,u,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(values([])));b&&b!==i&&r.call(b,u)&&(w=b);var _=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(w);function defineIteratorMethods(e){["next","throw","return"].forEach((function(n){define(e,n,(function(e){return this._invoke(n,e)}))}))}function AsyncIterator(e,n){function invoke(i,a,c,u){var h=tryCatch(e[i],e,a);if("throw"!==h.type){var p=h.arg,d=p.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?n.resolve(d.__await).then((function(e){invoke("next",e,c,u)}),(function(e){invoke("throw",e,c,u)})):n.resolve(d).then((function(e){p.value=e,c(p)}),(function(e){return invoke("throw",e,c,u)}))}u(h.arg)}var i;a(this,"_invoke",{value:function value(e,r){function callInvokeWithMethodAndArg(){return new n((function(n,i){invoke(e,r,n,i)}))}return i=i?i.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(n,i,r){var a=d;return function(c,u){if(a===m)throw Error("Generator is already running");if(a===g){if("throw"===c)throw u;return{value:e,done:!0}}for(r.method=c,r.arg=u;;){var h=r.delegate;if(h){var p=maybeInvokeDelegate(h,r);if(p){if(p===v)continue;return p}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===d)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var w=tryCatch(n,i,r);if("normal"===w.type){if(a=r.done?g:f,w.arg===v)continue;return{value:w.arg,done:r.done}}"throw"===w.type&&(a=g,r.method="throw",r.arg=w.arg)}}}function maybeInvokeDelegate(n,i){var r=i.method,a=n.iterator[r];if(a===e)return i.delegate=null,"throw"===r&&n.iterator.return&&(i.method="return",i.arg=e,maybeInvokeDelegate(n,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var c=tryCatch(a,n.iterator,i.arg);if("throw"===c.type)return i.method="throw",i.arg=c.arg,i.delegate=null,v;var u=c.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,v)}function pushTryEntry(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function resetTryEntry(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(n){if(n||""===n){var i=n[u];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,c=function next(){for(;++a<n.length;)if(r.call(n,a))return next.value=n[a],next.done=!1,next;return next.value=e,next.done=!0,next};return c.next=c}}throw new TypeError(_typeof(n)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,a(_,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),a(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===GeneratorFunction||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,p,"GeneratorFunction")),e.prototype=Object.create(_),e},n.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,h,(function(){return this})),n.AsyncIterator=AsyncIterator,n.async=function(e,i,r,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(e,i,r,a),c);return n.isGeneratorFunction(i)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},defineIteratorMethods(_),define(_,p,"Generator"),define(_,u,(function(){return this})),define(_,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),i=[];for(var r in n)i.push(r);return i.reverse(),function next(){for(;i.length;){var e=i.pop();if(e in n)return next.value=e,next.done=!1,next}return next.done=!0,next}},n.values=values,Context.prototype={constructor:Context,reset:function reset(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!n)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function dispatchException(n){if(this.done)throw n;var i=this;function handle(r,a){return u.type="throw",u.arg=n,i.next=r,a&&(i.method="next",i.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var c=this.tryEntries[a],u=c.completion;if("root"===c.tryLoc)return handle("end");if(c.tryLoc<=this.prev){var h=r.call(c,"catchLoc"),p=r.call(c,"finallyLoc");if(h&&p){if(this.prev<c.catchLoc)return handle(c.catchLoc,!0);if(this.prev<c.finallyLoc)return handle(c.finallyLoc)}else if(h){if(this.prev<c.catchLoc)return handle(c.catchLoc,!0)}else{if(!p)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return handle(c.finallyLoc)}}}},abrupt:function abrupt(e,n){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===e||"continue"===e)&&c.tryLoc<=n&&n<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=e,u.arg=n,c?(this.method="next",this.next=c.finallyLoc,v):this.complete(u)},complete:function complete(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),v},finish:function finish(e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),resetTryEntry(i),v}},catch:function _catch(e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var a=r.arg;resetTryEntry(i)}return a}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(n,i,r){return this.delegate={iterator:values(n),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),v}},n}function asyncGeneratorStep(e,n,i,r,a,c,u){try{var h=e[c](u),p=h.value}catch(e){return void i(e)}h.done?n(p):Promise.resolve(p).then(r,a)}function _asyncToGenerator(e){return function(){var n=this,i=arguments;return new Promise((function(r,a){var c=e.apply(n,i);function _next(e){asyncGeneratorStep(c,r,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(c,r,a,_next,_throw,"throw",e)}_next(void 0)}))}}var exWebDocViewerCtrl=function(){var Twain=null,twainStatus=null,viewerVersion="2, 0, 0, 0",IWizNavigationOptions={NAVIGATION_FIRSTPAGE:-1,NAVIGATION_NEXTPAGE:-2,NAVIGATION_PREVIOUSPAGE:-3,NAVIGATION_LASTPAGE:-4,NAVIGATION_PAGENUMBER:-5,NAVIGATION_FIRSTDOCUMENT:-6,NAVIGATION_NEXTDOCUMENT:-7,NAVIGATION_PREVIOUSDOCUMENT:-8,NAVIGATION_LASTDOCUMENT:-9,NAVIGATION_DOCUMENTINDEX:-10,NAVIGATION_FIRSTAVAILABLE:-15,NAVIGATION_NEXTAVAILABLE:-16,NAVIGATION_PREVIOUSAVAILABLE:-17,NAVIGATION_LASTAVAILABLE:-18},IWizNavigationResult={NAVIGATION_BADIMAGE:-1,NAVIGATION_INVALID:0,NAVIGATION_OK:1,NAVIGATION_NOTAVAILABLE:2,NAVIGATION_DOWNLOADING:3},IWizURLAttributeMasks={URLATTRIBUTE_MASK_KIND:7,URLATTRIBUTE_MASK_TEST:112,URLATTRIBUTE_MASK_MODIFIED:1792,URLATTRIBUTE_MASK_INTERNAL:30583},IWizURLAttributes={URLATTRIBUTE_INTERNET_SCHEME:1,URLATTRIBUTE_DRIVE_FILE:2,URLATTRIBUTE_UNC_FILE:4,URLATTRIBUTE_AVAILABLE:16,URLATTRIBUTE_ERROR:32,URLATTRIBUTE_DOWNLOADING:64,URLATTRIBUTE_UPLOADING:128,URLATTRIBUTE_MODIFIED:256,URLATTRIBUTE_BLOBURL:512},IWizThumbnailFormats={IWIZTHUMBNAIL_DEFAULT:0,IWIZTHUMBNAIL_GIF:1,IWIZTHUMBNAIL_JPEG:2,IWIZTHUMBNAIL_GIFURL:3,IWIZTHUMBNAIL_JPEGURL:4},IWizThumbnailPrefix={IWIZTHUMBNAIL_PREFIXEXCLUDE:-1,IWIZTHUMBNAIL_PREFIXDEFAULT:0,IWIZTHUMBNAIL_PREFIXINCLUDE:1},IWizViewDisplayOptions={IWIZ_DISPLAY_FITWIDTH:1,IWIZ_DISPLAY_FITHEIGHT:2,IWIZ_DISPLAY_FITWINDOW:3},IWizTWAINScanMode={IWizTWAINScanMode_UNKNOWN:-1,IWizTWAINScanMode_LINEART:0,IWizTWAINScanMode_HALFTONE:1,IWizTWAINScanMode_ERROR_DIFFUSION:2,IWizTWAINScanMode_4GRAY:3,IWizTWAINScanMode_6GRAY:4,IWizTWAINScanMode_8GRAY:5,IWizTWAINScanMode_24COLOR:6,IWizTWAINScanMode_MONOPOS:7,IWizTWAINScanMode_MONONEG:8,IWizTWAINScanMode_COLORPOS:9,IWizTWAINScanMode_COLORNEG:10,IWizTWAINScanMode_8COLOR:11,IWizTWAINScanMode_8COLORERROR:12},IWizTWAINPaperFormat={IWizTWAINPaperFormat_UNKNOWN:-1,IWizTWAINPaperFormat_CUSTOM:0,IWizTWAINPaperFormat_A4:1,IWizTWAINPaperFormat_B5:2,IWizTWAINPaperFormat_USLETTER:3,IWizTWAINPaperFormat_USLEGAL:4,IWizTWAINPaperFormat_A5:5,IWizTWAINPaperFormat_B4:6,IWizTWAINPaperFormat_B6:7,IWizTWAINPaperFormat_EXECUTIVE:8,IWizTWAINPaperFormat_FOTO13X9:9,IWizTWAINPaperFormat_FOTO15X10:10,IWizTWAINPaperFormat_DBUSLETTER:11,IWizTWAINPaperFormat_A3:12},IWizTWAINCapIndexValue={IWizTWAINCapValueIndex_CURRENTVALUE:-1,IWizTWAINCapValueIndex_ISRANGE:-2,IWizTWAINCapValueIndex_MINVALUE:-3,IWizTWAINCapValueIndex_MAXVALUE:-4,IWizTWAINCapValueIndex_STEPSIZE:-5},IWizAcquisitionSource={IWizAcquisitionSource_SCANNER:1,IWizAcquisitionSource_FILE:2,IWizAcquisitionSource_IMAGE:3},IWizTWAINPixelType={IWizTWAINPixelType_UNKNOWN:-1,IWizTWAINPixelType_BW:0,IWizTWAINPixelType_GRAY:1,IWizTWAINPixelType_RGB:2,IWizTWAINPixelType_PALETTE:3,IWizTWAINPixelType_CMY:4,IWizTWAINPixelType_CMYK:5,IWizTWAINPixelType_YUV:6,IWizTWAINPixelType_YUVK:7,IWizTWAINPixelType_CIEXYZ:8},IWizTWAINStates={IWizTWAINSTATE_PRESESSION:1,IWizTWAINSTATE_SOURCEMANAGERLOADED:2,IWizTWAINSTATE_SOURCEMANAGEROPENED:3,IWizTWAINSTATE_SOURCEOPENED:4,IWizTWAINSTATE_SOURCEENABLED:5,IWizTWAINSTATE_TRANSFERREADY:6,IWizTWAINSTATE_TRANSFERRING:7},IWizTWAINWarnings={IWizTWAINWarning_SUPPORTEDCAPS:11,IWizTWAINWarning_INDICATORS:17,IWizTWAINWarning_VISIBILITY:100,IWizTWAINWarning_PAPERFORMAT:103},IWizViewerMouseTools={IWizMouseTool_Zoom:1,IWizMouseTool_Pan:2,IWizMouseTool_Magnifier:3},IWizViewerAnnotations={IWizAnnotation_Rectangle:1,IWizAnnotation_Line:2},IWizDespeckleMethods={IWizDespeckle_Erosion:1,IWizDespeckle_Speck:2},IWizLineRemovalType={IWizLineRemoval_Horizontal:1,IWizLineRemoval_Vertical:2,IWizLineRemoval_Both:3},IWizFillColourType={IWizFillColour_White:1,IWizFillColour_Black:2},IWizScrollOptions={IWizScroll_LineUp:1,IWizScroll_LineDown:2,IWizScroll_LineLeft:3,IWizScroll_LineRight:4,IWizScroll_PageUp:5,IWizScroll_PageDown:6,IWizScroll_PageRight:7,IWizScroll_PageLeft:8,IWizScroll_X:9,IWizScroll_Y:10},IWizProfileOperationResult={IWizProfile_InternalError:-5,IWizProfile_NotSupported:-4,IWizProfile_Cancelled:-3,IWizProfile_Exists:-2,IWizProfile_NotAvailable:-1,IWizProfile_NoSource:0,IWizProfile_Created:1,IWizProfile_Updated:2},IWizTWAINAcquirePlacement={IWizTWAINPlacement_NOWHERE:-1,IWizTWAINPlacement_APPEND:0,IWizTWAINPlacement_INSERTAFTER:1,IWizTWAINPlacement_INSERTBEFORE:2,IWizTWAINPlacement_OVERWRITE:3},IWizTWAINUIOptions={IWIZ_TWAINUI_DEFAULT:-1,IWIZ_TWAINUI_NORMAL:0,IWIZ_TWAINUI_MODAL:1,IWIZ_TWAINUI_PROGRESS:2,IWIZ_TWAINUI_HIDDEN:3},IWizImageOpenPurpose={IWIZIMAGE_OPEN_VIEWING:1,IWIZIMAGE_OPEN_PRINTING:2,IWIZIMAGE_OPEN_OTHER:3},IWizURLBindingVerbs={BINDVERB_GET:1,BINDVERB_POST:2},IWizImageRotate={CLOCKWISE:1,ANTI_CLOCKWISE:-1},IWizImageZoom={ZOOM_IN:1,ZOOM_OUT:-1},IWizFileType={TIFF:"image/tif",JPEG:"image/jpeg",PNG:"image/png",BMP:"image/bmp"},InsertType={INSERT_END:1,REPLACE_CURRENT:2,INSERT_BEFORE:3,INSERT_AFTER:4,INSERT_START:5},initialise=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(e,n,i,r){var a,c,u;return _regeneratorRuntime().wrap((function _callee$(h){for(;;)switch(h.prev=h.next){case 0:if(a=i+"_ImageWiz",!r){h.next=8;break}return(c=new DocWiz(a,e,n)).ViewOnlyMode=!0,Twain=r.GetScanner(),c.Scanner=Twain,c.Library.URLList=r.Library.URLList,h.abrupt("return",c);case 8:return twainStatus=new ClsTwainStatus,u=new DocWiz(a,e,n),Twain=u.GetScanner(),h.abrupt("return",u);case 12:case"end":return h.stop()}}),_callee)})));return function initialise(n,i,r,a){return e.apply(this,arguments)}}(),getTwainStatus=function getTwainStatus(){return twainStatus},getTwain=function getTwain(){return Twain},DocWiz=function(){return _createClass((function DocWiz(e,n,i){_classCallCheck(this,DocWiz);try{if(!e)throw"Undefined"}catch(e){}return this.DOM_ID=e,this.Library=null,this.Viewer=null,this.Scanner=null,this.AppName=n||"",this.Url=i||"",this.ThumbnailSize=0,this.ThumbnailFormat=null,this.ThumbnailPrefix=null,this.LibraryAutoDownload=!1,this.ContentAutoDownload=!1,this.NavigateAutoDownload=!1,this.ShowStatusOnNavigateDownload=!1,this.ResetDisplayOptionOnNavigate=!0,this.OutputMakeCopy=!1,this.CopyPath="",this.MaxDownloads=0,this.MaxUploads=0,this.URLGetBindingFlags=0,this.URLPostBindingFlags=0,this.URLGetBufferSize=0,this.URLPostBufferSize=0,this.DisplayOption=null,this.ViewerAutoSave=!1,this.FileFormat1BPP=0,this.FileFormatNBPP=0,this.CacheFileURLs=!1,this.JPEGCompQuality=0,this.BarcodeReader=null,this.SystemInfo=null,this.ScanWizAppId=1,this.WindowOnly=!0,this.Util=null,this.Imaging=null,this.hViewInstance=null,this.HWnd=e,this.URLList=null,this.TextToDraw="ImageWizX",this.ViewerURLOpListener=null,this.Closed=!1,this.ScheduledOps=[],this.Outputs=[],this.ActiveOps=[],this.OutputAutoCopy=!1,this.OutputCopyPath="",this._LibIndex=new Map,this._AttachIndex=0,this.AttachDisplayOrder="lastpage",this.ScannedCount=0,this.CurrentCount=0,this.CurrentURLOps=null,this.ViewOnlyMode=!1,this.initialise(this),prepare_appevents(this),this}),[{key:"initialise",value:function initialise(e){var n;n=e.HWnd?e.HWnd:"ImageWiz",e.hViewInstance=new IVLibrary(n),e.Util=new IWizUtil,e.Imaging={},e.Imaging=new IWizImaging;var i=this.createImagePlaceHolder();e.Viewer=new IWizViewer(e,e.hViewInstance,i,e.Imaging,e.Util,null),e.ViewerURLOpListener=e.Viewer.URLOpListener,e.Viewer.Parent=e,e.Library=new DocLibrary([],e.Imaging),e.Library.Parent=e,e.Library.Util=e.Util,e.Library.ListenerData="";var r=e.GetScanner();r.pulse.addEventListener("acquire/file",e.acquire_file_info.bind(e)),r.pulse.addEventListener("acquire/download",e.acquire_download.bind(e)),r.pulse.addEventListener("output/upload",e.upload_document.bind(e)),r.pulse.addEventListener("acquire/folder",e.acquire_file_info.bind(e)),r.pulse.addEventListener("twain/source/enable",e.acquire_file_info.bind(e)),r.pulse.addEventListener("twain/source/disable",e.acquire_file_info.bind(e)),r.pulse.addEventListener("twain/source/close",e.acquire_file_info.bind(e)),r.pulse.addEventListener("disablesource",e.acquire_file_info.bind(e))}},{key:"AddCallBackSupport",value:function AddCallBackSupport(e,n){if(!this.EventHandler[e])return!1;n instanceof Function&&(this.EventHandler[e]=n)}},{key:"createImagePlaceHolder",value:function createImagePlaceHolder(){var e="imgPlaceHolder_"+this.DOM_ID,n=document.getElementById(e);if(n)return n;var i=document.createElement("img");return i.id=e,i.src="",i.title="tempImageHolder",i.alt="tempImageHolder",i.style.display="none",document.body.appendChild(i),i}},{key:"GetScanner",value:function GetScanner(){return null==this.Scanner&&(this.Scanner=new twainCtrl.jsTwain(this.AppName,this.Url)),this.Scanner}},{key:"acquire_download",value:function acquire_download(e){var n=GetCustomEventData(this.Scanner.pulse,e);null==this.CurrentURLOps&&(this.CurrentURLOps=new IWizURLOperation(n.appref,1));var i={URLOperation:this.CurrentURLOps,Operation:"DOWNLOAD"};if(this.CurrentURLOps.SetResponse(n),0==this.CurrentURLOps.Started&&(this.URLOpStart(i,this.CurrentURLOps.URL,n.appref),this.CurrentURLOps.Started=!0),n&&n.data){if(n.hasOwnProperty("status")&&"completed"==n.status)return this.URLOpCompleted(i,this.CurrentURLOps.URL,this.CurrentURLOps.BytesDone,n.appref),this.CurrentURLOps,!0;var r=n.data.image_count,a=this.Viewer.Contents.AppId,c=n.appref,u=this.Library.Add(c,r,a,null);if(!u)throw new Error("find and fix this error");if(u.FileName=n.appref,this.URLOpProgress(i,this.CurrentURLOps.URL,this.CurrentURLOps.Status,this.CurrentURLOps.BytesDone,this.CurrentURLOps.TotalBytes,this.CurrentURLOps.StatusText,n.appref),this.CurrentURLOps.DisplayPage){var h=this.Viewer;setTimeout((function(){h.ReloadImage(r)}))}}else this.URLOpProgress(i,this.CurrentURLOps.URL,this.CurrentURLOps.Status,this.CurrentURLOps.BytesDone,this.CurrentURLOps.TotalBytes,this.CurrentURLOps.StatusText,n.appref)}},{key:"upload_document",value:function upload_document(e){var n=GetCustomEventData(this.Scanner.pulse,e);null==this.CurrentURLOps&&(this.CurrentURLOps=new IWizURLOperation(n.appref,1));var i={URLOperation:this.CurrentURLOps,Operation:"UPLOAD"};if(this.CurrentURLOps.SetResponse(n),0==this.CurrentURLOps.Started&&(this.URLOpStart(i,this.CurrentURLOps.URL,n.appref),this.CurrentURLOps.Started=!0),n&&n.hasOwnProperty("status")&&"success"==n.status)return this.CurrentURLOps,!0;this.URLOpProgress(i,this.CurrentURLOps.URL,this.CurrentURLOps.Status,this.CurrentURLOps.BytesDone,this.CurrentURLOps.TotalBytes,this.CurrentURLOps.StatusText,n.appref)}},{key:"acquire_file_info",value:function acquire_file_info(e){var n=GetCustomEventData(this.Scanner.pulse,e),i={};if(n&&n.data){if(n.hasOwnProperty("status")&&"completed"==n.status)return i.NumAccepted=n.data.acquired_count,i.data=n.data,this.AcquisitionCompleted(i),!0;if("ui closed"==n.data&&"disablesource"==n.method)return i.NumAccepted=this.ScannedCount,i.data=null,this.AcquisitionCompleted(i),!0;var r,a=n.data,c=a.image_count;if(!c)return!0;a.scanned_count?(a.page=a.scanned_count,r="Scanned - "+c,this.ScannedCount=a.scanned_count):r=a.filename;var u=this.Viewer.Contents.AppId,h=null,p=this.Viewer.CurrentContentIndex,d=this.Library.NumAvailable(u),f=this.GetScanner();if(d)switch(f.selectType){case InsertType.INSERT_BEFORE:1==a.page?(h=p,this._AttachIndex=h):h=this._AttachIndex;break;case InsertType.INSERT_AFTER:1==a.page?(h=p+1,this._AttachIndex=h):h=this._AttachIndex+1;break;case InsertType.INSERT_START:h=1,this._AttachIndex=1;break;case InsertType.INSERT_END:break;case InsertType.REPLACE_CURRENT:1==a.page?(h=p,this._AttachIndex=h):h=this._AttachIndex+1}(i={}).data=n.data,i.NumAccepted=n.data.acquired_count,i.Accept=!0,i.imgIndex=c;var m=this.prepareImageObject(c);if(this.AcquiredImage(i,m),0==i.Accept)return!1;if(f.selectType==InsertType.REPLACE_CURRENT)return void this.Library.Replace(p,c,u);var g=this.Library.Add(r,c,u,h);if(!g)throw new Error("find and fix this error");g.FileName=a.filename,this.Viewer.Contents.LoadFromLib(u)}}},{key:"prepareImageObject",value:function prepareImageObject(e){var n={};n.src_number=e;var i=this.GetScanner(),r=new IWizImage(i);return r.Internal1=n.src_number,r&&r.Initialise(this.Library.ImageFunctions,n,1,IWizImageOpenPurpose.IWIZIMAGE_OPEN_OTHER,null),r}},{key:"OnCreate",value:function OnCreate(){return 0}},{key:"NewOutput",value:function NewOutput(e){if(!e)return!1;var n=new IWizOutput(this.Util,this.Imaging,this);return n.Name=e,n.HaveError=!1,n&&this.Outputs.push(n),n}},{key:"LibraryElementAdded",value:function LibraryElementAdded(e,n){return this.EventHandler.LibraryElementAdded instanceof Function&&this.EventHandler.LibraryElementAdded.call(this,e,n),!0}},{key:"LibraryElementBeingRemoved",value:function LibraryElementBeingRemoved(e,n){return this.EventHandler.LibraryElementBeingRemoved instanceof Function&&this.EventHandler.LibraryElementBeingRemoved.call(this,e,n),!0}},{key:"LibraryElementsCleared",value:function LibraryElementsCleared(){return this.EventHandler.LibraryElementsCleared instanceof Function&&this.EventHandler.LibraryElementsCleared.call(this),!0}},{key:"ContentElementAdded",value:function ContentElementAdded(e,n){return this.EventHandler.ContentElementAdded instanceof Function&&this.EventHandler.ContentElementAdded.call(this,e,n),!0}},{key:"ContentElementBeingRemoved",value:function ContentElementBeingRemoved(e,n){return this.EventHandler.ContentElementBeingRemoved instanceof Function&&this.EventHandler.ContentElementBeingRemoved.call(this,e,n),!0}},{key:"ContentElementsCleared",value:function ContentElementsCleared(){return this.EventHandler.ContentElementsCleared instanceof Function&&this.EventHandler.ContentElementsCleared.call(this),!0}},{key:"ContentElementMoved",value:function ContentElementMoved(e,n,i){return this.EventHandler.ContentElementMoved instanceof Function&&this.EventHandler.ContentElementMoved.call(this,e,n,i),!0}},{key:"AddOutputImage",value:function AddOutputImage(e,n){return this.EventHandler.AddOutputImage instanceof Function&&this.EventHandler.AddOutputImage.call(this,e,n),!0}},{key:"HaveNewAnnotation",value:function HaveNewAnnotation(e,n,i,r,a){if(e){this.Viewer.Image;var c=1|n,u=1|i,h=1|r,p=1|a;return this.EventHandler.AnnotationDrawn instanceof Function&&this.EventHandler.AnnotationDrawn({},e,c,u,h,p),!0}}},{key:"SetScannerDefaults",value:function SetScannerDefaults(){this.Scanner.SetUIOption(IWIZ_TWAINUI_NORMAL),this.Scanner.SetDisplayWhileAcquiring(VARIANT_TRUE)}},{key:"URLOpStart",value:function URLOpStart(e,n,i){return this.EventHandler.URLOperationStarted instanceof Function&&this.EventHandler.URLOperationStarted(e),!0}},{key:"URLOpCompleted",value:function URLOpCompleted(e,n,i,r){return this.EventHandler.URLOperationCompleted instanceof Function&&this.EventHandler.URLOperationCompleted(e,i),!0}},{key:"URLOpError",value:function URLOpError(e,n,i,r,a){this.EventHandler.URLOperationError instanceof Function&&this.EventHandler.URLOperationError(e,i,r)}},{key:"URLOpProgress",value:function URLOpProgress(e,n,i,r,a,c,u){this.EventHandler.URLOperationProgress instanceof Function&&this.EventHandler.URLOperationProgress(e,i,r,a,c)}},{key:"AcquisitionStarted",value:function AcquisitionStarted(e){var n;if(0==(n=this.Viewer.ContentIndex)&&e.Placement!=IWizTWAINAcquirePlacement.IWizTWAINPlacement_APPEND)return!1;return e.SetStartInfo(n,this.Viewer.Contents.NumElements()),this.EventHandler.AcquisitionStarted instanceof Function&&this.EventHandler.AcquisitionStarted.call(this,e),!0}},{key:"AcquiredImage",value:function AcquiredImage(e,n){return this.EventHandler.AcquiredImage instanceof Function&&this.EventHandler.AcquiredImage.call(this,e,n),!0}},{key:"AcquisitionContinue",value:function(e){function AcquisitionContinue(n){return e.apply(this,arguments)}return AcquisitionContinue.toString=function(){return e.toString()},AcquisitionContinue}((function(e){return this.EventHandler.AcquisitionContinue instanceof Function&&this.EventHandler.AcquisitionContinue.call(this,AcquisitionContinue),!0}))},{key:"AcquisitionCompleted",value:function AcquisitionCompleted(e,n){return this.EventHandler.AcquisitionCompleted instanceof Function&&this.EventHandler.AcquisitionCompleted.call(this,e,n),!0}},{key:"GetLibrary",value:function GetLibrary(){return this.Library}},{key:"GetVersion",value:function GetVersion(){return viewerVersion||"4, 0, 0, 0"}}])}(),DocURL=function(){return _createClass((function DocURL(){return _classCallCheck(this,DocURL),this.url="",this.BaseURL="",this.FileName="",this.Attributes=0,this.PageAttributes=0,this.MimeType="",this.ImageType=!1,this.src_index=0,this.page_number=0,this.Available=!1,this.AppId="",this.reqdata="",this.Listener=null,this.ListenerData=null,this.Util=null,this.RawData=null,this}),[{key:"IsAvailable",value:function IsAvailable(){return this.Available}},{key:"Download",value:function Download(e){var n,i=this.Listener.GetScanner();if(!i)return!1;if(this.IsAvailable())return!0;var r=this.Listener;return""!=this.reqdata?n=i.Download(this.url,this.reqdata):(e&&(r.CurrentURLOps=new IWizURLOperation(this.url,0),r.CurrentURLOps.DisplayPage=!0),n=i.GetDownload(this.url,"")),n.then((function(e){if(!e||"success"!=e.status)throw new Error("find and fix this error")}))}},{key:"SetAppId",value:function SetAppId(e){return"string"==typeof e&&(this.AppId=e,!0)}},{key:"PageAttribute",value:function PageAttribute(e){return this.PageAttributes}},{key:"SetPageAttribute",value:function SetPageAttribute(e,n){this.PageAttributes=n}},{key:"Initialise",value:function Initialise(e,n,i){return this.Listener=n,this.ListenerData=i,this.Util=e,!0}},{key:"TempFileName",value:function TempFileName(){return this.Util.GetTemporaryFileName()}}])}(),clsTwainFilePages=_createClass((function clsTwainFilePages(e,n,i,r){_classCallCheck(this,clsTwainFilePages),this.ImageNumber=n||0,this.PageNumber=e||0,this.BlobURL=r||"",this.bits_per_sample=0,this.imagedata_size=0,this.length=0,this.samples_per_pixel=0,this.width=0,this.xresolution=0,this.yresolution=0,this.Availabe=void 0!==i&&!!i})),DocURLList=function(){return _createClass((function DocURLList(){return _classCallCheck(this,DocURLList),this.Util=null,this.Listener=null,this.ListenerData=null,this.CacheFileURLs=!1,this.AppId="",this.Available=!1,this.List=[],this}),[{key:"TemporaryFileName",value:function TemporaryFileName(){return this.Util&&this.Util.GetTemporaryFileName?this.Util.GetTemporaryFileName():""}},{key:"IsAvailable",value:function IsAvailable(){return this.Available}},{key:"Initialise",value:function Initialise(e,n,i){return this.Util=e,this.Listener=n||null,this.ListenerData=i||null,!0}},{key:"length",get:function get(){return this.List.length}},{key:"URLObjectIndex",value:function URLObjectIndex(e){var n;if("object"!==_typeof(e))return null;for(n=0;n<this.List.length;n++)if(this.List[n]===e)return n;return-1}},{key:"Count",value:function Count(){return this.List.length}},{key:"Element",value:function Element(e){if(e>=0&&e<=this.List.length)return this.List[e]}},{key:"GetNonAvailable",value:function GetNonAvailable(e){for(var n=0;n<this.List.length;n++){var i=this.List[n];if(0==i.IsAvailable()&&i.url==e)return i}}},{key:"Add",value:function Add(e,n,i,r){var a=null;return"string"!=typeof e?null:(this.AppId=i,this.Available=!0,(a=new DocURL).Initialise(this.Util,this.Listener,this.ListenerData),a.AppId=i,a.url=e,a.Attributes=ClassifyURL(e),a.src_number=n,a.Available=!0,r?this.List.splice(r-1,0,a):this.List.push(a),a)}},{key:"GetTempDocURL",value:function GetTempDocURL(e,n,i){var r=e;""!=n&&(r=n+e);var a=null;(a=new DocURL).Initialise(this.Util,this.Listener,this.ListenerData),a.AppId=i,a.url=r,a.src_number=0}},{key:"AddURL",value:function AddURL(e,n,i){var r=e;""!=n&&(r=n+e);var a=null;return(a=new DocURL).Initialise(this.Util,this.Listener,this.ListenerData),a.AppId=i,a.url=r,a.src_number=0,a.Attributes=ClassifyURL(e),this.List.push(a),a}},{key:"CopyAddURL",value:function CopyAddURL(e){var n=null;return(n=new DocURL).Initialise(this.Util,this.Listener,this.ListenerData),n.AppId=e.AppId,n.url=e.url,n.Attributes=ClassifyURL(e.url),n.src_number=e.src_number,n.Available=e.Available,this.List.push(n),n}},{key:"CheckFileAvailable",value:function CheckFileAvailable(e){var n;for(n=0;n<this.List.length;n++){if(this.List[n].src_number==e)return!0}return!1}},{key:"AddURLReference",value:function AddURLReference(e){this.CheckFileAvailable(e.src_number)||this.List.push(e)}},{key:"NumAvailable",value:function NumAvailable(){var e,n;for(n=0,e=0;e<this.List.length;e++){this.List[e].IsAvailable()&&n++}return n}},{key:"NumPages",get:function get(){return this.List.length}},{key:"NumPagesAvailable",value:function NumPagesAvailable(){return this.NumAvailable()}},{key:"Move",value:function Move(e,n,i){return!(e<=0||e>this.List.length)&&(!(n<=0)&&(n>this.List.length&&(n=this.List.length),!(n+i-1>this.List.length)&&(!(e+i-1>this.List.length)&&(e!=n&&(!(e<n&&e+i-1>=n)&&void IWIZmoveItem(this.List,e-1,i,n-1))))))}},{key:"Remove",value:function Remove(e){var n;return"object"===_typeof(e)&&(!((n=this.URLObjectIndex(e))<0)&&(this.List.splice(n,1),!0))}},{key:"Delete",value:function Delete(e){return e<=this.List.length&&this.List.splice(e,1),!0}},{key:"Clear",value:function Clear(){return this.List=[],!0}},{key:"Download",value:function Download(){var e;for(e=0;e<this.List.length;e++){var n=this.List[e];0==n.IsAvailable()&&n.Download()}}}])}(),DocLibrary=function(){return _createClass((function DocLibrary(e,n){return _classCallCheck(this,DocLibrary),this.URLList=[],this.ImageFunctions=null,this.EventListener=null,this.Util=null,this.ListenerData=null,this.ImageId=0,this.AutoDownload=!1,this.Parent=null,this.CurrentAPPID="",this.Initialise(e,n),this}),[{key:"Initialise",value:function Initialise(e,n){return this.URLList=e,this.ImageFunctions=n,!0}},{key:"NumElements",value:function NumElements(){return this.URLList.length}},{key:"GetURLList",value:function GetURLList(e){var n,i;for(n=0;n<this.URLList.length;n++)if((i=this.URLList[n]).AppId==e)return i;return(i=new DocURLList).Initialise(this.Util,this.Parent,this.ListenerData),i.AppId=e,this.URLList.push(i),i}},{key:"Index",value:function Index(e){var n;for(n=0;n<this.URLList.length;n++)if(this.URLList[n].AppId==e)return n+1;return 0}},{key:"SetCurrentAppID",value:function SetCurrentAppID(e){this.GetURLList(e);this.Parent.Viewer.Contents.LoadFromLib(e)}},{key:"ClearAndSetAppID",value:function ClearAndSetAppID(e){this.GetURLList(e).List=[],this.Parent.Viewer.Contents.LoadFromLib(e)}},{key:"GetURLWithIndex",value:function GetURLWithIndex(e){var n=e-1;return n<this.URLList.length&&n>=0?this.URLList[n]:null}},{key:"GetPageCount",value:function GetPageCount(e){var n=this.GetURLList(e);return n?n.List.length:0}},{key:"Add",value:function Add(e,n,i,r){var a,c,u;return r&&(a=r),(c=this.GetURLList(i))&&((u=c.GetNonAvailable(e))?(u.src_number=n,u.Available=!0):u=c.Add(e,n,i,a)),u}},{key:"Replace",value:function Replace(e,n,i){var r,a,c;e&&(r=e),(a=this.GetURLList(i))&&(c=a.Element(r-1))&&(c.src_number=n)}},{key:"AddURL",value:function AddURL(e,n,i,r){var a,c=this.GetURLList(i);return c&&(a=c.Add(e,n,i),r&&(a.reqdata=r),this.AutoDownload&&a.Download()),a}},{key:"AcquireImageObject",value:function AcquireImageObject(e,n){var i=null,r=this.Parent.Viewer,a=r.CurrentContentIndex,c=r.Contents.AppId,u=e.Internal1,h=e.Usage;switch(n){case InsertType.INSERT_BEFORE:case InsertType.INSERT_CURRENT:i=a;break;case InsertType.INSERT_AFTER:i=a+1;break;case InsertType.INSERT_START:i=1;case InsertType.INSERT_END:}var p=this.Add(h.url,u,c,i);if(!p)throw new Error("find and fix this error");p.FileName=h.filename;var d={};d.Placement=n,d.imgIndex=u;var f=this.Parent.prepareImageObject(u);this.Parent.AcquiredImage(d,f)}},{key:"Clear",value:function Clear(){return this.URLList=[],this.EventListener&&this.EventListener.LibraryElementsCleared(),!0}},{key:"GetDocURLPageWithIndex",value:function GetDocURLPageWithIndex(e,n){var i=this.GetURLWithIndex(e);if(!i)return null;var r=n;return r<=0||r>i.List.length?null:i.List[--r]}},{key:"PageInfo",value:function PageInfo(e,n,i){var r;return n<0||e<=0||e>this.List.length?0:(r=GetDocURLPageWithIndex(e,n))&&r.Available?(r.NumPages,0):0}},{key:"DownloadFile",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(e,n,i){var r,a;return _regeneratorRuntime().wrap((function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return this.CurrentAPPID=i,r=this.Parent.Scanner,c.next=4,r.Download(e,n);case 4:return a=c.sent,c.abrupt("return",a);case 6:case"end":return c.stop()}}),_callee2,this)}))),function DownloadFile(e,i,r){return n.apply(this,arguments)})},{key:"Print",value:function Print(e,n,i){var r;if(e<=0||e>this.List.length)return null;if(i&&i<n)return null;if(!(r=this.List[--e]).IsAvailable)return null;var a=r.NumPages;if(n>a)return null;n<=0&&(n=1),i<=0&&(i=a),i>a&&(i=a);var c=r.FileName;return!!this.ImageFunctions.PrintPages(c,n,i,IV_PRINTFLAGS_FULLJOB)}},{key:"Remove",value:function Remove(e){if(e>0&&e<=this.List.length){var n=this.List[e-1];return this.EventListener&&this.EventListener.LibraryElementBeingRemoved(e,n),!0}return!1}},{key:"Thumbnail",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(e,n,i,r,a){var c,u;return _regeneratorRuntime().wrap((function _callee3$(h){for(;;)switch(h.prev=h.next){case 0:if(c=this.LoadImage(e,n)){h.next=3;break}return h.abrupt("return",null);case 3:return h.next=5,c.Thumbnail(i,r,a);case 5:return u=h.sent,h.abrupt("return",u);case 7:case"end":return h.stop()}}),_callee3,this)}))),function Thumbnail(n,i,r,a,c){return e.apply(this,arguments)})},{key:"AddOutput",value:function AddOutput(e,n){return 0!=e.NumPages&&(e.AddToLib(n),!0)}},{key:"LoadImage",value:function LoadImage(e,n){var i,r=this.Parent.GetScanner(),a=this.GetURLWithIndex(e),c=n;if(c<=0||c>a.List.length)return!1;if(!(i=a.List[--c]).IsAvailable())return null;var u=new IWizImage(r);return u.Internal1=i.src_number,u?(u.Initialise(this.ImageFunctions,i,1,IWizImageOpenPurpose.IWIZIMAGE_OPEN_OTHER,null),u):null}},{key:"NumAvailable",value:function NumAvailable(e){var n,i=0,r=this.GetURLList(e);for(n=0;n<r.List.length;n++)r.List[n].IsAvailable()&&i++;return i}},{key:"FirstNotAvialable",value:function FirstNotAvialable(e){var n=this.GetURLList(e);for(i=0;i<n.List.length;i++)if(!n.List[i].IsAvailable())return i+1;return-1}},{key:"SetEventListener",value:function SetEventListener(e){this.EventListener=e}}]);var e,n}(),IVLibrary=function(){return _createClass((function IVLibrary(e){return _classCallCheck(this,IVLibrary),this.AppId=e||"",this}),[{key:"EndInstance",value:function EndInstance(){}},{key:"CreateWindow",value:function CreateWindow(){}}])}(),ClsTwainStatus=_createClass((function ClsTwainStatus(){return _classCallCheck(this,ClsTwainStatus),this.active=!1,this.status="",this.isRequestInProgress=!1,this})),IWizUtil=function(){return _createClass((function IWizUtil(){return _classCallCheck(this,IWizUtil),this.Id=0,this.NextFileID=0,this.TempPath="TempFile-",this}),[{key:"GetTemporaryFileName",value:function GetTemporaryFileName(){return 0!=this.TempPath.length?(this.NextFileID++,this.TempPath+this.NextFileID):0}},{key:"GetFileModifiedTime",value:function GetFileModifiedTime(e){}},{key:"GetFileByteSize",value:function GetFileByteSize(e){return e instanceof File?e.byteLength:1e5}},{key:"Exists",value:function Exists(e){return!0}}])}();function defaultCallback(e){}function prepare_appevents(e){e.EventHandler={},e.EventHandler.ContentElementAdded=function(){return defaultCallback("ContentElementAdded")},e.EventHandler.ContentElementMoved=function(){return defaultCallback("ContentElementMoved")},e.EventHandler.ContentElementBeingRemoved=function(){return defaultCallback("ContentElementBeingRemoved")},e.EventHandler.ContentsCleared=function(){return defaultCallback("ContentsCleared")},e.EventHandler.LibraryElementAdded=function(){return defaultCallback("LibraryElementAdded")},e.EventHandler.LibraryElementBeingRemoved=function(){return defaultCallback("LibraryElementBeingRemoved")},e.EventHandler.LibraryCleared=function(){return defaultCallback("LibraryCleared")},e.EventHandler.TWAINStateChanged=function(){return defaultCallback("TWAINStateChanged")},e.EventHandler.TWAINWarning=function(){return defaultCallback("TWAINWarning")},e.EventHandler.AnnotationDrawn=function(){return defaultCallback("AnnotationDrawn")},e.EventHandler.URLOperationStarted=function(){return defaultCallback("URLOperationStarted")},e.EventHandler.URLOperationCompleted=function(){return defaultCallback("URLOperationCompleted")},e.EventHandler.URLOperationError=function(){return defaultCallback("URLOperationError")},e.EventHandler.URLOperationProgress=function(){return defaultCallback("URLOperationProgress")},e.EventHandler.URLOperationReady=function(){return defaultCallback("URLOperationReady")},e.EventHandler.AcquisitionStarted=function(){return defaultCallback("AcquisitionStarted")},e.EventHandler.AcquiredImage=function(){return defaultCallback("AcquiredImage")},e.EventHandler.AcquisitionContinue=function(){return defaultCallback("AcquisitionContinue")},e.EventHandler.AcquisitionCompleted=function(){return defaultCallback("AcquisitionCompleted")},e.EventHandler.AddOutputImage=function(){return defaultCallback("AddOutputImage")}}var IWizCanvas=function(){return _createClass((function IWizCanvas(e){return _classCallCheck(this,IWizCanvas),this.CanvasElement={},this.FileName="",this.FormElement="",this.DivWidth=0,this.DivHeight=0,this.Image={Data:null,Height:0,Width:0},this.Context2D=null,this.CurPosition={x:0,y:0},this.ImgPosition={x:0,y:0},this.ImageState={},this.Render=!1,this.Parent=null,this.currentMouseTool=null,this.image=null,this.originalImg=null,this.canvas=null,this.ctx=null,this.rect={},this.imgScale=0,this.angle=0,this.magnifier=null,this.drag=!1,this.onAnnotationDraw=!1,this.CurrentAnnotationObj={},this.AnnotationData=[],this.currentRotation=0,this.getFitSize=function(){var e=0,n=0,i=this.imageW,r=this.imageH,a=this.cavW,c=this.cavH;i<a&&r<c?(e=.5*a-.5*i,n=.5*c-.5*r):r/i>c/a?(i=i*c/r,r=c,e=.5*a-.5*i):(r=r*a/i,i=a,n=.5*c-.5*r);var u={};return u.x=e,u.y=n,u.w=i,u.h=r,u},this.isNum=function(e){return/^(-?\d+)(\.\d+)?$/.test(e)},this.initData=function(){var e=this.image,n=e.width,i=e.height,r=this.canvas,a=r.width,c=r.height;this.imgScale=1,this.angle=0,this.isVRevert=1,this.isHRevert=1,this.isMove=!1,this.imageW=n,this.imageH=i,this.cavW=a,this.cavH=c;var u=this.getFitSize();this.imgX=u.x,this.imgY=u.y,this.image=this.originalImg},this.initListener=function(){this.canvas.addEventListener("mousedown",this,!1),this.canvas.addEventListener("mouseup",this,!1),this.canvas.addEventListener("mouseout",this,!1)},this.handleZoomMouseTool=function(e){this.maginfier(!1),this.currentMouseTool=null,this.canvas.style.cursor="auto",this.canvas.removeEventListener("mousewheel",this,!1),this.canvas.removeEventListener("mousedown",this,!1),this.canvas.removeEventListener("mousemove",this,!1),e&&(this.currentMouseTool="zoom",this.canvas.style.cursor="zoom-in",this.canvas.addEventListener("mousewheel",this,!1))},this.handlePanMouseTool=function(e){this.maginfier(!1),this.currentMouseTool=null,this.canvas.style.cursor="auto",this.canvas.removeEventListener("mousedown",this,!1),this.canvas.removeEventListener("mousewheel",this,!1),this.canvas.removeEventListener("mousemove",this,!1),e&&(this.currentMouseTool="pan",this.canvas.style.cursor="grab",this.canvas.addEventListener("mousedown",this,!1))},this.handleMagnificationTool=function(e){this.currentMouseTool=null,this.canvas.style.cursor="auto",this.canvas.removeEventListener("mousedown",this,!1),this.canvas.removeEventListener("mousewheel",this,!1),this.canvas.removeEventListener("mousemove",this,!1),e?(this.currentMouseTool="magnify",this.isMove=!0,this.magnifier=this.maginfier(!0)):this.maginfier(!1)},this.handleEvent=function(e){switch(e.type){case"mousemove":this.mousemove(e);break;case"mousewheel":this.mousewheel(e);break;case"mouseup":this.mouseup(e);break;case"mousedown":this.mousedown(e);break;case"mouseout":this.mouseout(e)}},this.mouseout=function(){this.isMove=!1,"pan"==this.currentMouseTool?this.canvas.style.cursor="grab":this.canvas.style.cursor="default"},this.mousedown=function(e){this.mouseDownPos=this.windowToCanvas(e.clientX,e.clientY),this.isMove=!0,this.drag=!0,"pan"==this.currentMouseTool?this.canvas.style.cursor="grabbing":this.canvas.style.cursor="default",this.canvas.addEventListener("mousemove",this,!1)},this.mouseup=function(){this.isMove=!1,"pan"==this.currentMouseTool?this.canvas.style.cursor="grab":this.canvas.style.cursor="default ",this.canvas.removeEventListener("mousemove",this,!1)},this.mousemove=function(e){var n=this.mouseDownPos;if("pan"==this.currentMouseTool){this.canvas.style.cursor="grabbing";var i=this.windowToCanvas(e.clientX,e.clientY),r=i.x-n.x,a=i.y-n.y;this.mouseDownPos=i,this.imgX+=r,this.imgY+=a,this.draw()}"magnify"==this.currentMouseTool&&this.maginfier(!0)},this.mousewheel=function(e){this.windowToCanvas(e.clientX,e.clientY);(e.wheelDelta?e.wheelDelta:-40*e.deltaY)>0?("zoom"==this.currentMouseTool&&(this.canvas.style.cursor="zoom-in"),this.Zoom(1)):("zoom"==this.currentMouseTool&&(this.canvas.style.cursor="zoom-out"),this.Zoom(-1))},this.resetMouseTool=function(){this.handlePanMouseTool(!1),this.handleZoomMouseTool(!1),this.handleMagnificationTool(!1)},this.scale=function(e){if(this.isNum(e)){this.imgScale*=e;var n=this.cavW/2-this.originalImg.width/2,i=this.cavH/2-this.originalImg.height/2;this.imgScale>1?(this.imgX=n*this.imgScale,this.imgY=i*this.imgScale):(this.imgX=n/this.imgScale,this.imgY=i/this.imgScale),this.draw()}},this.setOriginalSize=function(){var e=this.getFitSize();this.imgScale=this.originalImg.width/e.w;var n=this.cavW/2-this.originalImg.width/2,i=this.cavH/2-this.originalImg.height/2;this.imgScale>1?(this.imgX=n*this.imgScale,this.imgY=i*this.imgScale):(this.imgX=n/this.imgScale,this.imgY=i/this.imgScale),this.draw()},this.dstroy=function(){this.canvas.removeEventListener("mousedown",this,!1),this.canvas.removeEventListener("mouseout",this,!1),this.canvas.removeEventListener("mousewheel",this,!1),this.canvas.removeEventListener("mouseup",this,!1),this.canvas.removeEventListener("mousemove",this,!1),this.canvas=null,this.image=null},this.windowToCanvas=function(e,n){var i=this.canvas.getBoundingClientRect();return{x:e-i.left-(i.width-this.cavW)/2,y:n-i.top-(i.height-this.cavH)/2}},this.clearCanvas=function(){this.ctx.clearRect(0,0,this.cavW,this.cavH)},this.renderImage=function(e,n,i,r){this.clearCanvas(),this.ctx.save(),this.ctx.fillStyle="white",this.ctx.fill(),this.ctx.fillRect(0,0,this.Image.Width,this.Image.Height),this.ctx.translate(e+i/2,n+r/2),this.ctx.rotate(this.angle),this.ctx.scale(this.isHRevert,this.isVRevert),this.ctx.drawImage(this.image,0,0,this.imageW,this.imageH,-i/2,-r/2,i,r),this.ctx.restore()},this.rotate=function(e){this.angle+=e,this.draw()},this.vRevert=function(){this.isVRevert*=-1,this.draw()},this.hRevert=function(){this.isHRevert*=-1,this.draw()},this.initDraw=function(){this.initData(),this.initListener(),this.draw()},this.draw=function(){this.canvas.style.display="block";var e=this.getFitSize();this.renderImage(this.imgX,this.imgY,e.w*this.imgScale,e.h*this.imgScale)},this.initAnnotationDraw=function(e){e&&1==e&&(this.canvas.removeEventListener("mousemove",this,!1),this.canvas.removeEventListener("mousewheel",this,!1),this.canvas.removeEventListener("mousedown",this,!1),this.canvas.removeEventListener("mouseup",this,!1),this.canvas.removeEventListener("mouseout",this,!1),this.CurrentAnnotationObj=new Annotation(this),this.onAnnotationDraw=!0)},this.Initialise(e),this}),[{key:"Initialise",value:function Initialise(e){this.Parent=e;var n=this.Parent.HWnd,i=document.createElement("div"),r=document.createElement("canvas");r&&r.setAttribute("style","width:100%; height:auto;visibility: hidden;");var a=document.getElementById(n);clearChildren(a),i.appendChild(r),i.classList.add("CanvasHolder"),a.appendChild(i),this.Context2D=r.getContext("2d"),this.CanvasElement=r}},{key:"HaveImg",value:function HaveImg(e){if(!e)return!1;this.Image.Data=e,this.Image.Height=e.height,this.Image.Width=e.width,this.image=e,this.originalImg=e,this.canvas=this.Context2D.canvas,this.canvas.width=e.width,this.canvas.height=e.height,this.ctx=this.Context2D,this.initDraw(),this.CanvasElement.style.visibility="visible",this.Render=!0}},{key:"HaveBitmap",value:function HaveBitmap(e){if(!e)return!1;(this.Image.Data=e,this.Image.Height=e.height,this.Image.Width=e.width,this.Render)?this.Parent.GetParents().ResetDisplayOptionOnNavigate||this.ResetPrevControls():this.ResetPrevControls();this.Render=!0,this.InitRenderImage()}},{key:"FailedBitmap",value:function FailedBitmap(e){}},{key:"InitRenderImage",value:function InitRenderImage(){if(this.Image){var e=this.Context2D.canvas;e.width=this.Context2D.canvas.parentNode.clientWidth,e.height=Math.floor(e.width*(this.Image.Height/this.Image.Width)),this.ImageState.Attributes.Width=e.width,this.ImageState.Attributes.Height=e.height;var n=Math.floor((this.Context2D.canvas.width-this.ImageState.Attributes.Width)/2),i=Math.floor((this.Context2D.canvas.height-this.ImageState.Attributes.Height)/2);this.Context2D.save(),this.Context2D.shadowBlur=2,this.Context2D.shadowOffsetX=1,this.Context2D.shadowOffsetY=1,this.Context2D.strokeStyle="black",this.Context2D.shadowColor="black",this.Context2D.translate(n,i),this.Context2D.drawImage(this.Image.Data,0,0,this.Image.Width,this.Image.Height,0,0,this.Context2D.canvas.width,this.Context2D.canvas.height),this.Context2D.restore()}}},{key:"RenderImage",value:function RenderImage(){if(this.Image){var e=Math.floor((this.Context2D.canvas.width-this.ImageState.Attributes.Width)/2),n=Math.floor((this.Context2D.canvas.height-this.ImageState.Attributes.Height)/2);this.Context2D.save(),this.Context2D.shadowBlur=2,this.Context2D.shadowOffsetX=1,this.Context2D.shadowOffsetY=1,this.Context2D.strokeStyle="black",this.Context2D.shadowColor="black",this.Context2D.translate(e,n),this.Context2D.drawImage(this.Image.Data,0,0,this.Image.Width,this.Image.Height,0,0,this.ImageState.Attributes.Width,this.ImageState.Attributes.Height),this.Context2D.restore()}}},{key:"ClearCanvas",value:function ClearCanvas(){var e=this.Context2D.canvas;this.Context2D.clearRect(0,0,e.width,e.height)}},{key:"ResetPrevControls",value:function ResetPrevControls(){var e=this.Ratio();this.ImageState={Controls:{Image:!0,Fit:"page"},Attributes:{Height:Math.floor(this.Image.Height*e),Width:Math.floor(this.Image.Width*e)},Zoom:{Value:1,Step:.1,Min:.05,Max:2},Rotate:{Value:0,Step:90}},this.ClearCanvas(),this.Context2D.canvas.width=this.Context2D.canvas.parentNode.clientWidth,this.Context2D.canvas.height=this.Context2D.canvas.parentNode.clientHeight,this.ImageState.Zoom.Value=1,this.ImageState.Rotate.Value=0,this.CurPosition={x:0,y:0},this.PicPosition={x:0,y:0}}},{key:"Ratio",value:function Ratio(){var e=this.Context2D.canvas.width/this.Image.Width,n=this.Context2D.canvas.height/this.Image.Height;return Math.min(e,n)}},{key:"Zoom",value:function Zoom(e){if(!this.Image||!e)return!1;var n=this.canvas.parentElement,i=parseInt(getComputedStyle(n).width,10),r=parseInt(getComputedStyle(this.canvas).width,10)/i*100,a=0;e>0&&(a=r+10),e<0&&(a=r-10),a>0&&a<400&&(this.canvas.style.width=a+"%"),!isNaN(this.Parent.SetZoomFactor)&&this.Parent.SetZoomFactor>-1&&(this.canvas.style.width=100+this.Parent.SetZoomFactor+"%"),this.Parent.SetZoomFactor=-1,this.canvas.style.height="auto"}},{key:"FitToWidth",value:function FitToWidth(){this.canvas.style.height="auto",this.canvas.style.width="100%"}},{key:"FitToHeight",value:function FitToHeight(){var e=this.canvas.parentElement;e=e.parentElement?e.parentElement:e;var n=getComputedStyle(e).height;this.canvas.style.width="auto",this.canvas.style.height=n.toFixed()}},{key:"FitToPage",value:function FitToPage(){var e=this.canvas.parentElement;e=e.parentElement?e.parentElement:e;var n=getComputedStyle(e).height;this.canvas.style.width="auto",this.canvas.style.height=n}},{key:"Rotate",value:function Rotate(e){rotation=this.currentRotation+e,style.setProperty("-moz-transform","rotate("+rotation+"deg)"),style.setProperty("-o-transform","rotate("+rotation+"deg)"),style.setProperty("-webkit-transform","rotate("+rotation+"deg)"),style.setProperty("transform","rotate("+rotation+"deg)"),this.currentRotation=rotation}},{key:"HRevert",value:function HRevert(){var e=this.canvas.style;this.hRevertEnabled?(e.removeProperty("-moz-transform","scaleX(-1)"),e.removeProperty("-o-transform","scaleX(-1)"),e.removeProperty("-webkit-transform","scaleX(-1)"),e.removeProperty("transform","scaleX(-1)"),e.removeProperty("filter","FlipH"),e.removeProperty("-ms-filter","FlipH"),this.hRevertEnabled=!1):(e.setProperty("-moz-transform","scaleX(-1)"),e.setProperty("-o-transform","scaleX(-1)"),e.setProperty("-webkit-transform","scaleX(-1)"),e.setProperty("transform","scaleX(-1)"),e.setProperty("filter","FlipH"),e.setProperty("-ms-filter","FlipH"),this.hRevertEnabled=!0)}},{key:"VRevert",value:function VRevert(){var e=this.canvas.style;this.vRevertEnabled?(e.removeProperty("-moz-transform","scaleY(-1)"),e.removeProperty("-o-transform","scaleY(-1)"),e.removeProperty("-webkit-transform","scaleY(-1)"),e.removeProperty("transform","scaleY(-1)"),e.removeProperty("filter","FlipV"),e.removeProperty("-ms-filter","FlipV"),this.vRevertEnabled=!1):(e.setProperty("-moz-transform","scaleY(-1)"),e.setProperty("-o-transform","scaleY(-1)"),e.setProperty("-webkit-transform","scaleY(-1)"),e.setProperty("transform","scaleY(-1)"),e.setProperty("filter","FlipV"),e.setProperty("-ms-filter","FlipV"),this.vRevertEnabled=!0)}},{key:"HRevert_VRevert",value:function HRevert_VRevert(){var e=this.canvas.style;this.vRevertEnabled?(e.removeProperty("-moz-transform","scale(-1, -1)"),e.removeProperty("-o-transform","scale(-1, -1)"),e.removeProperty("-webkit-transform","scale(-1, -1)"),e.removeProperty("transform","scale(-1, -1)"),this.hvRevertEnabled=!1):(e.setProperty("-moz-transform","scale(-1, -1)"),e.setProperty("-o-transform","scale(-1, -1)"),e.setProperty("-webkit-transform","scale(-1, -1)"),e.setProperty("transform","scale(-1, -1)"),this.hvRevertEnabled=!0)}},{key:"rotateLeft",value:function rotateLeft(){var e,n=this.canvas.style;e=this.currentRotation-90,n.setProperty("-moz-transform","rotate("+e+"deg)"),n.setProperty("-o-transform","rotate("+e+"deg)"),n.setProperty("-webkit-transform","rotate("+e+"deg)"),n.setProperty("transform","rotate("+e+"deg)"),this.currentRotation=e}},{key:"rotateRight",value:function rotateRight(){var e,n=this.canvas.style;e=this.currentRotation+90,n.setProperty("-moz-transform","rotate("+e+"deg)"),n.setProperty("-o-transform","rotate("+e+"deg)"),n.setProperty("-webkit-transform","rotate("+e+"deg)"),n.setProperty("transform","rotate("+e+"deg)"),this.currentRotation=e}},{key:"reset",value:function reset(){this.canvas.style.width="100%",this.canvas.style.height="auto",this.resetMouseTool()}},{key:"maginfier",value:function maginfier(e){var n,i=this,r=document.getElementById(this.Parent.Parent.DOM_ID),a=r.querySelector(".CanvasHolder"),c={x:0,y:0},u=2,h=!1,p="imgPlaceHolder_"+this.Parent.Parent.DOM_ID,d=document.getElementById(p);if(d){var f=a.querySelector(".img-magnifier-glass");f&&f.remove();var m=document.createElement("div");m.className="img-magnifier-glass",this.canvas.parentElement.insertBefore(m,this.canvas);var g=function onMouseMove(e){var n=e.clientX,i=e.clientY;c={x:n,y:i};var r=a.getBoundingClientRect(),u=r.left,h=r.top;v(m,n-u,i-h)},v=function updateMagnifierPosition(e,n,i){var r=e.offsetWidth,a=e.offsetHeight;e.style.left="".concat(n-r/2+20,"px"),e.style.top="".concat(i-a/2,"px"),e.style.backgroundPosition="".concat(-n*u+r/2,"px ").concat(-i*u+a/2,"px")},w=new ResizeObserver((function(){if(b(),c.x&&c.y){var e=a.getBoundingClientRect(),n=e.left,i=e.top,r=c.x-n,u=c.y-i;v(m,r,u)}})),y=function onPageScroll(){c.x&&c.y&&g({clientX:c.x,clientY:c.y})},b=function setMagnifierStyle(){Object.assign(m.style,{backgroundImage:"url('".concat(d.src,"')"),backgroundRepeat:"no-repeat","z-index":1,backgroundSize:"".concat(i.canvas.offsetWidth*u,"px ").concat(i.canvas.offsetHeight*u,"px")})},_=function onCtrlWheel(e){h&&function onWheel(e){e.preventDefault(),clearTimeout(n),u+=-.01*e.deltaY,u=Math.min(Math.max(u,1),10),m.Zoom=u,b(),g(e),e.deltaY<0?m.style.cursor="zoom-in":m.style.cursor="zoom-out",n=setTimeout((function(){m.style.cursor="crosshair"}),300)}(e)};if(!e){a.removeEventListener("mousemove",g),a.removeEventListener("wheel",_),r.removeEventListener("scroll",y),document.removeEventListener("keyup",(function(e){return"Control"===e.key&&(h=!1)})),document.removeEventListener("keydown",(function(e){return"Control"===e.key&&(h=!0)}));var x=a.querySelector(".img-magnifier-glass");return x&&(x.style.display="none"),void w.disconnect()}return b(),m.Zoom=u,a.addEventListener("mousemove",g),a.addEventListener("mouseout",(function(){return m.style.display="none"})),a.addEventListener("mouseover",(function(){return m.style.display="block"})),a.addEventListener("wheel",_),r.addEventListener("scroll",y),document.addEventListener("keyup",(function(e){return"Control"===e.key&&(h=!1)})),document.addEventListener("keydown",(function(e){return"Control"===e.key&&(h=!0)})),w.observe(this.canvas),m.style.cursor="crosshair",m}}}])}(),Annotation=function(){return _createClass((function Annotation(e){_classCallCheck(this,Annotation),this.canvas=null,this.ctx=null,this.source_image=null,this.Items=[],this.rects_restore=[],this.current_item=null,this.Parent=null,this.Annotation={New:!1,Id:null,Type:null,Config:""},this.startX=null,this.startY=null,this.fieldItemsDetails=[],this.MOUSE_BUTTON={1:"LEFT",LEFT:1},this.canvas=e.canvas,this.ctx=e.Context2D,this.addEvent(),this.Annotation.New=!0,this.source_image=e.image,parent&&(this.Parent=e.Parent),e&&(this.canvasObj=e)}),[{key:"getCurrentImageInfo",value:function getCurrentImageInfo(){var e={};return e.zoom=this.canvasObj.imgScale,e.rotation=this.canvasObj.angle,e.currentPage=1,e}},{key:"addEvent",value:function addEvent(){var e,n,i,r,a=this;null===(e=this.canvas)||void 0===e||e.addEventListener("mousedown",(function(e){a.handleMouseIn(e)})),null===(n=this.canvas)||void 0===n||n.addEventListener("mousemove",(function(e){a.handleMouseMove(e)})),null===(i=this.canvas)||void 0===i||i.addEventListener("mouseup",(function(e){a.handleMouseUp(e)})),null===(r=this.canvas)||void 0===r||r.addEventListener("mouseout",(function(e){a.handleMouseOut(e)}))}},{key:"handleMouseMove",value:function handleMouseMove(e){var n=this.canvas;e.preventDefault(),e.stopPropagation();this.get_mouse_cord(e.target,e);var i=e.offsetX*n.width/n.clientWidth|0,r=e.offsetY*n.width/n.clientWidth|0;this.changeCursor(),this.Annotation.New&&e.buttons==this.MOUSE_BUTTON.LEFT&&this.drawCurrentItemBorders(e,i,r)}},{key:"handleMouseIn",value:function handleMouseIn(e){this.canvasObj.draw();var n=this.canvas;e.preventDefault(),e.stopPropagation(),this.startX=e.offsetX*n.width/n.clientWidth|0,this.startY=e.offsetY*n.width/n.clientWidth|0,this.changeCursor()}},{key:"handleMouseOut",value:function handleMouseOut(e){e.preventDefault(),e.stopPropagation(),this.changeCursor()}},{key:"handleMouseUp",value:function handleMouseUp(e){var n=this.canvas,i=e.offsetX*n.width/n.clientWidth|0,r=e.offsetY*n.height/n.clientHeight|0,a=i-this.startX,c=r-this.startY,u={left:Math.min(this.startX,i),right:Math.max(this.startX,i),top:Math.min(this.startY,r),bottom:Math.max(this.startY,r)};this.changeCursor();if(this.Annotation.New)if(a<=2&&c<=2);else{this.Annotation.Id+=1;var h={x:this.startX/1,y:this.startY/1,w:a/1,h:c/1,Id:this.Annotation.Id,currentPage:1,pageRotation:this.canvasObj.angle,zoom:this.canvasObj.imgScale,selected:!1};this.Items.push(h),this.rects_restore.push(h),this.Annotation.New=!1;var p=this.Parent.GetParents();if(!p)return;p.HaveNewAnnotation(1,u.left,u.top,u.right,u.bottom),this.ctx.clearRect(0,0,n.width,n.height),this.canvasObj.draw(),this.removeEvents()}}},{key:"removeEvents",value:function removeEvents(){this.canvas.removeEventListener("mousemove",this,!1),this.canvas.removeEventListener("mousewheel",this,!1),this.canvas.removeEventListener("mousedown",this,!1),this.canvas.removeEventListener("mouseup",this,!1),this.canvas.removeEventListener("mouseout",this,!1)}},{key:"setCurrentItem",value:function setCurrentItem(e,n,i){this.canvasObj.draw();for(var r=this.getCurrentImageInfo(),a=r.zoom,c=r.currentPage,u=(r.rotation,this.Items),h=0;h<u.length;h++){var p=u[h];if(p.currentPage==c){if(this.CordsInsideRect(e,n,p.x,p.y,p.w,p.h,a,p)){this.current_item=p,this.current_item.selected=!0;break}this.current_item&&(this.current_item=null)}}if(!i.ctrlKey){var d=this;u.forEach((function(e){e!=d.current_item&&(e.selected=!1)}))}return!!this.current_item}},{key:"get_mouse_cord",value:function get_mouse_cord(e,n){var i=n.target.getBoundingClientRect();return{x:n.clientX-i.left,y:n.clientY-i.top}}},{key:"drawCurrentItemBorders",value:function drawCurrentItemBorders(e,n,i){var r=this.canvas,a=e.offsetX*r.width/r.clientWidth|0,c=e.offsetY*r.width/r.clientWidth|0,u=a-this.startX,h=c-this.startY;u<=2&&h<=2||(this.canvasObj.Context2D.clearRect(0,0,r.width,r.height),this.canvasObj.draw(),this.ctx.beginPath(),this.ctx.strokeStyle="#1B9AFF",this.ctx.lineWidth=5,this.ctx.strokeRect(this.startX,this.startY,u,h)),this.ctx.restore()}},{key:"changeCursor",value:function changeCursor(e,n){var i="auto";this.Annotation.New&&(i="crosshair"),this.canvas.style.cursor=i}},{key:"drawAll",value:function drawAll(){var e,n,i,r,a=this.canvas.getContext("2d"),c=this.getCurrentImageInfo(),u=c.zoom,h=c.currentPage,p=c.rotation;a.save();for(var d=0;d<this.Items.length;d++){var f=this.Items[d];f.currentPage==h&&(a.strokeStyle="#1B9AFF",a.globalAlpha=1,a.lineWidth=2,e=f.x*u,n=f.y*u,i=f.w*u,r=f.h*u,this.RotateAnnotation(e,n,i,r,p,f))}a.restore()}},{key:"RotateAnnotation",value:function RotateAnnotation(e,n,i,r,a,c){var u=this.ctx,h=this.canvas.width,p=this.canvas.height;if(u.save(),0==c.pageRotation){switch(a){case 0:return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(e,n,i,r),u.fillRect(e,n,i,r)):u.strokeRect(e,n,i,r),!0;case 90:var d=h-n-r,f=e,m=r,g=i;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 180:d=h-e-i,f=p-n-r,m=i,g=r;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 270:d=n,f=p-e-i,m=r,g=i;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0}return!1}if(90==c.pageRotation){switch(a){case 0:d=n,f=p-e-i,m=r,g=i;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 90:return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(e,n,i,r),u.fillRect(e,n,i,r)):u.strokeRect(e,n,i,r),!0;case 180:d=h-n-r,f=e,m=r,g=i;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 270:d=h-e-i,f=p-n-r,m=i,g=r;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0}return!1}if(180==c.pageRotation){switch(a){case 0:d=h-e-i,f=p-n-r,m=i,g=r;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 90:d=n,f=p-e-i,m=r,g=i;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 180:return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(e,n,i,r),u.fillRect(e,n,i,r)):u.strokeRect(e,n,i,r),!0;case 270:d=h-n-r,f=e,m=r,g=i;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0}return!1}if(270==c.pageRotation){switch(a){case 0:d=h-n-r,f=e,m=r,g=i;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 90:d=h-e-i,f=p-n-r,m=i,g=r;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 180:d=n,f=p-e-i,m=r,g=i;return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(d,f,m,g),u.fillRect(d,f,m,g)):u.strokeRect(d,f,m,g),!0;case 270:return c.selected?(u.fillStyle="red",u.globalAlpha=.5,u.strokeRect(e,n,i,r),u.fillRect(e,n,i,r)):u.strokeRect(e,n,i,r),!0}return!1}u.restore()}},{key:"CordsInsideRect",value:function CordsInsideRect(e,n,i,r,a,c,u,h){var p=this.canvas.width,d=this.canvas.height,f=this.getCurrentImageInfo(),m=(f.zoom,f.currentPage,f.rotation);if(0==h.pageRotation){if(90==m){var g=(y=p-r*u-c*u)+c*u,v=(b=i*u)+a*u,w=n>=b&&n<=v;return e>=y&&e<=g&&w}if(180==m){g=(y=p-i*u-a*u)+a*u,v=(b=d-r*u-c*u)+c*u,w=n>=b&&n<=v;return e>=y&&e<=g&&w}if(270==m){var y,b;g=(y=r*u)+c*u,v=(b=d-i*u-a*u)+a*u,w=n>=b&&n<=v;return e>=y&&e<=g&&w}var _=i*u,x=r*u;g=_+a*u,v=x+c*u,w=n>=x&&n<=v;return e>=_&&e<=g&&w}}}])}(),IWizImage=function(){function IWizImage(e){return _classCallCheck(this,IWizImage),this.Width=0,this.Height=0,this.BitsPerPixel=0,this.XResolution=0,this.YResolution=0,this.Modified=!1,this.ClearModified=function(){return this.Modified=!1,!0},this.Internal1=0,this.BlackPerCent=0,this.Imaging=null,this.Handle=null,this.Listener=null,this.Purpose=null,this.Usage=null,this.PageNumber=0,this.HaveAttributes=!1,this.TypeCode=0,this.API=e||null,this}return _createClass(IWizImage,[{key:"Initialise",value:function Initialise(e,n,i,r,a){return!(!e||this.Handle)&&(this.Listener=this,this.Purpose=r,this.PageNumber=i,this.Imaging=e,this.Usage=n,this.Internal1=n.src_number,!a||(this.Handle=a,!!this.Handle&&(this.Width=a.width,this.Height=a.length,this.BitsPerPixel=a.bits_per_sample,this.XResolution=a.xresolution,this.YResolution=a.yresolution,!0)))}},{key:"SetImageInfo",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(e){var n,i;return _regeneratorRuntime().wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:if(this.API){r.next=2;break}return r.abrupt("return",!1);case 2:return n=e||this.Internal1,r.next=5,this.API.ImageInfo(n);case 5:if(!(i=r.sent)){r.next=9;break}return"success"==i.status&&(this.Width=i.width,this.Height=i.length,this.BitsPerPixel=i.bits_per_sample,this.XResolution=i.xresolution,this.YResolution=i.yresolution,this.BlackPerCent=i.blackpercent,this.Size=i.imagedata_size),r.abrupt("return",!e||i);case 9:case"end":return r.stop()}}),_callee4,this)}))),function SetImageInfo(e){return a.apply(this,arguments)})},{key:"SetFileInfo",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(e){var n,i;return _regeneratorRuntime().wrap((function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:if(this.API){r.next=2;break}return r.abrupt("return",!1);case 2:return n=e,r.next=5,this.API.GetFileInfo(n);case 5:if(!(i=r.sent)){r.next=9;break}return"success"==i.status&&(this.filename=i.filename,this.imagecount=i.imagecount,this.filesize=i.filesize),r.abrupt("return",i);case 9:case"end":return r.stop()}}),_callee5,this)}))),function SetFileInfo(e){return r.apply(this,arguments)})},{key:"Rotate",value:function Rotate(e,n){var i={angle:e},r=this.Internal1,a=this;return this.API.ImageTransform(r,"rotate",i).then((function(e){e&&"success"==e.status?(a.Modified=!0,a.Internal1=e.image_index):e.description}))}},{key:"ImgTransform",value:function ImgTransform(e,n,i){if(e&&n&&i){var r=this;return this.API.ImageTransform(e,n,i).then((function(e){e&&"success"==e.status?(r.Modified=!0,r.Internal1=e.image_index):e.description}))}}},{key:"RotateFine",value:function RotateFine(e,n){return Rotate(e,n)}},{key:"Copy",value:function Copy(){var e=new IWizImage(this.API),n=new DocURL;return n.Initialise(this.Usage.Util,this.Usage.Listener,this.Usage.ListenerData),n.src_number=this.src_number,n.url=this.url,n.Available=!0,e.Initialise(this.Imaging,n,this.PageNumber,this.Purpose,null),e.Width=this.width,e.Height=this.length,e.BitsPerPixel=this.bits_per_sample,e.XResolution=this.xresolution,e.YResolution=this.yresolution,e.BlackPerCent=this.blackpercent,e.Size=this.imagedata_size,e.Internal1=this.Internal1,e}},{key:"Crop",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(e,n,i,r){var a,c,u,h;return _regeneratorRuntime().wrap((function _callee6$(p){for(;;)switch(p.prev=p.next){case 0:return(a={top:0,bottom:0,left:0,right:0}).left=e,a.top=n,a.right=i,a.bottom=r,c=this.Internal1,u=this,p.next=10,this.API.ImageTransform(c,"extract",a);case 10:if((h=p.sent)&&"success"==h.status){p.next=14;break}return h.description,p.abrupt("return");case 14:return u.Modified=!0,u.Internal1=h.image_index,u.Usage.src_number=u.Internal1,u.Usage.BaseURL="",u.Usage.url="",p.abrupt("return",h);case 20:case"end":return p.stop()}}),_callee6,this)}))),function Crop(e,n,r,a){return i.apply(this,arguments)})},{key:"NormalCrop",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function _callee7(e,n,i,r){var a,c,u,h;return _regeneratorRuntime().wrap((function _callee7$(p){for(;;)switch(p.prev=p.next){case 0:return(a={top:0,bottom:0,left:0,right:0}).left=e,a.top=n,a.right=i,a.bottom=r,c=this.Internal1,u=this,p.next=10,this.API.ImageTransform(c,"extract",a);case 10:if((h=p.sent)&&"success"==h.status){p.next=14;break}return h.description,p.abrupt("return");case 14:return u.Modified=!0,u.Internal1=h.image_index,p.abrupt("return",u);case 17:case"end":return p.stop()}}),_callee7,this)}))),function NormalCrop(e,i,r,a){return n.apply(this,arguments)})},{key:"Thumbnail",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee8(e,n,i){var r;return _regeneratorRuntime().wrap((function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.API.getThumbnail(this.Internal1,e);case 2:return r=n.sent,n.abrupt("return",r);case 4:case"end":return n.stop()}}),_callee8,this)}))),function Thumbnail(n,i,r){return e.apply(this,arguments)})},{key:"Print",value:function Print(){}},{key:"SaveAs",value:function SaveAs(e,n){return!(!this.Handle||!this.Imaging)&&!!this.Imaging.ImageSave(this.Handle,e,n,!0)}},{key:"SaveChange",value:function SaveChange(){that.Modified&&(this.Usage.src_number=this.Internal1,that.Modified=!1)}},{key:"ChangeBitDepth",value:function ChangeBitDepth(e){var n={dither_arg:0,bpp:e},i=this.Internal1,r=this;return this.API.ImageTransform(i,"bpp",n).then((function(e){e&&"success"==e.status?(r.Modified=!0,r.Internal1=e.image_index):e.description}))}},{key:"EnsureSize",value:function EnsureSize(e,n){}},{key:"Deskew",value:function Deskew(e){var n={deskew_max_angle:e},i=this.Internal1,r=this;return this.API.ImageTransform(i,"deskew",n).then((function(e){e&&"success"==e.status?(r.Modified=!0,r.Internal1=e.image_index):e.description}))}},{key:"Despeckle",value:function Despeckle(e,n){var i={despeckle_mode:n,despeckle_quality:e},r=this.Internal1,a=this;return this.API.ImageTransform(r,"despeckle",i).then((function(e){e&&"success"==e.status?(a.Modified=!0,a.Internal1=e.image_index):e.description}))}},{key:"RemoveLines",value:function RemoveLines(e,n,i,r){var a={horz_lines:!1,vert_lines:!1,remove_lines_minlength:e,remove_lines_maxthickness:n,remove_line_reattach_symbols:r};i==IWizLineRemovalType.IWizLineRemoval_Both&&(a.horz_lines=!0,a.vert_lines=!0),i==IWizLineRemovalType.IWizLineRemoval_Vertical&&(a.vert_lines=!0,a.horz_lines=null),i==IWizLineRemovalType.IWizLineRemoval_Horizontal&&(a.horz_lines=!0,a.vert_lines=null);var c=this.Internal1,u=this;return this.API.ImageTransform(c,"remove_lines",a).then((function(e){e&&"success"==e.status?(u.Modified=!0,u.Internal1=e.image_index):e.description}))}},{key:"NewTextImage",value:function NewTextImage(e,n,i,r,a){var c={top:0,bottom:0,left:0,right:0};c.left=e,c.top=n,c.right=i,c.bottom=r,c.text_annotation=a;var u=this.Internal1,h=this;return this.API.ImageTransform(u,"text_annotation",c).then((function(e){e&&"success"==e.status?(h.Modified=!0,h.Internal1=e.image_index):e.description}))}},{key:"FillColour",value:function FillColour(e,n,i,r,a){var c={top:0,bottom:0,left:0,right:0};c.left=e,c.top=n,c.right=i,c.bottom=r,c.colour=a;var u=this.Internal1,h=this;return this.API.ImageTransform(u,"fillcolor",c).then((function(e){e&&"success"==e.status?(h.Modified=!0,h.Internal1=e.image_index):e.description}))}},{key:"FillColourOutside",value:function FillColourOutside(e,n,i,r,a){var c={top:0,bottom:0,left:0,right:0};c.left=e,c.top=n,c.right=i,c.bottom=r,c.colour=a;var u=this.Internal1,h=this;return this.API.ImageTransform(u,"fillcolor_outside",c).then((function(e){e&&"success"==e.status?(h.Modified=!0,h.Internal1=e.image_index):e.description}))}},{key:"SetImageAdjustMent",value:function SetImageAdjustMent(e,n,i,r){var a=null,c={};"brightness"==e?(c.brightness=n||0,a="brightness"):"contrast"==e?(c.contrast=n||0,a="contrast"):"smooth"==e?(c.smoothness=n||0,a="smooth"):"dilate"==e?a="dilate":"erode"==e?a="erode":"sharp"==e?a="sharp":"removeblackborder"==e&&(c.min_width=i||0,c.min_height=r||0,a="remove_border");var u=this.Internal1,h=this;return this.API.ImageTransform(u,a,c).then((function(e){e&&"success"==e.status?(h.Modified=!0,h.Internal1=e.image_index):e.description}))}},{key:"Invert",value:function Invert(){var e=this.Internal1,n=this;return this.API.ImageTransform(e,"invert").then((function(e){if(!e||"success"!=e.status)throw new Error("find and fix this error");n.Modified=!0,n.Internal1=e.image_index}))}},{key:"Close",value:function Close(){}},{key:"GetDIB",value:function GetDIB(){}},{key:"ChangeDPI",value:function ChangeDPI(e){var n={bpp:e,dither_arg:1},i=this.Internal1,r=this;return this.API.ImageTransform(i,"bpp",n).then((function(e){e&&"success"==e.status?(r.Modified=!0,r.Internal1=e.image_index):e.description}))}},{key:"CopyToClipboard",value:function CopyToClipboard(){}},{key:"MergeImage",value:function MergeImage(e,n,i,r){}},{key:"ResizeImage",value:function ResizeImage(e,n){}}]);var e,n,i,r,a}(),IWizImaging=function(){return _createClass((function IWizImaging(e,n,i){return _classCallCheck(this,IWizImaging),this.ScanWizInstance=null,this.ScanWizWnd=null,this.ImagingDll=null,this.ImageViewInstance=null,this.LastOpenedFile=null,this.LastOpenedPage=0,this.LastWriteTime=null,this.Util=null,this.ImageInfo=null,this.LastError=null,this.LastErrorString=null,this.ThumbnailFormat=null,this.ThumbnailPrefix=0,this.TypeCodeBPP1=5,this.TypeCodeBPPOther=86,this.JPEGCompQuality=40,this.pd=null,this.validState=0,this.TiffInfo=null,this.TiffRender=null,this.Initialise(e,n,i),this}),[{key:"Initialise",value:function Initialise(e,n,i){this.ImageViewInstance=e,this.ImagingDll="VisImage.DLL",this.Util=n,this.ScanWizWnd=i}},{key:"GetAttribute",value:function GetAttribute(e,n,i){var r=!0;if(this.LastOpenedFile&&this.LastOpenedFile==e&&this.LastOpenedPage==n&&this.Util.FileUnchangedSince(e,this.LastWriteTime)&&(r=!1),r&&(this.LastOpenedFile=null,this.LastOpenedPage=0,null==this.ImageInfo))return 0;switch(this.LastOpenedFile=e,this.LastOpenedPage=n,this.LastWriteTime=this.Util.GetFileModifiedTime(e),i){case IV_IMAGEATTRIB_FORMAT:return this.ImageInfo.typeCode;case IV_IMAGEATTRIB_WIDTH:return this.ImageInfo.width;case IV_IMAGEATTRIB_HEIGHT:return this.ImageInfo.height;case IV_IMAGEATTRIB_BITSPERPIXEL:return this.ImageInfo.bppix;case IV_IMAGEATTRIB_XRESOLUTION:return this.ImageInfo.horzRes;case IV_IMAGEATTRIB_YRESOLUTION:return this.ImageInfo.vertRes;default:return 0}}},{key:"Display",value:function Display(e,n,i){var r=new image_handle_info;return!e||!!(r=Internal_OpenImage(e,n,r,IWizImageOpenPurpose.IWIZIMAGE_OPEN_VIEWING))&&IV_SetImageHandle(this.ImageViewInstance,i,r.ImageLibHandle)}},{key:"ImageDisplay",value:function ImageDisplay(e){if(null==e)return!1;IV_SetImageHandle(this.ImageViewInstance,e,null);var n=new image_handle_info;return!(!n||!n.ImageLibHandle)&&IV_SetImageHandle(this.ImageViewInstance,e,n.ImageLibHandle)}},{key:"ImageSave",value:function ImageSave(e,n,i,r){return this.ImageAppend(e,n,i)}},{key:"ImageAppend",value:function ImageAppend(e,n,i){return!0}},{key:"NumPages",value:function NumPages(e){if(e instanceof IWizURL){if(this.TiffInfo&&this.TiffInfo.Name==e.URL.name&&this.TiffInfo.Size==e.URL.size&&this.TiffInfo.Type==FIleName.URL.type)return this.TiffInfo.TotalPage;this.TiffInfo=new IWizTiff,this.TiffInfo.Tiff=new Tiff({buffer:e.RawData}),this.TiffInfo.Name=e.URL.name,this.TiffInfo.Size=e.URL.size,this.TiffInfo.Type=e.URL.type,this.TiffInfo.TotalPage=this.TiffInfo.Tiff.countDirectory()}return this.TiffInfo.TotalPage}}])}(),image_handle_info=_createClass((function image_handle_info(){return _classCallCheck(this,image_handle_info),this.ImageLibHandle=null,this.VisImageHandle=null,this.Resolution=0,this}));function Internal_OpenImage(e,n,i,r){return null!=e||0}var IWizViewer=function(){return _createClass((function IWizViewer(e,n,i,r,a,c){return _classCallCheck(this,IWizViewer),this.Contents=null,this.ZoomFactor=0,this.ContentIndex=0,this.Image=null,this.CurrentContentIndex=0,this.CurrentImagePage=null,this.ViewInstance=null,this.ViewWnd=null,this.Imaging=null,this.Util=null,this.ContentListener=null,this.URLStatus=[],this.Parent=null,this.AutoDownload=!1,this.DisplayOption=null,this.ResetDisplayOptionOnNavigate=!1,this.NavigateAutoDownload=!1,this.ShowStatusOnNavigateDownload=!1,this.AutoSave=!1,this.Canvas=null,this.Contents=new DocContents,this.Contents.Initialise(r),this.Contents.Listener=this,this.Contents.Parent=this,this.Imaging=r,this.Util=a,this.ContentListener=c,this.ViewInstance=n,this.Canvas=new IWizCanvas(e),this.Canvas.Parent=this,this.img=i,this}),[{key:"GetLibrary",value:function GetLibrary(){return this.Parent.Library}},{key:"GetScanner",value:function GetScanner(){return this.Parent.Scanner}},{key:"SupportNavigation",value:function SupportNavigation(){return this.Contents.CanNavigate()}},{key:"GetNavigateIndex",value:function GetNavigateIndex(e,n){var i=this.Contents.NumElements();if(0==i)return 0;var r=-1;switch(e){case IWizNavigationOptions.NAVIGATION_FIRSTPAGE:i>1&&this.CurrentContentIndex>1&&(r=1);break;case IWizNavigationOptions.NAVIGATION_NEXTPAGE:this.CurrentContentIndex+1<i&&(r=this.CurrentContentIndex+1);break;case IWizNavigationOptions.NAVIGATION_PREVIOUSPAGE:this.CurrentContentIndex-1>=0&&(r=this.CurrentContentIndex-1);break;case IWizNavigationOptions.NAVIGATION_LASTPAGE:this.CurrentContentIndex+1<i&&(r=i-1);break;case IWizNavigationOptions.NAVIGATION_PAGENUMBER:if(n<=0)return 0;this.CurrentContentIndex+1!=n&&n<=i&&(r=n-1);break;case IWizNavigationOptions.NAVIGATION_DOCUMENTINDEX:if(n<=0)return 0;n<=i&&(r=n-1)}return r}},{key:"CanNavigate",value:function CanNavigate(e,n){return!!this.Parent&&(0!=this.Contents.NumElements()&&(0!=this.Contents.CanNavigate()&&this.GetNavigateIndex(e,n)>=0))}},{key:"NavigateTo",value:function NavigateTo(e,n){var i=IWizNavigationResult.NAVIGATION_INAVALID;if(!this.Parent)return!1;if(0==this.Contents.NumElements())return!1;if(0==this.Contents.CanNavigate())return!1;var r=this.GetNavigateIndex(e,n),a=this.Contents.Element(r);if(null==a)return!1;if(a.IsAvailable())i=this.DisplayImage(a,r)?IWizNavigationResult.NAVIGATION_OK:IWizNavigationResult.NAVIGATION_BADIMAGE;else{var c=this;a.Download(!0).then((function(e){c.DisplayImage(a,r)})),i=IWizNavigationResult.NAVIGATION_DOWNLOADING}return i}},{key:"FitWidth",value:function FitWidth(){if(this.Image)return this.Canvas.FitToWidth(),!0}},{key:"FitPage",value:function FitPage(){if(this.Image)return this.Canvas.FitToPage(),!0}},{key:"FitHeight",value:function FitHeight(){if(this.Image)return this.Canvas.FitToHeight(),!0}},{key:"FitLength",value:function FitLength(){return!!this.Image}},{key:"FitWindow",value:function FitWindow(){return!!this.Image}},{key:"ZoomIn",value:function ZoomIn(){return!!this.Image&&(this.Canvas.Zoom(1),!0)}},{key:"ZoomOut",value:function ZoomOut(){return!!this.Image&&(this.Canvas.Zoom(-1),!0)}},{key:"ZoomRect",value:function ZoomRect(e,n,i,r){if(!this.Image)return!1}},{key:"HRevert",value:function HRevert(){return!!this.Image&&(this.Canvas.HRevert(),!0)}},{key:"VRevert",value:function VRevert(){return!!this.Image&&(this.Canvas.VRevert(),!0)}},{key:"rotateLeft",value:function rotateLeft(){return!!this.Image&&(this.Canvas.rotateLeft(),!0)}},{key:"rotateRight",value:function rotateRight(){return!!this.Image&&(this.Canvas.rotateRight(),!0)}},{key:"reset",value:function reset(){return!!this.Image&&(this.Canvas.reset(),!0)}},{key:"GetViewRect",value:function GetViewRect(){return this.Image?rect:null}},{key:"CloseImage",value:function CloseImage(){return!!this.Image&&(this.ClearDisplay(),!0)}},{key:"Save",value:function Save(e){return!!this.DoSave(e)}},{key:"SetMouseTool",value:function SetMouseTool(e){if(this.Image){return e==IWizViewerMouseTools.IWizMouseTool_Zoom?this.Canvas.handleZoomMouseTool(!0):e==IWizViewerMouseTools.IWizMouseTool_Pan?this.Canvas.handlePanMouseTool(!0):e==IWizViewerMouseTools.IWizMouseTool_Magnifier&&this.Canvas.handleMagnificationTool(!0),!1}return!1}},{key:"DrawAnnotation",value:function DrawAnnotation(e){if(this.Image)return e==IWizViewerAnnotations.IWizAnnotation_Rectangle?this.Canvas.initAnnotationDraw(IWizViewerAnnotations.IWizAnnotation_Rectangle):e==IWizViewerAnnotations.IWizAnnotation_Line?this.Canvas.initAnnotationDraw(IWizViewerAnnotations.IWizAnnotation_Line):void 0}},{key:"ScrollTo",value:function ScrollTo(e,n){if(this.Image){var i={};i.x=e,i.y=n;IVView_ScrollTo(i);return!0}return!1}},{key:"Scroll",value:function Scroll(e,n){return!this.Image}},{key:"SetFocus",value:function SetFocus(){this.Canvas.canvas&&(this.Canvas.canvas.setAttribute("tabindex","0"),this.Canvas.canvas.focus())}},{key:"ClearDisplay",value:function ClearDisplay(){return this.Canvas&&this.Canvas.ResetPrevControls(),this.ViewWnd?null:!!this.Image&&(this.AutoSave&&this.DoSave(),this.Image=null,this.Imaging.Display(null,0,this.ViewWnd),this.ResetDisplayOptionOnNavigate&&IVView_SetDisplayOption(this.ViewWnd,this.DisplayOption),void(this.CurrentContentIndex=this.CurrentContentPage=0))}},{key:"ReloadImage",value:function ReloadImage(e){if(this.Image&&this.Image.Internal1!=e){var n=new clsTwainFilePages(1,e,!1);this.Image.Internal1=e,this._DisplayPage(n)}}},{key:"DisplayImage",value:function DisplayImage(e,n){this.ClearDisplay(),this.CurrentContentIndex=n+1,this.CurrentContentPage=1,this.ContentIndex=n+1;var i=this.Parent.GetScanner(),r=(this.img,new clsTwainFilePages(this.CurrentContentPage,e.src_number,!1)),a=new IWizImage(i);return a.Internal1=r.ImageNumber,null!=a&&(a.Initialise(this.Imaging,e,this.CurrentContentPage,IWizImageOpenPurpose.IWIZIMAGE_OPEN_VIEWING,r)&&(this.Image=a),this._DisplayPage(r))}},{key:"_DisplayPage",value:function _DisplayPage(e){var n=this;if(!(e instanceof clsTwainFilePages&&e.ImageNumber))return!1;var i=this.Parent.GetScanner(),r=document.getElementById("imgPlaceHolder_"+this.Parent.DOM_ID);return this.CurrentImagePage=e,e.Availabe?(r.onload=function(){n.Canvas.HaveImg(r)},r.src=e.BlobURL,!0):i.ImageGet(e.ImageNumber).then((function(i){e.BlobURL=i,e.Availabe=!0,r.onload=function(){n.Canvas.HaveImg(r)},r.src=i})).catch((function(e,n){}))}},{key:"DisplayStatus",value:function DisplayStatus(e,n){this.ClearDisplay(),this.CurrentContentIndex=n.Index,this.CurrentContentPage=n.Page;var i=e.Parent,r=this.URLIndex(i);if(r<0){var a=new IWizURLStatus(i,e,n,"Preparing..");if(null==a)return null;this.URLStatus.push(a),r=this.URLStatus.length}else this.ShowStatusText(this.URLStatus[r].Status)}},{key:"ShowStatusText",value:function ShowStatusText(e){if(!this.ViewWnd)return null}},{key:"URLIndex",value:function URLIndex(e){var n;for(n=0;n<this.URLStatus.length;n++){if(this.URLStatus[n].URLObject==e)return n}return-1}},{key:"GetParents",value:function GetParents(){return this.Parent}},{key:"ReloadCurrentImage",value:function ReloadCurrentImage(){if(!this.Image)return!0;var e=this.Image.Internal1,n=new clsTwainFilePages(1,e,!1);this._DisplayPage(n)}},{key:"Rotate",value:function Rotate(e){var n=this;return this.Image.Rotate(e).then((function(e){n.ReloadCurrentImage()}))}},{key:"Invert",value:function Invert(){var e=this;return this.Image.Invert().then((function(n){e.ReloadCurrentImage()}))}},{key:"DoSave",value:function DoSave(e){if(!this.Image)return!0;var n;if(this.Image.Modified){if(e)var i=this.Contents.Element(e-1);else i=this.Contents.Element(this.CurrentContentIndex-1);i.src_number=this.Image.Internal1,this.Image.ClearModified()}else n=!0;return n}}])}(),DocContents=function(){return _createClass((function DocContents(){return _classCallCheck(this,DocContents),this.Index=0,this.FirstNotAvailable=0,this.IsAvailable=!1,this.EventListener=null,this.DocURLList=new DocURLList,this.List=[],this.ImageId=131072,this.ImageFunctions=null,this.AutoDownload=!0,this.Parent=null,this.AppId=0,this}),[{key:"Initialise",value:function Initialise(e){this.ImageFunctions=e}},{key:"SetCurrentAppId",value:function SetCurrentAppId(e){this.AppId=e}},{key:"LoadFromLib",value:function LoadFromLib(e){var n=this.Parent.GetLibrary();if(!n)return!1;var i=n.GetURLList(e);return!!i&&(this.DocURLList=i,this.AppId=e,!0)}},{key:"AddAvailableURL",value:function AddAvailableURL(e,n,i,r){return this.AppId!=r&&this.LoadFromLib(r),!!this.DocURLList&&(this.DocURLList.Add(e,n,r),!0)}},{key:"Add",value:function Add(e,n,i,r,a){if(this.AppId!=a&&this.LoadFromLib(a),this.DocURLList){var c=this.DocURLList.AddURL(e,n,a);return this.Parent.GetLibrary().AutoDownload&&c.Download(),!0}}},{key:"AddFileAt",value:function AddFileAt(e,n,i,r,a){return this.AppId!=r&&this.LoadFromLib(r),!!this.DocURLList&&(this.DocURLList.Add(e,n,r,a),!0)}},{key:"NumPages",get:function get(){if(this.DocURLList)return this.DocURLList.NumPages}},{key:"AddLib",value:function AddLib(e,n,i,r){var a=this.Parent.GetLibrary();if(!a)return!1;if(0!=n){if(1==a.URLList.length)p=a.URLList[0];else p=a.GetURLList(r);if(!p)return!1;for(var c=n-1,u=i-1,h=0;h<p.List.length;h++)if(h>=c&&h<=u){f=p.List[h];this.DocURLList.AddURLReference(f)}return!1}for(var p=a.GetURLList(r),d=0;d<p.List.length;d++){var f=p.List[d];this.DocURLList.AddURLReference(f)}}},{key:"IWizURLUsage",value:function IWizURLUsage(e){return this.DocURLList.Element(e)}},{key:"Delete",value:function Delete(e,n){this.DocURLList.Delete(e)}},{key:"CanNavigate",value:function CanNavigate(){return!0}},{key:"NumElements",value:function NumElements(){if(this.DocURLList)return this.DocURLList.NumPages}},{key:"NumPagesAvailable",get:function get(){if(this.DocURLList)return this.DocURLList.NumPagesAvailable()}},{key:"NumAvailable",value:function NumAvailable(){if(this.DocURLList)return this.DocURLList.NumAvailable()}},{key:"Clear",value:function Clear(){return this.DocURLList=new DocURLList,this.AppId=0,this.List=[],this.Parent.ClearDisplay(),!0}},{key:"Move",value:function Move(e,n,i){return!!this.DocURLList&&(this.DocURLList.Move(e,n,i),this.EventListener&&this.EventListener.ContentElementMoved(e,n,this.List[n-1]),!0)}},{key:"Download",value:function Download(e){return!!this.DocURLList&&this.DocURLList.List[e].Download()}},{key:"Element",value:function Element(e){return this.DocURLList?this.DocURLList.List[e]:null}},{key:"Thumbnail",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee9(e,n,i,r,a){var c,u;return _regeneratorRuntime().wrap((function _callee9$(h){for(;;)switch(h.prev=h.next){case 0:if(c=this.LoadImage(e,n)){h.next=3;break}return h.abrupt("return",null);case 3:return h.next=5,c.Thumbnail(i,r,a);case 5:return u=h.sent,h.abrupt("return",u);case 7:case"end":return h.stop()}}),_callee9,this)}))),function Thumbnail(n,i,r,a,c){return e.apply(this,arguments)})},{key:"LoadImage",value:function LoadImage(e,n){var i,r=this.Parent.GetScanner();if(e<=0||e>this.DocURLList.List.length)return!1;if(!(i=this.DocURLList.List[e-1]).IsAvailable())return!1;var a=new IWizImage(r);return a.Internal1=i.src_number,a?(a.Initialise(this.ImageFunctions,i,1,IWizImageOpenPurpose.IWIZIMAGE_OPEN_OTHER,null),a):null}}]);var e}(),IWizURLStatus=_createClass((function IWizURLStatus(e,n,i,r){_classCallCheck(this,IWizURLStatus),this.URLObject=e,this.UsageObject=n,this.Status=r,this.Index=i.Index,this.Page=i.Page})),IWizURLOperation=function(){return _createClass((function IWizURLOperation(e,n){return _classCallCheck(this,IWizURLOperation),this.URL=e,this.Verb=n,this.Status=0,this.TotalBytes=0,this.BytesDone=0,this.StartTime="",this.EndTime="",this.TimeTaken=0,this.Status=0,this.StatusText="Started    ",this.Started=!1,this.PostResponse=null,this.NumPages=0,this.DisplayPage=!1,this}),[{key:"SetResponse",value:function SetResponse(e){e.hasOwnProperty("bytes")&&(this.BytesDone=e.bytes),e.hasOwnProperty("total")&&(this.TotalBytes=e.total),e.hasOwnProperty("when")&&(this.Started?this.EndTime=e.when:this.StartTime=e.when),e.hasOwnProperty("status")&&"completed"==e.status&&e.data&&e.data.acquired_count&&(this.NumPages=e.data.acquired_count)}}])}();function IS_AVAILABLE_NAVIGATION(e){return e>=IWizNavigationOptions.NAVIGATION_LASTAVAILABLE&&e<=IWizNavigationOptions.NAVIGATION_FIRSTAVAILABLE}function IS_DOCUMENT_NAVIGATION(e){return e>=IWizNavigationOptions.NAVIGATION_DOCUMENTINDEX&&e<=IWizNavigationOptions.NAVIGATION_FIRSTDOCUMENT}var IWizOutput=function(){function IWizOutput(e,n,i){return _classCallCheck(this,IWizOutput),this.URLOperation=null,this.HaveError=!1,this.mFileName="",this.Attributes=0,this.Name="",this.mFileSize=0,this.AppData="",this.EnableOutputEvent=!1,this.Modified=!1,this.Parent=null,this.Util=null,this.Imaging=null,this.PageCount=0,this.Listener=null,this.ListenerData=null,this.ObjURLOp=null,this.AutoCopy=0,this.EventListener=null,this.OutPutURLList=null,this.Stamping=null,this.Overwrite=!0,this.Initialise(i,e,n),this}return _createClass(IWizOutput,[{key:"Initialise",value:function Initialise(e,n,i){this.OutPutURLList=new DocURLList,this.OutPutURLList.Initialise(n,e,""),this.Parent=e,this.Util=n,n&&n.GetTemporaryFileName(),this.Imaging=i}},{key:"FileName",value:(p=_asyncToGenerator(_regeneratorRuntime().mark((function _callee10(){return _regeneratorRuntime().wrap((function _callee10$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.GetOutputFilename();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),_callee10,this)}))),function FileName(){return p.apply(this,arguments)})},{key:"FileSize",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function _callee11(){return _regeneratorRuntime().wrap((function _callee11$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.GetOutputFilename();case 2:return e.sent,e.abrupt("return",this.mFileSize);case 4:case"end":return e.stop()}}),_callee11,this)}))),function FileSize(){return h.apply(this,arguments)})},{key:"getOutPutFileSize",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function _callee12(){return _regeneratorRuntime().wrap((function _callee12$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.GetOutputFileSize();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),_callee12,this)}))),function getOutPutFileSize(){return u.apply(this,arguments)})},{key:"NumPages",get:function get(){return this.OutPutURLList.length}},{key:"AddNewPage",value:function AddNewPage(e){if(this.EnableOutputEvent){var n,i;e.url;i=new IWizOutput(this.Util,this.Imaging);var r=this.Parent.GetScanner();if((n=new IWizImage(r)).Internal1=e.src_number,n.Initialise(this.Imaging,e,1,IWizImageOpenPurpose.IWIZIMAGE_OPEN_OTHER,null),i.Accept=!0,this.EventListener&&this.EventListener.AddOutputImage&&this.EventListener.AddOutputImage(i,n),0==i.Accept)return!1}this.OutPutURLList.CopyAddURL(e),this.Modified=!0}},{key:"AppendOutput",value:function AppendOutput(e){for(var n=e.OutPutURLList,i=this.OutPutURLList.List.length,r=0;r<n.List.length;r++){var a=n.List[r];this.AddNewPage(a)}return this.OutPutURLList.List.length-i}},{key:"AddLibContent",value:function AddLibContent(e,n,i){var r=this.Parent.GetLibrary();if(!r)return!1;var a=r.GetURLWithIndex(e);if(!a||!a.List)return!1;var c=a.List.length;if(0!=n){for(var u=0;u<c;u++){p=a.List[u];u>=n-1&&u<=i-1&&this.AddNewPage(p)}return!0}for(var h=0;h<c;h++){var p=a.List[h];this.AddNewPage(p)}}},{key:"AddViewerContents",value:function AddViewerContents(){for(var e=this.Parent.Viewer.Contents.DocURLList,n=0;n<e.List.length;n++){var i=e.List[n];this.AddNewPage(i)}return!0}},{key:"AddViewerContent",value:function AddViewerContent(e,n,i){for(var r=this.Parent.Viewer.Contents.DocURLList,a=0;a<r.List.length;a++){var c=r.List[a];a>n-1&&a<i-1&&this.AddNewPage(c)}return!0}},{key:"AddImage",value:function AddImage(e){var n=e.Usage;this.AddNewPage(n)}},{key:"GetOutputFilename",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee13(){var e,n,i,r;return _regeneratorRuntime().wrap((function _callee13$(a){for(;;)switch(a.prev=a.next){case 0:if(0!=this.Modified){a.next=2;break}return a.abrupt("return",this.mFileName);case 2:for(e=[],i=0;i<this.OutPutURLList.List.length;i++)r=this.OutPutURLList.List[i],e.push(r.src_number);return a.next=6,this.internal_create_output(e,null,this.Name,40,this.Stamping,this.Overwrite);case 6:return(n=a.sent)&&(this.mFileSize=n.size),this.Modified=!1,a.abrupt("return",this.mFileName);case 10:case"end":return a.stop()}}),_callee13,this)}))),function GetOutputFilename(){return c.apply(this,arguments)})},{key:"GetOutputFileSize",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function _callee14(){var e,n,i,r;return _regeneratorRuntime().wrap((function _callee14$(a){for(;;)switch(a.prev=a.next){case 0:if(0!=this.Modified){a.next=2;break}return a.abrupt("return",this.mFileSize);case 2:for(e=[],i=0;i<this.OutPutURLList.List.length;i++)r=this.OutPutURLList.List[i],e.push(r.src_number);return a.next=6,this.internal_get_output_size(e,null,this.Name,40,this.Stamping,this.Overwrite);case 6:if(!(n=a.sent)){a.next=10;break}return this.mFileSize=n.size,a.abrupt("return",this.mFileSize);case 10:return this.Modified=!1,a.abrupt("return",0);case 12:case"end":return a.stop()}}),_callee14,this)}))),function GetOutputFileSize(){return a.apply(this,arguments)})},{key:"SetStampingInfo",value:function SetStampingInfo(e){if(!e)return!1;if(!e.text||!e.xpos||!e.ypos)return!1;var n=this.NumPages;if(n){e&&!e.pages&&(e.pages=[]),e.pages=[];for(var i=1;i<=n;i++)e.pages.push("")}this.Stamping=e}},{key:"ResetStampingInfo",value:function ResetStampingInfo(){this.Stamping=null}},{key:"AppendToViewerContent",value:function AppendToViewerContent(){for(var e=this.Parent.Viewer.Contents.DocURLList,n=this.OutPutURLList.List,i=0;i<n.length;i++){var r=n[i];e.CopyAddURL(r)}}},{key:"AddToLib",value:function AddToLib(e){var n=this.Parent.GetLibrary();if(!n)return!1;for(var i=this.OutPutURLList.List,r=0;r<i.length;r++){var a=i[r];n.Add(a.url,a.src_number,e)}}},{key:"CopyTo",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function _callee15(e,n){var i,r;return _regeneratorRuntime().wrap((function _callee15$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.GetOutputFilename();case 2:return a.sent,i=this.Parent.Scanner,a.next=6,i.CopyTo(this.Name,"Select folder and filename to Save",e,!0,n);case 6:return r=a.sent,a.abrupt("return",r);case 8:case"end":return a.stop()}}),_callee15,this)}))),function CopyTo(e,n){return r.apply(this,arguments)})},{key:"Upload",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function _callee16(e,n){var i,r,a,c;return _regeneratorRuntime().wrap((function _callee16$(u){for(;;)switch(u.prev=u.next){case 0:return i=this.Parent.Scanner,u.next=3,i.Upload(this.Name,e,n);case 3:if(r=u.sent,a="success",this.Parent&&this.Parent.CurrentURLOps){u.next=8;break}return a="Unknown error",u.abrupt("return",a);case 8:return c={URLOperation:this.Parent.CurrentURLOps,Operation:"UPLOAD"},this.Parent.CurrentURLOps.PostResponse=r,r&&(r.status&&"success"!==r.status.toLowerCase()?(a=r.status_desc||"Unknown error",this.Parent.URLOpError(c,this.Parent.CurrentURLOps.URL,r.status,a,"")):r.error||r.ERROR?(a=r.error||r.ERROR,this.Parent.URLOpError(c,this.Parent.CurrentURLOps.URL,"ERROR",a,"")):(r.IMAGEID&&(this.Parent.CurrentURLOps.IMAGEID=r.IMAGEID),this.Parent.URLOpCompleted(c,this.Parent.CurrentURLOps.URL,this.Parent.CurrentURLOps.BytesDone,""))),this.Parent.CurrentURLOps=null,u.abrupt("return",a);case 13:case"end":return u.stop()}}),_callee16,this)}))),function Upload(e,n){return i.apply(this,arguments)})},{key:"Reset",value:function Reset(){this.OutPutURLList.List=[],this.mFileSize=0,this.mFileName=""}},{key:"Delete",value:function Delete(){this.mFileSize>0&&this.Reset(),this.OutPutURLList.List=[]}},{key:"Print",value:function Print(e,n){}},{key:"internal_create_output",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function _callee17(e,n,i,r,a,c){var u,h,p;return _regeneratorRuntime().wrap((function _callee17$(d){for(;;)switch(d.prev=d.next){case 0:return u=this.Parent.Scanner,d.next=3,u.saveOutput(e,n,i,r,a,c);case 3:if(!(h=d.sent)){d.next=9;break}return d.next=7,u.getOutput(i);case 7:p=d.sent,this.mFileName=p;case 9:return d.abrupt("return",h);case 10:case"end":return d.stop()}}),_callee17,this)}))),function internal_create_output(e,i,r,a,c,u){return n.apply(this,arguments)})},{key:"internal_get_output_size",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee18(e,n,i,r,a,c){var u,h;return _regeneratorRuntime().wrap((function _callee18$(p){for(;;)switch(p.prev=p.next){case 0:return u=this.Parent.Scanner,p.next=3,u.saveOutput(e,n,i,r,a,c);case 3:return h=p.sent,p.abrupt("return",h);case 5:case"end":return p.stop()}}),_callee18,this)}))),function internal_get_output_size(n,i,r,a,c,u){return e.apply(this,arguments)})}]);var e,n,i,r,a,c,u,h,p}(),twainCtrl=function(){var _defaultAppName="etpl_httptwain_client",_defaultURL="",jsTwainRequestTypes={info:"get",reserve:"post","twain/source/open":"post","twain/capabilities/get":"post","twain/capabilities/getcurrent":"post","twain/capabilities/getdefault":"post","twain/capabilities/querysupport":"post","twain/capabilities/reset":"post","twain/capabilities/set":"post","twain/source/enable":"post","image/count":"get","image/get":"get","image/thumbnail":"get","image/info":"get","image/transform":"post","importedimage/get":"get","importedimage/info":"get","twain/source/disable":"post","twain/source/close":"post","output/create":"post","output/get":"get","output/upload":"post","output/copyto":"post","acquire/file":"post","acquire/folder":"post","acquire/download":"post","twain/profile/create":"post","twain/profile/view":"post","twain/profile/edit":"post","twain/profile/add":"post","twain/profile/get":"get",release:"post",disablesource:"post"},twainBlankRequest=function twainBlankRequest(e){var n={};if("string"!=typeof e)return null;switch(n.method=e,n.kind=jsTwainRequestTypes[e],e){case"info":case"twain/capabilities/set":case"image/count":case"twain/source/disable":case"twain/source/close":case"release":break;case"reserve":n.data={name:null,inactive_mins:null,licence_data:null};break;case"twain/source/open":n.data={dialog:null,default:null,name:null};break;case"twain/capabilities/get":case"twain/capabilities/getcurrent":case"twain/capabilities/getdefault":case"twain/capabilities/querysupport":case"twain/capabilities/reset":n.data={capabilities:null,mnenomics:null};break;case"twain/source/enable":n.data={show_ui:null,max_pages:null,extimageinfo:null,profile:null};break;case"image/get":case"importedimage/get":case"image/info":case"importedimage/info":n.data={number:null};break;case"image/thumbnail":n.data={number:null,size:null};break;case"image/transform":n.data={number:null,operation:null,angle:null,left:null,top:null,right:null,bottom:null,bpp:null,horz_lines:null,vert_lines:null,despeckle_quality:null,despeckle_mode:null,remove_lines_minlength:null,remove_lines_maxthickness:null,remove_line_reattach_symbols:null,deskew_max_angle:null,dither_arg:null,colour:null,brightness:null,contrast:null,smoothness:null,min_width:null,min_height:null};break;case"output/create":n.data={images:null,format:null,name:null,jpeg_quality:null,stamping:null,overwrite:null};break;case"output/get":n.data={name:null,base64:null};break;case"output/upload":n.data={name:null,method:null,url:null,filepart_name:null,multi_part:null,addl_parts:null,headers:null,options:null};break;case"output/copyto":n.data={name:null,title:null,filespec:null,restrict:null,folder:null,filename:null};break;case"acquire/file":n.data={filespec:null,restrict:null,max_pages:null,multi_select:null,title:null,pdf_options:{dpi:null,bitonal:null,image_options:null}};break;case"acquire/folder":n.data={filepattern:null,restrict:null,max_pages:null,title:null,recurse:null,pdf_options:{dpi:null,bitonal:null,image_options:null}};break;case"acquire/download":n.data={multi_part:null,url:null,method:null,query_string:null,headers:null,parts:null,options:null,pdf_options:{dpi:null,bitonal:null,image_options:null}};break;case"twain/profile/create":case"twain/profile/view":case"twain/profile/edit":case"twain/profile/get":n.data={name:null};break;case"twain/profile/add":n.data={name:null,data:null};break;default:n=null}return n&&n.data&&(n.data.appref=null),n},remove_null_properties=function remove_null_properties(e){var n,i=[];for(n in e)e.hasOwnProperty(n)&&null===e[n]&&i.push(n);if(0==i.length)return e;for(var r=0;r<i.length;r++)delete e[i[r]];return e},make_query_string=function make_query_string(e){var n,i=new URLSearchParams;for(n in e)e.hasOwnProperty(n)&&null!==e[n]&&i.set(n,e[n]);return i.toString()},jsTwain=function(){function jsTwain(e,n,i){return _classCallCheck(this,jsTwain),this.appname=e||_defaultAppName,this.url=n||_defaultURL,this.pulse=new jsTwainPulse(this),this.http_request=null,this.request=null,this.acquired_image=null,this.have_image=null,this.have_thumbnail=null,this.have_output=null,this.have_response=null,this.Acquiring=!1,this.OnReleased=null,this.selectType=0,this.SourceOpen=!1,this.DisplayWhileAcquiring=!1,this.UIModeEnabled=!0,this.SourceName="",this.ScanProfile="",this.Device="",this.SourceEnabled=!1,this.ServiceTimeOut=10,this.AppLicense="",this}return _createClass(jsTwain,[{key:"SelectFile",value:(_SelectFile=_asyncToGenerator(_regeneratorRuntime().mark((function _callee19(e,n,i,r,a,c){var u,h,p;return _regeneratorRuntime().wrap((function _callee19$(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.CheckAndDisableSoruce();case 2:return u=twainBlankRequest("acquire/file"),c&&(this.selectType=c),u.data.title=void 0!==e?e:"Select a tif image file",u.data.filespec=void 0!==n?n:["Multipage Tif File","*.tif"],void 0===i&&(i=999),u.data.max_pages=i,void 0!==r&&(u.data.multi_select=r),u.data.restrict=void 0===a||a,this.Acquiring=!0,h=this,d.next=14,this.make_request_promise(u);case 14:return p=d.sent,h.Acquiring=!1,d.abrupt("return",p);case 17:case"end":return d.stop()}}),_callee19,this)}))),function SelectFile(e,n,i,r,a,c){return _SelectFile.apply(this,arguments)})},{key:"SelectSource",value:(_SelectSource=_asyncToGenerator(_regeneratorRuntime().mark((function _callee20(e){var n;return _regeneratorRuntime().wrap((function _callee20$(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.InternalOpenSource(e);case 2:return(n=i.sent)&&(this.SourceName=e),i.abrupt("return",n);case 5:case"end":return i.stop()}}),_callee20,this)}))),function SelectSource(e){return _SelectSource.apply(this,arguments)})},{key:"SetSource",value:function SetSource(e){this.SourceName=e}},{key:"AcquireImages",value:(_AcquireImages=_asyncToGenerator(_regeneratorRuntime().mark((function _callee21(e,n,i){var r,a;return _regeneratorRuntime().wrap((function _callee21$(c){for(;;)switch(c.prev=c.next){case 0:if(r=twainBlankRequest("twain/source/enable")){c.next=3;break}return c.abrupt("return",!1);case 3:return this.selectType=e,n&&(r.data.show_ui=!0),i&&(r.data.max_pages=i),""!=this.ScanProfile&&(r.data.profile=this.ScanProfile),c.prev=7,this.SourceEnabled=!0,c.next=11,this.make_request_promise(r);case 11:return(a=c.sent).status,c.abrupt("return",a);case 16:c.prev=16,c.t0=c.catch(7);case 19:case"end":return c.stop()}}),_callee21,this,[[7,16]])}))),function AcquireImages(e,n,i){return _AcquireImages.apply(this,arguments)})},{key:"CloseSource",value:(_CloseSource=_asyncToGenerator(_regeneratorRuntime().mark((function _callee22(){var e,n;return _regeneratorRuntime().wrap((function _callee22$(i){for(;;)switch(i.prev=i.next){case 0:if(e=twainBlankRequest("twain/source/close")){i.next=3;break}return i.abrupt("return",!1);case 3:return i.prev=3,i.next=6,this.make_request_promise(e);case 6:return n=i.sent,i.abrupt("return",n);case 10:i.prev=10,i.t0=i.catch(3);case 13:case"end":return i.stop()}}),_callee22,this,[[3,10]])}))),function CloseSource(){return _CloseSource.apply(this,arguments)})},{key:"CheckAndDisableSoruce",value:(_CheckAndDisableSoruce=_asyncToGenerator(_regeneratorRuntime().mark((function _callee23(){return _regeneratorRuntime().wrap((function _callee23$(e){for(;;)switch(e.prev=e.next){case 0:if(!this.SourceEnabled){e.next=5;break}return e.next=3,this.DisableSource();case 3:e.sent,this.SourceEnabled=!1;case 5:case"end":return e.stop()}}),_callee23,this)}))),function CheckAndDisableSoruce(){return _CheckAndDisableSoruce.apply(this,arguments)})},{key:"DisableSource",value:(_DisableSource=_asyncToGenerator(_regeneratorRuntime().mark((function _callee24(){var e,n;return _regeneratorRuntime().wrap((function _callee24$(i){for(;;)switch(i.prev=i.next){case 0:if(e=twainBlankRequest("twain/source/disable")){i.next=3;break}return i.abrupt("return",!1);case 3:return i.prev=3,i.next=6,this.make_request_promise(e);case 6:return n=i.sent,i.abrupt("return",n);case 10:i.prev=10,i.t0=i.catch(3);case 13:case"end":return i.stop()}}),_callee24,this,[[3,10]])}))),function DisableSource(){return _DisableSource.apply(this,arguments)})},{key:"OpenSource",value:(_OpenSource=_asyncToGenerator(_regeneratorRuntime().mark((function _callee25(){var e;return _regeneratorRuntime().wrap((function _callee25$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.CheckAndDisableSoruce();case 2:if(""!=this.SourceName){n.next=10;break}return n.next=6,this.InternalOpenSource(this.SourceName,void 0,!0);case 6:case 12:return e=n.sent,n.abrupt("return",e);case 10:return n.next=12,this.InternalOpenSource(this.SourceName);case 14:case"end":return n.stop()}}),_callee25,this)}))),function OpenSource(){return _OpenSource.apply(this,arguments)})},{key:"InternalOpenSource",value:(_InternalOpenSource=_asyncToGenerator(_regeneratorRuntime().mark((function _callee26(e,n,i){var r,a;return _regeneratorRuntime().wrap((function _callee26$(c){for(;;)switch(c.prev=c.next){case 0:if(r=twainBlankRequest("twain/source/open")){c.next=3;break}return c.abrupt("return",!1);case 3:return e&&(r.data.name=e),void 0===n&&(r.data.default=n),void 0===i&&(r.data.dialog=i),e||n||(r.data.dialog=!0),c.prev=7,this.Device="",this.SourceOpen=!1,c.next=12,this.make_request_promise(r);case 12:return"success"==(a=c.sent).status&&(this.SourceOpen=!0,this.Device=a.device,this.SourceName=a.device),c.abrupt("return",!0);case 17:c.prev=17,c.t0=c.catch(7);case 20:case"end":return c.stop()}}),_callee26,this,[[7,17]])}))),function InternalOpenSource(e,n,i){return _InternalOpenSource.apply(this,arguments)})},{key:"Upload",value:(_Upload2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee27(e,n,i){var r,a;return _regeneratorRuntime().wrap((function _callee27$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.CheckAndDisableSoruce();case 2:if(r=twainBlankRequest("output/upload")){c.next=5;break}return c.abrupt("return",!1);case 5:return r.data=i,r.data.name=e,n&&(r.data.url=n),c.prev=8,c.next=11,this.make_request_promise(r);case 11:return a=c.sent,c.abrupt("return",a);case 15:c.prev=15,c.t0=c.catch(8);case 18:case"end":return c.stop()}}),_callee27,this,[[8,15]])}))),function Upload(e,n,i){return _Upload2.apply(this,arguments)})},{key:"CopyTo",value:(_CopyTo2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee28(e,n,i,r,a){var c,u;return _regeneratorRuntime().wrap((function _callee28$(h){for(;;)switch(h.prev=h.next){case 0:if(c=twainBlankRequest("output/copyto")){h.next=3;break}return h.abrupt("return",!1);case 3:return c.data.name=e,c.data.filespec=["Tiff File","*.tif"],c.data.title=n,r&&(c.data.restrict=r),i&&(c.data.filename=i),a&&(c.data.folder=a),h.prev=9,h.next=12,this.make_request_promise(c);case 12:return u=h.sent,h.abrupt("return",u);case 16:h.prev=16,h.t0=h.catch(9);case 19:case"end":return h.stop()}}),_callee28,this,[[9,16]])}))),function CopyTo(e,n,i,r,a){return _CopyTo2.apply(this,arguments)})},{key:"Download",value:(_Download=_asyncToGenerator(_regeneratorRuntime().mark((function _callee29(e,n){var i,r;return _regeneratorRuntime().wrap((function _callee29$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.CheckAndDisableSoruce();case 2:if(i=twainBlankRequest("acquire/download")){a.next=5;break}return a.abrupt("return",!1);case 5:return i.data=n,i.data.appref=e,e&&(i.data.url=e),a.prev=8,a.next=11,this.make_request_promise(i);case 11:return r=a.sent,a.abrupt("return",r);case 15:return a.prev=15,a.t0=a.catch(8),a.abrupt("return",!1);case 19:case"end":return a.stop()}}),_callee29,this,[[8,15]])}))),function Download(e,n){return _Download.apply(this,arguments)})},{key:"GetDownload",value:function GetDownload(e,n){var i=twainBlankRequest("acquire/download");return!!i&&(!!i.hasOwnProperty("data")&&(i.data.method="get",i.data.url=e,i.data.appref=e,this&&this.appConfig&&(i.data.options||(i.data.options={}),this.appConfig.IS_HTTPS?Object.assign(i.data.options,{SSL_VERIFYPEER:"1"}):Object.assign(i.data.options,{SSL_VERIFYPEER:"0"})),n&&(i.data.query_string=n),this.make_request_promise(i)))}},{key:"ImageCount",value:function ImageCount(){return this.make_request_promise(twainBlankRequest("image/count"))}},{key:"Release",value:function Release(e){var n;return"reserved"==this.pulse.state&&(n=twainBlankRequest("release"),this.make_request(n,e))}},{key:"ReleaseRefresh",value:(_ReleaseRefresh=_asyncToGenerator(_regeneratorRuntime().mark((function _callee30(e,n){var i,r,a;return _regeneratorRuntime().wrap((function _callee30$(e){for(;;)switch(e.prev=e.next){case 0:if(n&&(r=JSON.parse(n),this.pulse.state="reserved",this.pulse.app_token=r.token,this.pulse.http_request=[],this.pulse.http_request.response=n),"reserved"==this.pulse.state){e.next=3;break}return e.abrupt("return",!1);case 3:return i=twainBlankRequest("release"),e.next=6,this.make_request_promise(i);case 6:return a=e.sent,this.pulse.state="none",this.pulse.app_token="",this.pulse.http_request=null,e.abrupt("return",a);case 11:case"end":return e.stop()}}),_callee30,this)}))),function ReleaseRefresh(e,n){return _ReleaseRefresh.apply(this,arguments)})},{key:"ImageTransform",value:function ImageTransform(e,n,i){var r=twainBlankRequest("image/transform");switch(n.toLowerCase()){case"rotate":r.data.angle=i.angle;break;case"deskew":r.data.deskew_max_angle=i.deskew_max_angle;break;case"despeckle":r.data.despeckle_mode=i.despeckle_mode,r.data.despeckle_quality=i.despeckle_quality;break;case"extract":r.data.top=i.top,r.data.bottom=i.bottom,r.data.left=i.left,r.data.right=i.right;break;case"text_annotation":r.data.top=i.top,r.data.bottom=i.bottom,r.data.left=i.left,r.data.right=i.right,r.data.text_annotation=i.text_annotation;break;case"fillcolor":case"fillcolor_outside":r.data.top=i.top,r.data.bottom=i.bottom,r.data.left=i.left,r.data.right=i.right,r.data.colour=i.colour;break;case"brightness":r.data.brightness=i.brightness;break;case"contrast":r.data.contrast=i.contrast;break;case"smooth":r.data.smoothness=i.smoothness;break;case"invert":case"dilate":case"erode":case"sharp":break;case"remove_border":r.data.min_width=i.min_width,r.data.min_height=i.min_height;break;case"remove_lines":r.data.horz_lines=i.horz_lines,r.data.vert_lines=i.vert_lines,r.data.remove_line_reattach_symbols=i.remove_line_reattach_symbols,r.data.remove_lines_maxthickness=i.remove_lines_maxthickness,r.data.remove_lines_minlength=i.remove_lines_minlength;break;case"bpp":r.data.dither_arg=i.dither_arg,r.data.bpp=i.bpp;break;default:throw new Error("Image Operaion not Implemented")}return r.data.number=e,r.data.operation=n,this.make_request_promise(r)}},{key:"ImageInfo",value:(_ImageInfo=_asyncToGenerator(_regeneratorRuntime().mark((function _callee31(e){var n,i;return _regeneratorRuntime().wrap((function _callee31$(r){for(;;)switch(r.prev=r.next){case 0:return(n=twainBlankRequest("image/info")).data.number=e,n.data.level="blackpixelcount",r.prev=3,r.next=6,this.make_request_promise(n);case 6:return i=r.sent,r.abrupt("return",i);case 10:r.prev=10,r.t0=r.catch(3);case 13:case"end":return r.stop()}}),_callee31,this,[[3,10]])}))),function ImageInfo(e){return _ImageInfo.apply(this,arguments)})},{key:"GetFileInfo",value:(_GetFileInfo=_asyncToGenerator(_regeneratorRuntime().mark((function _callee32(e){var n,i;return _regeneratorRuntime().wrap((function _callee32$(r){for(;;)switch(r.prev=r.next){case 0:return(n=twainBlankRequest("importedimage/info")).data.number=e,r.prev=2,r.next=5,this.make_request_promise(n);case 5:return i=r.sent,r.abrupt("return",i);case 9:r.prev=9,r.t0=r.catch(2);case 12:case"end":return r.stop()}}),_callee32,this,[[2,9]])}))),function GetFileInfo(e){return _GetFileInfo.apply(this,arguments)})},{key:"Reserve",value:function Reserve(e){var n;if(e&&(this.url=e),"none"!=this.pulse.state)return!1;(n=twainBlankRequest("reserve")).data.name=this.appname,n.data.inactive_mins=this.appConfig.SERVICETIMEOUT,n.data.licence_data=this.appConfig.LICENSE;var i=!1;try{i=this.make_request(n)}catch(e){i=!1}return i}},{key:"getInfo",value:(_getInfo=_asyncToGenerator(_regeneratorRuntime().mark((function _callee33(){var e,n;return _regeneratorRuntime().wrap((function _callee33$(i){for(;;)switch(i.prev=i.next){case 0:return e=twainBlankRequest("info"),n=null,i.prev=2,i.next=5,this.make_request_promise(e);case 5:n=i.sent,i.next=11;break;case 8:i.prev=8,i.t0=i.catch(2);case 11:return i.abrupt("return",n);case 12:case"end":return i.stop()}}),_callee33,this,[[2,8]])}))),function getInfo(){return _getInfo.apply(this,arguments)})},{key:"AcquireFolder",value:(_AcquireFolder=_asyncToGenerator(_regeneratorRuntime().mark((function _callee34(e,n,i,r,a,c){var u,h;return _regeneratorRuntime().wrap((function _callee34$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.CheckAndDisableSoruce();case 2:return u=twainBlankRequest("acquire/folder"),this.selectType=InsertType.INSERT_END,void 0!==e&&(u.data.filepattern=e),void 0!==n&&(u.data.max_pages=n),void 0!==i&&(u.data.recurse=i),void 0!==r&&(u.data.restrict=r),u.data.title=void 0!==a?a:"Select a folder containing image file",this.Acquiring=!0,h=this,c.prev=11,c.next=14,this.make_request_promise(u);case 14:return c.abrupt("return",c.sent);case 15:return c.prev=15,h.Acquiring=!1,c.finish(15);case 18:case"end":return c.stop()}}),_callee34,this,[[11,,15,18]])}))),function AcquireFolder(e,n,i,r,a,c){return _AcquireFolder.apply(this,arguments)})},{key:"have_pulse_data",value:function have_pulse_data(e,n){var i,r,a,c,u,h,p;if(e.response.length!=n.total_length&&!((i=e.response.lastIndexOf("\n"))<0)){for(u=(r=e.response.substring(n.total_length,i)).split("\n"),h=n.total_length,c=0;c<u.length;c++)if(0!=(p=(r=u[c]).trim()).length){try{a=JSON.parse(p),h+=r.length+1,this.pulse.addMessage(a)}catch(e){a=null}if(null==a)break}else h+=r.length+1;n.total_length=h}}},{key:"ImageGet",value:function ImageGet(e){var n=twainBlankRequest("image/get");return n.data.number=e,this.make_request_promise(n)}},{key:"GetAppendedFile",value:function GetAppendedFile(e){var n=twainBlankRequest("importedimage/get");return n.data.number=e,this.make_request_promise(n)}},{key:"have_json_data",value:function have_json_data(xhr){var l,s,o,t;if(0!=xhr.response.length&&4==xhr.readyState&&200==xhr.status){s=xhr.response;try{o=JSON.parse(s)}catch(e){o=null}if(!o)try{eval("o = "+s+";")}catch(e){o=null}return o&&this.have_response(this.request,o),o}}},{key:"have_image_data",value:function have_image_data(e){if(200==e.status&&4==e.readyState){var n=new Blob([e.response],{type:e.getResponseHeader("Content-Type")}),i=window.URL.createObjectURL(n);try{"image/get"==this.request.method?this.have_image(this.request,i):"image/thumbnail"==this.request.method?this.have_thumbnail(this.request,i):"output/get"==this.request.method&&this.have_output(this.request,i)}catch(e){}return i}}},{key:"failed_reserve_state",value:function failed_reserve_state(){this.http_request.status,this.http_request.readyState;twainStatus.active=!1}},{key:"have_reserve_state",value:function have_reserve_state(e){var n=this.http_request.status,i=this.http_request.readyState,r=this.http_request.response;try{r=JSON.parse(r)}catch(e){}this.http_request.readyState===XMLHttpRequest.DONE&&(twainStatus.isRequestInProgress=!1),200==n?(i==XMLHttpRequest.LOADING&&this.updateStatus(),i==XMLHttpRequest.DONE&&r&&r.method&&r.status&&"reserve"==r.method&&(twainStatus.active=!1)):404==n&&(twainStatus.active=!1)}},{key:"updateStatus",value:function updateStatus(){var e=this.getTwainCurrentStatus();e&&e.method&&e.status&&"reserve"==e.method&&("success"==e.status&&(twainStatus.active=!0,localStorage.setItem("TWAIN_RESERVE_INFO",JSON.stringify(e))),"error"!=e.status&&"failure"!=e.status||(twainStatus.active=!1),twainStatus.status=e)}},{key:"getTwainCurrentStatus",value:function getTwainCurrentStatus(){if(this&&this.pulse&&this.pulse.http_request&&this.pulse.http_request.response){var e=this.pulse.http_request.response;try{e=JSON.parse(e)}catch(e){return}return e}}},{key:"make_request",value:function make_request(e){var n,i,r;if(e.hasOwnProperty("data")?(remove_null_properties(e.data),n="get"==e.kind?make_query_string(e.data):JSON.stringify(e.data)):n="",r=this.http_request=new XMLHttpRequest,this.request=e,i=!1,"reserve"==e.method){twainStatus.isRequestInProgress=!0,this.pulse.reserve_request=e,this.pulse.http_request=r;var a={total_length:0};r.onprogress=this.have_pulse_data.bind(this,r,a),r.onload=this.OnReleased.bind(this,!1),r.onreadystatechange=this.have_reserve_state.bind(this,r),r.onerror=this.failed_reserve_state.bind(this,r),r.onabort=this.failed_reserve_state.bind(this,r)}else"info"==e.method?r.onload=this.have_json_data.bind(this,r):(i=!0,"image/get"==e.method||"image/thumbnail"==e.method||"output/get"==e.method?(r.responseType="blob",r.onload=this.have_image_data.bind(this,r)):r.onload=this.have_json_data.bind(this,r));return"post"==e.kind?(r.open("POST",this.url+e.method),i&&r.setRequestHeader("x-httptwain-token",this.pulse.app_token),""!=n?(r.setRequestHeader("Content-Type","application/json"),r.send(n)):r.send()):(""!=n?r.open("GET",this.url+e.method+"?"+n):r.open("GET",this.url+e.method),i&&r.setRequestHeader("x-httptwain-token",this.pulse.app_token),r.send()),!0}},{key:"make_request_promise",value:function make_request_promise(e){var n,i,r=this;return e.hasOwnProperty("data")?(remove_null_properties(e.data),n="get"==e.kind?make_query_string(e.data):JSON.stringify(e.data)):n="",new Promise((function(a,c){var u=r.http_request=new XMLHttpRequest;if(r.request=e,i=!1,"reserve"==e.method)throw"use make_request for reserver request, and this method for every other request type";return"info"==e.method?u.onload=function(){var e=r.have_json_data.call(r,u);this.status>=200&&this.status<300?a(e):c(r,u)}:(i=!0,"image/get"==e.method||"image/thumbnail"==e.method||"output/get"==e.method?(u.responseType="blob",u.onload=function(){var e=r.have_image_data.call(r,u);this.status>=200&&this.status<300?a(e):c(r,u)}):"importedimage/get"==e.method?(u.responseType="blob",u.onload=function(){var e;200==u.status&&4==u.readyState?(e=new Blob([u.response],{type:u.getResponseHeader("Content-Type")}),a(e)):c(r,u)}):u.onload=function(){var e=r.have_json_data.call(r,u);this.status>=200&&this.status<300?a(e):c(r,u)}),u.onerror=function(e,n,i){c(r,u)},"post"==e.kind?(u.open("POST",r.url+e.method),i&&u.setRequestHeader("x-httptwain-token",r.pulse.app_token),""!=n?(u.setRequestHeader("Content-Type","application/json"),u.send(n)):u.send()):(""!=n?u.open("GET",r.url+e.method+"?"+n):u.open("GET",r.url+e.method),i&&u.setRequestHeader("x-httptwain-token",r.pulse.app_token),u.send()),!0}))}},{key:"saveOutput",value:(_saveOutput=_asyncToGenerator(_regeneratorRuntime().mark((function _callee35(e,n,i,r,a,c){var u,h;return _regeneratorRuntime().wrap((function _callee35$(p){for(;;)switch(p.prev=p.next){case 0:if(u=twainBlankRequest("output/create"),e&&i){p.next=3;break}return p.abrupt("return");case 3:return u.data.images=e,u.data.name=i,n&&(u.data.format=n),r&&(u.data.jpeg_quality=r),a&&(u.data.stamping=a),c&&(u.data.overwrite=c),p.prev=9,p.next=12,this.make_request_promise(u);case 12:return h=p.sent,p.abrupt("return",h);case 16:p.prev=16,p.t0=p.catch(9);case 19:case"end":return p.stop()}}),_callee35,this,[[9,16]])}))),function saveOutput(e,n,i,r,a,c){return _saveOutput.apply(this,arguments)})},{key:"getOutput",value:(_getOutput=_asyncToGenerator(_regeneratorRuntime().mark((function _callee36(e,n){var i,r;return _regeneratorRuntime().wrap((function _callee36$(a){for(;;)switch(a.prev=a.next){case 0:if(i=twainBlankRequest("output/get"),e){a.next=3;break}return a.abrupt("return");case 3:return i.data.base64=!1,n&&(i.data.base64=n),i.data.name=e,a.prev=6,a.next=9,this.make_request_promise(i);case 9:return r=a.sent,a.abrupt("return",r);case 13:a.prev=13,a.t0=a.catch(6);case 17:case"end":return a.stop()}}),_callee36,this,[[6,13]])}))),function getOutput(e,n){return _getOutput.apply(this,arguments)})},{key:"getThumbnail",value:(_getThumbnail=_asyncToGenerator(_regeneratorRuntime().mark((function _callee37(e,n){var i,r;return _regeneratorRuntime().wrap((function _callee37$(a){for(;;)switch(a.prev=a.next){case 0:return(i=twainBlankRequest("image/thumbnail")).data.number=e,i.data.size=n,a.prev=3,a.next=6,this.make_request_promise(i);case 6:return r=a.sent,a.abrupt("return",r);case 10:a.prev=10,a.t0=a.catch(3);case 14:case"end":return a.stop()}}),_callee37,this,[[3,10]])}))),function getThumbnail(e,n){return _getThumbnail.apply(this,arguments)})}]);var _getThumbnail,_getOutput,_saveOutput,_AcquireFolder,_getInfo,_GetFileInfo,_ImageInfo,_ReleaseRefresh,_Download,_CopyTo2,_Upload2,_InternalOpenSource,_OpenSource,_DisableSource,_CheckAndDisableSoruce,_CloseSource,_AcquireImages,_SelectSource,_SelectFile}(),jsTwainPulse=function(){return _createClass((function jsTwainPulse(e){_classCallCheck(this,jsTwainPulse),this.messages=[],this.state="none",this.app_token="",this.pulse_count=0,this.num_success=0,this.total=0,this.errors=[],this.bymethod={},this.bymethod.info=[],this.bymethod.reserve=[],this.bymethod["twain/source/open"]=[],this.bymethod["twain/capabilities/get"]=[],this.bymethod["twain/capabilities/getcurrent"]=[],this.bymethod["twain/capabilities/getdefault"]=[],this.bymethod["twain/capabilities/querysupport"]=[],this.bymethod["twain/capabilities/reset"]=[],this.bymethod["twain/capabilities/set"]=[],this.bymethod["twain/source/enable"]=[],this.bymethod["image/count"]=[],this.bymethod["image/get"]=[],this.bymethod["image/thumbnail"]=[],this.bymethod["image/info"]=[],this.bymethod["image/transform"]=[],this.bymethod["twain/source/disable"]=[],this.bymethod["twain/source/close"]=[],this.bymethod["output/create"]=[],this.bymethod["output/get"]=[],this.bymethod["output/upload"]=[],this.bymethod["output/copyto"]=[],this.bymethod["acquire/file"]=[],this.bymethod["acquire/folder"]=[],this.bymethod["acquire/download"]=[],this.bymethod["twain/profile/create"]=[],this.bymethod["twain/profile/view"]=[],this.bymethod["twain/profile/edit"]=[],this.bymethod["twain/profile/add"]=[],this.bymethod["twain/profile/get"]=[],this.bymethod.release=[],this.bymethod.disablesource=[],this.http_request=null,this.reserve_request=null,this.current_length=0,this.total_length=0,this.twain=e;var n=[];for(var i in this.bymethod)this.bymethod.hasOwnProperty(i)&&n.push(i);if(!AddEventSupport(this,n))throw"failed to add event support to twain pulse instance";return this}),[{key:"addMessage",value:function addMessage(e){var n;if("expired"==this.state)return twainStatus.active=!1,!1;if(e.hasOwnProperty("-"))return this.pulse_count++,!0;if(this.total++,e.index=this.messages.length,e.when=new Date,this.messages.push(e),n="",e.hasOwnProperty("method")){if(""==(n=e.method))return e.hasOwnProperty("data")&&"bye inactive client"==e.data&&(this.state="expired","function"==typeof this.twain.OnReleased&&(this.twain.OnReleased(!0),this.twain.pulse.http_request.abort()),twainStatus.active=!1),!0;"reserve"==n&&e.hasOwnProperty("status")&&"success"==e.status&&(this.app_token=e.token,this.state="reserved",this.twain.have_response(this.reserve_request,e),twainStatus.active=!0),this.bymethod[e.method].push(e);try{this.DispatchEvent(e.method,e)}catch(e){}}return e.hasOwnProperty("status")&&("error"==e.status||"failure"==e.status?this.errors.push(e):"success"==e.status&&this.num_success++),"acquire/folder"!=n&&"acquire/file"!=n&&"twain/source/enable"!=n&&"acquire/download"!=n||"function"==typeof this.twain.acquired_image&&this.twain.acquired_image(n,e),!0}}])}();return{jsTwainPulse,jsTwain}}(),GetCustomEventData=function GetCustomEventData(e,n){if(e instanceof twainCtrl.jsTwainPulse)return n[e.getEvtDataPropName()]},ClassifyURL=function ClassifyURL(e){return"string"==typeof e&&new RegExp("^blob:http[s]?://","gmi").test(e)?IWizURLAttributes.URLATTRIBUTE_BLOBURL:e instanceof File?IWizURLAttributes.URLATTRIBUTE_DRIVE_FILE:IWizURLAttributes.URLATTRIBUTE_INTERNET_SCHEME},clearChildren=function clearChildren(e){if(e)for(;e.lastElementChild;)e.removeChild(e.lastElementChild)},IWIZmoveItem=function IWIZmoveItem(e,n,i,r){for(var a=e.splice(n,i),c=0;c<a.length;c++)e.splice(r++,0,a[c])};function AddEventSupport(e,n,i,r,a){if(e){if(!1 in e)return!0;if(document&&"dispatchEvent"in document&&"addEventListener"in document&&"removeEventListener"in document&&window){if("_EventEmitter"in e)return!0;if(e&&n){var c={};if("object"==_typeof(n)&&"[object Array]"==Object.prototype.toString.call(n)){for(u=0,h=n.length;u<h;u++)c[n[u]]=n[u];if(0==h)return}!function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function CustomEvent(e,n){n=n||{bubbles:!1,cancelable:!1,detail:null};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),i}}();var u,h,p=["EVENT_DATA_PROP","CUSTM_EVENT_NAME_PREFIX","SupportedEvents","_DispatchEvent","GetSupportedEvents","getEvtDataPropName"],d=Object.keys(e),f=[];for(u=0,h=p.length;u<h;u++)-1!=d.indexOf(p[u])&&f.push(p[u]);if(!f.length)return Object.defineProperty(e,"_EventEmitter",{value:{_getRandomString:function _getRandomString(){var e=2147483648;return Math.floor(Math.random()*e).toString(36)+Math.abs(Math.floor(Math.random()*e)^(new Date).getTime()).toString(36)},EVENT_DATA_PROP:i||"EVENTDATA",CUSTM_EVENT_NAME_PREFIX:r||"_custom_event_dispatcher_",no_uid_prefix:a,_unique_string:"",SupportedEvents:c},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(e,"_getDispatchEventName",{value:function GetCustomEventNameForDispatch(e){return this._EventEmitter.CUSTM_EVENT_NAME_PREFIX+this._EventEmitter._unique_string+"_"+e},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(e,"DispatchEventWithPromise",{value:function customEventDispatcher(e,n){return function(e){var n=function timeoutCb(e,n,i){!!document.dispatchEvent(e)?n():i()},i=new CustomEvent(this._getDispatchEventName(e[0]));i[this._EventEmitter.EVENT_DATA_PROP]=e[1];return new Promise((function executor(e,r){setTimeout(n.bind(this,i,e,r),0)}))}.call(this,arguments)},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(e,"DispatchEvent",{value:function customEventDispatcher(e,n){var i=new CustomEvent(this._getDispatchEventName(e));return i[this._EventEmitter.EVENT_DATA_PROP]=n,!!document.dispatchEvent(i)},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(e,"DispatchEventAsync",{value:function customEventDispatcher(e,n,i,r){return function(e){var n=this,i=new CustomEvent(this._getDispatchEventName(e[0]));i[this._EventEmitter.EVENT_DATA_PROP]=e[1],setTimeout(function timeoutCb(e,i,r){!!document.dispatchEvent(e)&&i?setTimeout(i.bind(n)):r&&setTimeout(r.bind(n))}.bind(this,i,e[2],e[3]),0)}.call(this,arguments)},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(e,"GetSupportedEvents",{value:function value(){return Object.keys(this._EventEmitter.SupportedEvents)},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(e,"getEvtDataPropName",{value:function value(){return this._EventEmitter.EVENT_DATA_PROP},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(e,"addEventListener",{value:function value(e,n){return!0!==this._EventEmitter.no_uid_prefix&&""==this._EventEmitter._unique_string&&(this._EventEmitter._unique_string=this._EventEmitter._getRandomString()),!!this._EventEmitter.SupportedEvents[e]&&(document.addEventListener(this._getDispatchEventName(e),n),!0)},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(e,"removeEventListener",{value:function value(e,n){return!!this._EventEmitter.SupportedEvents[e]&&(document.removeEventListener(this._getDispatchEventName(e),n),!0)},enumerable:!1,configurable:!1,writable:!1}),!0}}}}return{init:initialise,getTwain,getTwainStatus}}();module.exports=exWebDocViewerCtrl},595:e=>{function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return n};var e,n={},i=Object.prototype,r=i.hasOwnProperty,a=Object.defineProperty||function(e,n,i){e[n]=i.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",h=c.asyncIterator||"@@asyncIterator",p=c.toStringTag||"@@toStringTag";function define(e,n,i){return Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{define({},"")}catch(e){define=function define(e,n,i){return e[n]=i}}function wrap(e,n,i,r){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype),h=new Context(r||[]);return a(u,"_invoke",{value:makeInvokeMethod(e,i,h)}),u}function tryCatch(e,n,i){try{return{type:"normal",arg:e.call(n,i)}}catch(e){return{type:"throw",arg:e}}}n.wrap=wrap;var d="suspendedStart",f="suspendedYield",m="executing",g="completed",v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var w={};define(w,u,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(values([])));b&&b!==i&&r.call(b,u)&&(w=b);var _=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(w);function defineIteratorMethods(e){["next","throw","return"].forEach((function(n){define(e,n,(function(e){return this._invoke(n,e)}))}))}function AsyncIterator(e,n){function invoke(i,a,c,u){var h=tryCatch(e[i],e,a);if("throw"!==h.type){var p=h.arg,d=p.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?n.resolve(d.__await).then((function(e){invoke("next",e,c,u)}),(function(e){invoke("throw",e,c,u)})):n.resolve(d).then((function(e){p.value=e,c(p)}),(function(e){return invoke("throw",e,c,u)}))}u(h.arg)}var i;a(this,"_invoke",{value:function value(e,r){function callInvokeWithMethodAndArg(){return new n((function(n,i){invoke(e,r,n,i)}))}return i=i?i.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(n,i,r){var a=d;return function(c,u){if(a===m)throw Error("Generator is already running");if(a===g){if("throw"===c)throw u;return{value:e,done:!0}}for(r.method=c,r.arg=u;;){var h=r.delegate;if(h){var p=maybeInvokeDelegate(h,r);if(p){if(p===v)continue;return p}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===d)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var w=tryCatch(n,i,r);if("normal"===w.type){if(a=r.done?g:f,w.arg===v)continue;return{value:w.arg,done:r.done}}"throw"===w.type&&(a=g,r.method="throw",r.arg=w.arg)}}}function maybeInvokeDelegate(n,i){var r=i.method,a=n.iterator[r];if(a===e)return i.delegate=null,"throw"===r&&n.iterator.return&&(i.method="return",i.arg=e,maybeInvokeDelegate(n,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var c=tryCatch(a,n.iterator,i.arg);if("throw"===c.type)return i.method="throw",i.arg=c.arg,i.delegate=null,v;var u=c.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,v)}function pushTryEntry(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function resetTryEntry(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(n){if(n||""===n){var i=n[u];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,c=function next(){for(;++a<n.length;)if(r.call(n,a))return next.value=n[a],next.done=!1,next;return next.value=e,next.done=!0,next};return c.next=c}}throw new TypeError(_typeof(n)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,a(_,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),a(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===GeneratorFunction||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,p,"GeneratorFunction")),e.prototype=Object.create(_),e},n.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,h,(function(){return this})),n.AsyncIterator=AsyncIterator,n.async=function(e,i,r,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(e,i,r,a),c);return n.isGeneratorFunction(i)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},defineIteratorMethods(_),define(_,p,"Generator"),define(_,u,(function(){return this})),define(_,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),i=[];for(var r in n)i.push(r);return i.reverse(),function next(){for(;i.length;){var e=i.pop();if(e in n)return next.value=e,next.done=!1,next}return next.done=!0,next}},n.values=values,Context.prototype={constructor:Context,reset:function reset(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!n)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function dispatchException(n){if(this.done)throw n;var i=this;function handle(r,a){return u.type="throw",u.arg=n,i.next=r,a&&(i.method="next",i.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var c=this.tryEntries[a],u=c.completion;if("root"===c.tryLoc)return handle("end");if(c.tryLoc<=this.prev){var h=r.call(c,"catchLoc"),p=r.call(c,"finallyLoc");if(h&&p){if(this.prev<c.catchLoc)return handle(c.catchLoc,!0);if(this.prev<c.finallyLoc)return handle(c.finallyLoc)}else if(h){if(this.prev<c.catchLoc)return handle(c.catchLoc,!0)}else{if(!p)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return handle(c.finallyLoc)}}}},abrupt:function abrupt(e,n){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===e||"continue"===e)&&c.tryLoc<=n&&n<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=e,u.arg=n,c?(this.method="next",this.next=c.finallyLoc,v):this.complete(u)},complete:function complete(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),v},finish:function finish(e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),resetTryEntry(i),v}},catch:function _catch(e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var a=r.arg;resetTryEntry(i)}return a}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(n,i,r){return this.delegate={iterator:values(n),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),v}},n}function asyncGeneratorStep(e,n,i,r,a,c,u){try{var h=e[c](u),p=h.value}catch(e){return void i(e)}h.done?n(p):Promise.resolve(p).then(r,a)}function _asyncToGenerator(e){return function(){var n=this,i=arguments;return new Promise((function(r,a){var c=e.apply(n,i);function _next(e){asyncGeneratorStep(c,r,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(c,r,a,_next,_throw,"throw",e)}_next(void 0)}))}}function _defineProperties(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,n,i){return n&&_defineProperties(e.prototype,n),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,n,i){return(n=_toPropertyKey(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function _toPropertyKey(e){var n=function _toPrimitive(e,n){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,n||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==_typeof(n)?n:n+""}var n=_createClass((function QuickCapture(){var e=this;!function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,QuickCapture),_defineProperty(this,"init",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(e,n,i){return _regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return this.exWebDocView=new exWebDocViewer,r.next=3,this.exWebDocView.init(e,n,i);case 3:if(this.jsImageWizViewer=r.sent,this.exWebDocView.setInterface(this),this.Viewer=this.jsImageWizViewer.Viewer,this.ImageList=new Map,null!=this.Viewer){r.next=10;break}return alert("Viewer is null"),r.abrupt("return",null);case 10:if(this.Twain=this.jsImageWizViewer.GetScanner(),null!=this.Twain){r.next=14;break}return alert("Local Web Service Not Initialised!"),r.abrupt("return",null);case 14:return this.jsImageWizViewer.ViewerAutoSave=!1,this.jsImageWizViewer.FileFormat1BPP=5,this.jsImageWizViewer.FileFormatNBPP=86,this.Library=this.jsImageWizViewer.Library,this.Control=this.jsImageWizViewer,r.abrupt("return",this);case 20:case"end":return r.stop()}}),_callee,this)})));return function(n,i,r){return e.apply(this,arguments)}}()),_defineProperty(this,"RegisterEvent",(function(e,n){this.Control.AddCallBackSupport(e,n)})),_defineProperty(this,"AddLibToContent",(function(e,n,i,r){this.Viewer&&this.Viewer.Contents.AddLib(e,n,i,r)})),_defineProperty(this,"ClearContents",(function(){this.Viewer.Contents.Clear()})),_defineProperty(this,"ClearLibrary",(function(){this.Library.Clear()})),_defineProperty(this,"AddContent",(function(e,n,i,r,a){return!!this.Viewer&&this.Viewer.Contents.Add(e,n,i,r,a)})),_defineProperty(this,"SaveViewer",(function(e){return this.Viewer.Save(e)})),_defineProperty(this,"ClearDisplay",(function(){return this.Viewer.CloseImage()})),_defineProperty(this,"IsPageModified",(function(){return this.Viewer.Image.Modified})),_defineProperty(this,"SetViewerFocus",(function(){this.Viewer.SetFocus()})),_defineProperty(this,"LoadImage",(function(e,n){return this.Library.LoadImage(e,n)})),_defineProperty(this,"SaveImage",(function(e,n){var i;return i=this.Viewer.Contents.Index(e),n.BitsPerPixel>1?n.SaveAs(this.jsImageWizViewer.Viewer.Contents.IWizURLUsage(i).TempFileName(1),86):n.SaveAs(this.jsImageWizViewer.Viewer.Contents.IWizURLUsage(i).TempFileName(1),5)})),_defineProperty(this,"EnableMultiSelect",(function(e){this.MultiSelect=!!e})),_defineProperty(this,"SetInputFileFilter",(function(e){"object"==_typeof(e)&&2==e.length&&(this.supportedInputFileFilter=e)})),_defineProperty(this,"AppendFromFile",_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(){var e,n;return _regeneratorRuntime().wrap((function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:return e=this,this.AttachType=1,i.prev=2,i.next=5,e.Twain.SelectFile("Select Image",this.supportedInputFileFilter,499,this.MultiSelect,!0,1);case 5:if((n=i.sent)&&n.status&&"success"==n.status){i.next=8;break}return i.abrupt("return",!1);case 8:return i.abrupt("return",n);case 11:return i.prev=11,i.t0=i.catch(2),i.abrupt("return",!1);case 15:case 16:case"end":return i.stop()}}),_callee2,this,[[2,11]])})))),_defineProperty(this,"InsertAtCurrentPage",_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(){var e,n;return _regeneratorRuntime().wrap((function _callee3$(i){for(;;)switch(i.prev=i.next){case 0:if(e=this,0!=this.TotalElementCount){i.next=3;break}return i.abrupt("return");case 3:return this.AttachType=1,i.prev=4,i.next=7,e.Twain.SelectFile("Select Image",this.supportedInputFileFilter,499,this.MultiSelect,!0,2);case 7:if((n=i.sent)&&n.status&&"success"==n.status){i.next=12;break}return i.abrupt("return",!1);case 12:return i.abrupt("return",!0);case 13:i.next=19;break;case 15:return i.prev=15,i.t0=i.catch(4),i.abrupt("return",!1);case 19:case 20:case"end":return i.stop()}}),_callee3,this,[[4,15]])})))),_defineProperty(this,"InsertBeforeCurrentPage",_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(){var e,n;return _regeneratorRuntime().wrap((function _callee4$(i){for(;;)switch(i.prev=i.next){case 0:if(e=this,0!=this.TotalElementCount){i.next=3;break}return i.abrupt("return");case 3:return this.AttachType=1,i.prev=4,i.next=7,e.Twain.SelectFile("Select Image",this.supportedInputFileFilter,499,this.MultiSelect,!0,3);case 7:if((n=i.sent)&&n.status&&"success"==n.status){i.next=12;break}return i.abrupt("return",!1);case 12:return i.abrupt("return",!0);case 13:i.next=19;break;case 15:return i.prev=15,i.t0=i.catch(4),i.abrupt("return",!1);case 19:case 20:case"end":return i.stop()}}),_callee4,this,[[4,15]])})))),_defineProperty(this,"InsertAfterCurrentPage",_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(){var e,n;return _regeneratorRuntime().wrap((function _callee5$(i){for(;;)switch(i.prev=i.next){case 0:if(e=this,0!=this.TotalElementCount){i.next=3;break}return i.abrupt("return");case 3:return this.AttachType=1,i.prev=4,i.next=7,e.Twain.SelectFile("Select Image",this.supportedInputFileFilter,499,this.MultiSelect,!0,4);case 7:if((n=i.sent)&&n.status&&"success"==n.status){i.next=12;break}return i.abrupt("return",!1);case 12:return i.abrupt("return",!0);case 13:i.next=19;break;case 15:return i.prev=15,i.t0=i.catch(4),i.abrupt("return",!1);case 19:case 20:case"end":return i.stop()}}),_callee5,this,[[4,15]])})))),_defineProperty(this,"AppendFromFolder",(function(e){return this.AttachType=1,this.Twain.AcquireFolder(["All files","*"],499,!1,!0,"Select Image",1).then((function(e){if("success"==e.status)return!0})).catch((function(e){}))})),_defineProperty(this,"HaveImage",(function(){return this.Viewer.ContentIndex>0})),_defineProperty(this,"getServiceInfo",(function(){return this.Twain.getInfo()})),_defineProperty(this,"triggerHttpTwain",(function(){return this.exWebDocView.triggerHttpTwain()})),_defineProperty(this,"refreshNav",(function(){return this.exWebDocView.refreshNav()})),_defineProperty(this,"CanNavigate",(function(e){switch(e){case"nextpage":case"lastpage":return this.CurrentPage!=this.RangeEnd;case"firstpage":case"prevpage":return this.CurrentPage!=this.RangeStart;case"gotopage":if(this.TotalPageCount()>0)return!0}})),_defineProperty(this,"LimitPageRange",(function(e,n){this.RangeStart=e>0?e:1;var i=this.TotalPageCount();(0==n||n>i)&&(n=i),this.RangeEnd=n})),_defineProperty(this,"NavigateToPage",(function(e,n){var i=this.SingleDocument?-5:-10;switch(e){case"firstpage":0!=this.RangeStart?(this.Viewer.NavigateTo(i,this.RangeStart),this.CurrentPage=this.RangeStart):(this.Viewer.NavigateTo(i,1),this.CurrentPage=1);break;case"prevpage":this.CurrentPage>this.RangeStart&&(this.Viewer.NavigateTo(i,this.CurrentPage-1),this.CurrentPage=this.CurrentPage-1);break;case"nextpage":this.CurrentPage<this.RangeEnd&&(this.Viewer.NavigateTo(i,this.CurrentPage+1),this.CurrentPage=this.CurrentPage+1);break;case"lastpage":0!=this.RangeEnd&&(this.Viewer.NavigateTo(i,this.RangeEnd),this.CurrentPage=this.RangeEnd);break;case"gotopage":n&&(this.Viewer.NavigateTo(i,n),this.CurrentPage=n)}return!0})),_defineProperty(this,"TotalElementCount",(function(){return this.Viewer?this.Viewer.Contents.NumElements():0})),_defineProperty(this,"TotalPageCount",(function(){return this.Viewer?this.Viewer.Contents.NumPages:0})),_defineProperty(this,"CurrentIndex",(function(){return this.Viewer.CurrentContentIndex})),_defineProperty(this,"RotateFine",(function(e){return!!this.Viewer.Image&&this.Viewer.Image.RotateFine(e,OLE_COLOR.White)})),_defineProperty(this,"Rotate",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(e){var n,i;return _regeneratorRuntime().wrap((function _callee6$(r){for(;;)switch(r.prev=r.next){case 0:if(this.Viewer.Image){r.next=2;break}return r.abrupt("return");case 2:return n=this,r.next=5,n.Viewer.Rotate(e);case 5:return i=r.sent,r.abrupt("return",i);case 7:case"end":return r.stop()}}),_callee6,this)})));return function(n){return e.apply(this,arguments)}}()),_defineProperty(this,"DirectTransform",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee7(e,n,i){var r,a;return _regeneratorRuntime().wrap((function _callee7$(c){for(;;)switch(c.prev=c.next){case 0:if(this.Viewer.Image){c.next=2;break}return c.abrupt("return");case 2:return r=this,c.next=5,r.Viewer.Image.ImgTransform(e,n,i);case 5:return a=c.sent,c.abrupt("return",a);case 7:case"end":return c.stop()}}),_callee7,this)})));return function(n,i,r){return e.apply(this,arguments)}}()),_defineProperty(this,"GetPageAttribute",(function(e){if(this.Viewer&&this.Viewer.ContentIndex){var n,i;if(e<=0)return;this.SingleDocument?(n=1,i=e||this.Viewer.ContentPage):(n=e-1,i=1);var r=this.Viewer.Contents.IWizURLUsage(n);if(r)return r.PageAttribute(i)}})),_defineProperty(this,"SetPageAttribute",(function(e,n){if(this.Viewer&&this.Viewer.ContentIndex){var i,r;if(n<=0)return;this.SingleDocument?(i=1,r=n||this.Viewer.ContentPage):(i=n-1,r=1);var a=this.Viewer.Contents.IWizURLUsage(i);if(a)return a.SetPageAttribute(r,e),!0}})),_defineProperty(this,"Scroll",(function(e,n){var i;switch(1==arguments.length&&(n=0),e){case"up":i=1;break;case"down":i=2;break;case"left":i=3;break;case"right":i=4;break;case"pageup":i=5;break;case"pagedown":i=6;break;case"pageright":i=7;break;case"pageleft":i=8;break;case"x":if(1==arguments.length)return!1;i=9;break;case"y":if(1==arguments.length)return!1;i=10;break;default:return!1}return this.Viewer.Scroll(i,n)})),_defineProperty(this,"SetDisplayOption",(function(e){switch(e){case"fitwidth":this.Viewer.FitWidth();break;case"fitlength":case"fitheight":this.Viewer.FitHeight();break;case"fitpage":case"fitwindow":this.Viewer.FitPage();break;case"HRevert":this.Viewer.HRevert();break;case"VRevert":case"VRevert":this.Viewer.VRevert();break;case"rotateLeft":this.Viewer.rotateLeft();break;case"rotateRight":this.Viewer.rotateRight();break;case"reset":this.Viewer.reset()}})),_defineProperty(this,"SetZoomFactor",(function(e){var n=parseFloat(e);n&&(this.Viewer.SetZoomFactor=n)})),_defineProperty(this,"SetZoomFactorWithZoom",(function(e){var n=parseFloat(e);!isNaN(n)&&n>-1&&(this.Viewer.SetZoomFactor=n,this.Viewer.ZoomIn())})),_defineProperty(this,"DoZoom",(function(e){switch(e){case"zoomin":case"in":this.Viewer.ZoomIn();break;case"zoomout":case"out":this.Viewer.ZoomOut()}})),_defineProperty(this,"DrawAnnotation",(function(e){return this.Viewer.DrawAnnotation(e)})),_defineProperty(this,"CopyAndCropImage",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee8(e,n,i,r){var a,c,u;return _regeneratorRuntime().wrap((function _callee8$(h){for(;;)switch(h.prev=h.next){case 0:if(a=this.Viewer.Image){h.next=3;break}return h.abrupt("return");case 3:if(c=a.Copy()){h.next=6;break}return h.abrupt("return");case 6:return h.next=8,c.Crop(e,n,i,r);case 8:if((u=h.sent)&&u.image_index){h.next=11;break}return h.abrupt("return",null);case 11:return h.abrupt("return",c);case 12:case"end":return h.stop()}}),_callee8,this)})));return function(n,i,r,a){return e.apply(this,arguments)}}()),_defineProperty(this,"CropAndAppedImage",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee9(e,n,i,r){var a,c;return _regeneratorRuntime().wrap((function _callee9$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.CopyAndCropImage(e,n,i,r);case 2:if(null!=(a=u.sent)){u.next=5;break}return u.abrupt("return",!1);case 5:(c=ObjScanInterface.GetNewOutputObj("Temp_crop_output")).AddImage(a),c.AppendToViewerContent(),c=null,this.LimitPageRange(0,0),this.NavigateToPage("lastpage",0);case 11:case"end":return u.stop()}}),_callee9,this)})));return function(n,i,r,a){return e.apply(this,arguments)}}()),_defineProperty(this,"GetCroppedImage",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee10(e,n,i,r){var a,c,u,h,p;return _regeneratorRuntime().wrap((function _callee10$(d){for(;;)switch(d.prev=d.next){case 0:if(a=this.Viewer.Image){d.next=3;break}return d.abrupt("return");case 3:if(u=null,c=a.Copy()){d.next=7;break}return d.abrupt("return");case 7:return d.next=9,c.Crop(e,n,i,r);case 9:if((h=d.sent)&&h.image_index){d.next=12;break}return d.abrupt("return");case 12:return p=h.image_index,d.next=15,this.Twain.ImageGet(p);case 15:return u=d.sent,d.abrupt("return",u);case 17:case"end":return d.stop()}}),_callee10,this)})));return function(n,i,r,a){return e.apply(this,arguments)}}()),_defineProperty(this,"DoExtract",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee11(e,n,i,r,a){var c,u,h;return _regeneratorRuntime().wrap((function _callee11$(p){for(;;)switch(p.prev=p.next){case 0:c=this.Viewer.Image,h=this.Viewer,p.t0=a,p.next="overwrite"===p.t0?5:"append"===p.t0?8:"insertbefore"===p.t0?17:"insertafter"===p.t0?26:35;break;case 5:return c.Crop(e,n,i,r).then((function(e){h.ReloadCurrentImage()})),p.abrupt("return",!0);case 8:if(!(u=c.Copy())){p.next=16;break}return p.next=12,u.Crop(e,n,i,r);case 12:this.Library.AcquireImageObject(u,0),h.ReloadCurrentImage(),this.LimitPageRange(0,0),this.NavigateToPage("lastpage",1);case 16:return p.abrupt("break",35);case 17:if(!(u=c.Copy())){p.next=25;break}return p.next=21,u.Crop(e,n,i,r);case 21:this.Library.AcquireImageObject(u,3),h.ReloadCurrentImage(),this.LimitPageRange(0,0),this.NavigateToPage("gotopage",parseInt(this.CurrentPage));case 25:return p.abrupt("break",35);case 26:if(!(u=c.Copy())){p.next=34;break}return p.next=30,u.Crop(e,n,i,r);case 30:this.Library.AcquireImageObject(u,4),h.ReloadCurrentImage(),this.LimitPageRange(0,0),this.NavigateToPage("nextpage",1);case 34:return p.abrupt("break",35);case 35:case"end":return p.stop()}}),_callee11,this)})));return function(n,i,r,a,c){return e.apply(this,arguments)}}()),_defineProperty(this,"TextAnnotate",(function(e,n,i,r,a){if(this.Viewer.Image){var c=this.Viewer;this.Viewer.Image.NewTextImage(e,n,i,r,a).then((function(e){c.ReloadCurrentImage()}))}})),_defineProperty(this,"DoWhiteOut",(function(e,n,i,r){if(this.Viewer.Image){var a=this.Viewer;this.Viewer.Image.FillColour(e,n,i,r,1).then((function(e){a.ReloadCurrentImage()}))}})),_defineProperty(this,"DoBorderWhiteOut",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee12(e,n,i,r){var a;return _regeneratorRuntime().wrap((function _callee12$(c){for(;;)switch(c.prev=c.next){case 0:if(this.Viewer.Image){c.next=2;break}return c.abrupt("return");case 2:a=this.Viewer,this.Viewer.Image.FillColourOutside(e,n,i,r,1).then((function(e){a.ReloadCurrentImage()}));case 5:case"end":return c.stop()}}),_callee12,this)})));return function(n,i,r,a){return e.apply(this,arguments)}}()),_defineProperty(this,"getCurrentPgBPP",_asyncToGenerator(_regeneratorRuntime().mark((function _callee13(){return _regeneratorRuntime().wrap((function _callee13$(e){for(;;)switch(e.prev=e.next){case 0:if(this.Viewer.Image){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.Viewer.Image.SetImageInfo();case 4:return e.abrupt("return",this.Viewer.Image?this.Viewer.Image.BitsPerPixel:0);case 5:case"end":return e.stop()}}),_callee13,this)})))),_defineProperty(this,"GetImageInfo",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee14(e){var n;return _regeneratorRuntime().wrap((function _callee14$(i){for(;;)switch(i.prev=i.next){case 0:if(this.Viewer.Image){i.next=2;break}return i.abrupt("return");case 2:return i.next=4,this.Viewer.Image.SetImageInfo(e);case 4:return n=i.sent,i.abrupt("return",n);case 6:case"end":return i.stop()}}),_callee14,this)})));return function(n){return e.apply(this,arguments)}}()),_defineProperty(this,"GetFileInfo",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee15(e){var n;return _regeneratorRuntime().wrap((function _callee15$(i){for(;;)switch(i.prev=i.next){case 0:if(this.Viewer.Image){i.next=2;break}return i.abrupt("return");case 2:return e||(e=-1),i.next=5,this.Viewer.Image.SetFileInfo(e);case 5:return n=i.sent,i.abrupt("return",n);case 7:case"end":return i.stop()}}),_callee15,this)})));return function(n){return e.apply(this,arguments)}}()),_defineProperty(this,"setBrightness",(function(e){if(this.Viewer.Image){var n=this.Viewer;this.Viewer.Image.SetImageAdjustMent("brightness",e).then((function(e){n.ReloadCurrentImage()}))}})),_defineProperty(this,"setContrast",(function(e){if(this.Viewer.Image){var n=this.Viewer;this.Viewer.Image.SetImageAdjustMent("contrast",e).then((function(e){n.ReloadCurrentImage()}))}})),_defineProperty(this,"setSmoothing",(function(e){if(this.Viewer.Image){var n=this.Viewer;this.Viewer.Image.SetImageAdjustMent("smooth",e).then((function(e){n.ReloadCurrentImage()}))}})),_defineProperty(this,"Dilate",(function(){if(this.Viewer.Image){var e=this.Viewer;this.Viewer.Image.SetImageAdjustMent("dilate").then((function(n){e.ReloadCurrentImage()}))}})),_defineProperty(this,"Erode",(function(){if(this.Viewer.Image){var e=this.Viewer;this.Viewer.Image.SetImageAdjustMent("erode").then((function(n){e.ReloadCurrentImage()}))}})),_defineProperty(this,"Sharpen",(function(){if(this.Viewer.Image){var e=this.Viewer;this.Viewer.Image.SetImageAdjustMent("sharp").then((function(n){e.ReloadCurrentImage()}))}})),_defineProperty(this,"RemoveBorder",(function(e,n){if(this.Viewer.Image){var i=this.Viewer;this.Viewer.Image.SetImageAdjustMent("removeblackborder",null,e,n).then((function(e){i.ReloadCurrentImage()}))}})),_defineProperty(this,"DiscardPage",(function(){var e=this.Viewer.Contents,n=this.CurrentIndex();e&&e.Delete(n-1),n>this.TotalPageCount()&&(n=this.TotalPageCount()),n<=0&&this.ClearContents(),this.LimitPageRange(0,0),this.NavigateToPage("gotopage",n)})),_defineProperty(this,"Thumbnail",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee16(e){var n;return _regeneratorRuntime().wrap((function _callee16$(i){for(;;)switch(i.prev=i.next){case 0:return n=this.Viewer.Contents,i.next=3,n;case 3:if(!i.sent){i.next=7;break}i.t0=n.Thumbnail(e,1,80,3),i.next=8;break;case 7:i.t0="";case 8:return i.abrupt("return",i.t0);case 9:case"end":return i.stop()}}),_callee16,this)})));return function(n){return e.apply(this,arguments)}}()),_defineProperty(this,"MoveToPage",(function(e,n,i){var r=this.Viewer.Contents;return!!r&&r.Move(e,n,i)})),_defineProperty(this,"Move",(function(){var e=this.Viewer.Contents,n=this.CurrentIndex();e.Move(n,this.TotalPageCount(),1),this.LimitPageRange(0,this.RangeEnd-1),this.NavigateToPage("gotopage",n)})),_defineProperty(this,"PlaceBeforeMovedPages",(function(){var e=this.Viewer.Contents,n=this.TotalPageCount()-this.RangeEnd;e.Move(this.RangeEnd+1,this.CurrentIndex(),n),this.LimitPageRange(0,0),this.NavigateToPage("gotopage",this.CurrentIndex()+n)})),_defineProperty(this,"PlaceAfterMovedPages",(function(){this.Viewer.Contents.Move(this.RangeEnd+1,this.CurrentIndex()+1,this.TotalPageCount()-this.RangeEnd),this.LimitPageRange(0,0)})),_defineProperty(this,"SetMouseTool",(function(e){var n=this.Viewer;return!!n&&n.SetMouseTool(e)})),_defineProperty(this,"ResetMouseTool",(function(){var e=this.Viewer,n=!!e&&e.Canvas;n&&(n.handleMagnificationTool(!1),n.handleZoomMouseTool(!1),n.handlePanMouseTool(!1))})),_defineProperty(this,"DeskewPage",(function(e){if(this.Viewer.Image){var n=this.Viewer;this.Viewer.Image.Deskew(e).then((function(e){n.ReloadCurrentImage()}))}})),_defineProperty(this,"InvertPage",(function(){if(this.Viewer.Image)return this.Viewer.Invert()})),_defineProperty(this,"SetForBlackandWhite",(function(){if(this.Viewer.Image){var e=this.Viewer;this.Viewer.Image.ChangeBitDepth(1).then((function(n){e.ReloadCurrentImage()})),this.SetViewerFocus()}})),_defineProperty(this,"SetForGray",(function(){if(this.Viewer.Image){var e=this.Viewer;this.Viewer.Image.ChangeBitDepth(8).then((function(n){e.ReloadCurrentImage()})),this.SetViewerFocus()}})),_defineProperty(this,"RemoveLines",(function(e,n,i,r){if(this.Viewer.Image){var a=this.Viewer;this.Viewer.Image.RemoveLines(e,n,i,r).then((function(e){a.ReloadCurrentImage()}))}})),_defineProperty(this,"DespecklePage",(function(e,n){if(this.Viewer.Image){var i=this.Viewer;this.Viewer.Image.Despeckle(e,n).then((function(e){i.ReloadCurrentImage()}))}})),_defineProperty(this,"PrintPage",(function(){if(this.Viewer.img&&this.Viewer.Image){var e=this.Viewer.img;e.crossOrigin="anonymous";var n='<div class="print-break"><img class="print-break-img" src="'.concat(e.src,'" alt="').concat(this.exWebDocView.appConfig.APP_NAME,' Print Image"/></div>'),i=window.open("","_blank"),r="<!DOCTYPE html><html><head><title>".concat(this.exWebDocView.appConfig.APP_NAME," Print Image</title>").concat("<style>body{ text-align:center; } canvas {max-width:100%;height:auto;} div.print-break { width:100%;height:100%;page-break-before:always; } img.print-break-img { width:100%;height:auto; } @media print { img.print-break { page-break-before: always; }}</style>","</head><body>").concat(n,'<script>window.onbeforeprint=function(){adjustPageBreaks()};function adjustPageBreaks(){var e=document.querySelectorAll(".print-break");e.forEach(function(t,n){var a=t.getBoundingClientRect(),r=window.innerHeight;a.bottom>r&&n<e.length-1&&(t.style.pageBreakBefore="always")})}<\/script></body></html>');if(i){var a=i.document;a.open(),a.write(r),a.close(),i.addEventListener("load",(function(){i.print(),i.close()}))}}})),_defineProperty(this,"CloseSource",_asyncToGenerator(_regeneratorRuntime().mark((function _callee17(){return _regeneratorRuntime().wrap((function _callee17$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Twain.CloseSource();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),_callee17,this)})))),_defineProperty(this,"OpenSource",_asyncToGenerator(_regeneratorRuntime().mark((function _callee18(){return _regeneratorRuntime().wrap((function _callee18$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Twain.OpenSource();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),_callee18,this)})))),_defineProperty(this,"IsSourceOpen",(function(){return this.Twain.SourceOpen})),_defineProperty(this,"StartScanning",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee19(e,n){return _regeneratorRuntime().wrap((function _callee19$(n){for(;;)switch(n.prev=n.next){case 0:if(this.IsSourceOpen()){n.next=10;break}return this.TwainError=!1,n.next=4,this.OpenSource();case 4:if(0!=n.sent&&1!=this.TwainError){n.next=10;break}return alert("Scanner source is not open."),n.next=9,this.CloseSource();case 9:return n.abrupt("return");case 10:return n.next=12,this.Twain.AcquireImages(e,!0);case 12:n.sent;case 13:case"end":return n.stop()}}),_callee19,this)})));return function(n,i){return e.apply(this,arguments)}}()),_defineProperty(this,"SelectSource",(function(e){var n=this.Twain;return!!n&&n.SelectSource("")})),_defineProperty(this,"AppendFromScanner",_asyncToGenerator(_regeneratorRuntime().mark((function _callee20(){return _regeneratorRuntime().wrap((function _callee20$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.StartScanning(0);case 2:case"end":return e.stop()}}),_callee20,this)})))),_defineProperty(this,"InsertBeforeFromScanner",_asyncToGenerator(_regeneratorRuntime().mark((function _callee21(){return _regeneratorRuntime().wrap((function _callee21$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.StartScanning(3);case 2:case"end":return e.stop()}}),_callee21,this)})))),_defineProperty(this,"InsertAfterFromScanner",_asyncToGenerator(_regeneratorRuntime().mark((function _callee22(){return _regeneratorRuntime().wrap((function _callee22$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.StartScanning(4);case 2:case"end":return e.stop()}}),_callee22,this)})))),_defineProperty(this,"ReplacePageFromScanner",_asyncToGenerator(_regeneratorRuntime().mark((function _callee23(){return _regeneratorRuntime().wrap((function _callee23$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.StartScanning(2);case 2:case"end":return e.stop()}}),_callee23,this)})))),_defineProperty(this,"GetNewOutputObj",(function(e){return this.jsImageWizViewer.NewOutput(e)})),_defineProperty(this,"AddToOutputObj",(function(e){return e||alert("error"),e.AddViewerContents(),!this.Viewer||!this.Viewer.Contents||this.Viewer.Contents.NumPages==e.NumPages})),_defineProperty(this,"AddSpecificPageToOutput",(function(e,n){e||alert("error");for(var i=e.Parent.Viewer.Contents.DocURLList,r=i.List.length,a=0;a<r;a++){var c=i.List[a];a==n&&e.AddNewPage(c)}return!this.Viewer||!this.Viewer.Contents||this.Viewer.Contents.NumPages==e.NumPages})),_defineProperty(this,"AddLibToFinalOutput",(function(e,n,i){var r,a,c,u;for(a=this.Library.Index(i),r=0;r<n.length;r++)if(c=u=n[r],0==e.AddLibContent(a,c,u))return!1;return!0})),_defineProperty(this,"loadOutPutFromLib",(function(n,i){var r;return!!(r=e.Library.Index(i))&&0!=n.AddLibContent(r,0,0)})),_defineProperty(this,"AddOutputToFinalOutput",(function(e,n){var i;return i=n.NumPages,e.AppendOutput(n)==i})),_defineProperty(this,"CopyOutput",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee24(e,n,i){var r;return _regeneratorRuntime().wrap((function _callee24$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.CopyTo(n,i);case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),_callee24)})));return function(n,i,r){return e.apply(this,arguments)}}()),_defineProperty(this,"DeleteOutput",(function(e){e&&(e.Delete(),e.Reset())})),_defineProperty(this,"AddOutputToLibrary",(function(e,n){return this.Library.AddOutput(e,n)})),_defineProperty(this,"DownloadInstaller",(function(){this.exWebDocView.notifier.downloadInstaller("https://expack.extrieve.in/share/httptwain/v2.0.10/978872ff3242cbadd2dcee50b2ecf150e7db06583163802c2981c8be01271801/HttpTwainSetup.msi")})),_defineProperty(this,"GetVersion",(function(){return this.jsImageWizViewer.GetVersion()})),_defineProperty(this,"initStamping",(function(e,n,i){this.StampInfo=e,this.Info=n,this.UserInfo=i,this.stamping={pages:[],text:"",xpos:0,ypos:0,width_option:"resize_text"}})),_defineProperty(this,"isStampingEnabled",(function(){var e=this.StampInfo;return!!e&&!0===e.Enabled})),_defineProperty(this,"getDate",(function(){var e=new Date,n=e.getMonth()+1;return this.prefix0t(e.getDate())+" "+this.prefix0t(n)+" "+e.getFullYear()})),_defineProperty(this,"getTime",(function(){var e=new Date;e.getMonth();return this.prefix0t(e.getHours())+" "+this.prefix0t(e.getMinutes())+" "+this.prefix0t(e.getSeconds())})),_defineProperty(this,"prefix0t",(function(e){var n;return 1==(n=e+"").length?"0"+n:n})),_defineProperty(this,"getStampingDetails",(function(){var e="",n="";if(!1===this.isStampingEnabled())return"";var i=this.StampInfo,r=this.Info,a=this.UserInfo;for(var c in r){if(!0===r[c]){switch(c.toUpperCase()){case"SOURCE APPLICATION NAME":var u=i.Name;if(null==u){e="";break}e=u;break;case"DATE":var h=this.getDate();if(null==h){e="";break}e=h;break;case"TIME":var p=this.getTime();if(null==p){e="";break}e=p;break;case"USER INFO":if(a){var d=a.UserName?a.UserName:"",f=a.UserId?a.UserId:"";if(null==d||null==f){e="";break}e=d+i.Delimiter+f;break}e="";break;case"IP ADDRESS":var m="%ipv4%";0,e=m;break;case"MAC ADDRESS":var g="%macaddress%";0,e=g}void 0===n||""===n?(i.Delimiter,n=e):n=n+i.Delimiter+e}}return n})),_defineProperty(this,"getStampingObject",(function(e,n){var i=this.getStampingDetails();return""==i?null:(this.stamping.text=i,this.stamping.xpos=e,this.stamping.ypos=n,this.stamping)})),_defineProperty(this,"get_file_requestdata",(function(e){var n={};switch(e){case"df":n={multi_part:null,url:null,method:null,query_string:null,headers:null,parts:null,options:null};break;case"uf":n={name:null,method:null,url:null,filepart_name:null,multi_part:null,addl_parts:null,headers:null,options:null};break;default:n=null}return n})),_defineProperty(this,"fetchBlobAndUpload",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee25(e,n,i,r){var a,c,u,h,p,d,f;return _regeneratorRuntime().wrap((function _callee25$(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,fetch(e.mFileName);case 3:if((c=m.sent).ok){m.next=7;break}return m.abrupt("return",!1);case 7:return m.next=9,c.blob();case 9:u=m.sent,a=new File([u],e.name+".tif",{type:"image/tif"}),m.next=17;break;case 13:return m.prev=13,m.t0=m.catch(0),m.abrupt("return",!1);case 17:return m.prev=17,(h=new FormData).append("data",JSON.stringify(i)),h.append("file",a,a.name),m.next=23,fetch(n,{method:"POST",body:h,headers:r});case 23:if((p=m.sent).ok){m.next=27;break}return m.abrupt("return",!1);case 27:return m.next=29,p.text();case 29:return d=m.sent,f=JSON.parse(d.replace(/(\w+):/g,'"$1":')),m.abrupt("return",f);case 35:return m.prev=35,m.t1=m.catch(17),m.abrupt("return",!1);case 38:case"end":return m.stop()}}),_callee25,null,[[0,13],[17,35]])})));return function(n,i,r,a){return e.apply(this,arguments)}}()),_defineProperty(this,"uploadFiles",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee26(e,n,i,r,a,c){var u,h,p,d,f=this;return _regeneratorRuntime().wrap((function _callee26$(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,e.FileSize();case 2:if(m.sent,!c){m.next=21;break}return u=this.get_file_requestdata("uf"),h=this.exWebDocView.appConfig.IS_HTTPS?"1":"0",p="post"==n.toLowerCase()?"post":"get",u.method=p,u.url=i,u.multi_part=!0,u.headers=a,u.filepart_name="file",u.addl_parts=[],u.options={SSL_VERIFYPEER:h},"object"==_typeof(r)&&u.addl_parts.push(r),m.next=17,e.Upload(i,u);case 17:return d=m.sent,m.abrupt("return",d);case 21:return m.abrupt("return",new Promise((function(n,c){e&&e.mFileName&&i&&r?f.fetchBlobAndUpload(e,i,r,a).then((function(e){n(e)})).catch((function(e){c(!1)})):c(!1)})));case 22:case"end":return m.stop()}}),_callee26,this)})));return function(n,i,r,a,c,u){return e.apply(this,arguments)}}()),_defineProperty(this,"downloadFiles",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee28(e,n,i,r,a){var c,u,h,p;return _regeneratorRuntime().wrap((function _callee28$(d){for(;;)switch(d.prev=d.next){case 0:if(!a){d.next=17;break}return c=this.get_file_requestdata("df"),u=this.exWebDocView.appConfig.IS_HTTPS?"1":"0",h="post"==n.toLowerCase()?"post":"get",c.method=h,c.multi_part="post"==h,c.url=e,c.headers=r,c.multi_part&&(c.parts=[]),c.options={SSL_VERIFYPEER:u},"object"==_typeof(i)&&c.multi_part&&c.parts.push(i),d.next=13,this.Library.DownloadFile(e,c,1);case 13:return p=d.sent,d.abrupt("return",p);case 17:return d.abrupt("return",new Promise(function(){var a=_asyncToGenerator(_regeneratorRuntime().mark((function _callee27(a,c){var u,h,p,d;return _regeneratorRuntime().wrap((function _callee27$(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,e&&i||c(!1),u=new FormData,h="post"==n.toLowerCase()?"post":"get",u.append("method",h),u.append("data",JSON.stringify(i)),f.next=8,fetch(e,{method:"POST",body:u,headers:r});case 8:if(!(p=f.sent).ok){f.next=18;break}return f.next=12,p.blob();case 12:d=f.sent,new File([d],"viewer.tif",{type:"image/tif"}),a(!0),f.next=20;break;case 18:a(!1);case 20:f.next=26;break;case 22:f.prev=22,f.t0=f.catch(0),a(!1);case 26:case"end":return f.stop()}}),_callee27,null,[[0,22]])})));return function(e,n){return a.apply(this,arguments)}}()));case 18:case"end":return d.stop()}}),_callee28,this)})));return function(n,i,r,a,c){return e.apply(this,arguments)}}()),this.Viewer=null,this.ImageList=new Map,this.Twain=null,this.supportedInputFileFilter=["IMAGE Files","*.png;*.jpeg;*.jpg;*.tiff;*.tif;"],this.CurrentPage=0,this.RangeStart=this.RangeEnd=0,this.SingleDocument=!1,this.TwainError=!1,this.Library=null,this.TotalPagesDownloaded=0,this.TotalAcquiredPages=0,this.AttachType=1,this.Control=null,this.MultiSelect=!0,this.PageFileInfo=null,this.PageHasTransformation=null,this.PageNumTransformations=null,this.NumPagesWithTransformations=null,this.ResetPageRangeLimit=null,this.SetPageTransformation=null,this.WillTransformImmediately=null,this.InsertPages=null,this.AppendPages=null,this.RemovePage=null,this.SplitPages=null,this.ReplacePage=null,this.GetFileNameWithPageNumber=null,this.MarkCurrentPageRescan=null,this.PageHasMarkRescan=null,this.TotalRescanPages=null,this.CurrentPageData=null,this.CurrentPageFileInfo=null,this.CurrentPageText=null,this.CurrentPageTransformation=null,this.InterpretGotoPageText=null,this.StampInfo=null,this.Info=null,this.UserInfo=null,this.stamping=null}));e.exports=n}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];if(void 0!==n)return n.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(n,{a:n}),n},__webpack_require__.d=(e,n)=>{for(var i in n)__webpack_require__.o(n,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},__webpack_require__.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n);var __webpack_exports__={};return(()=>{"use strict";var e=__webpack_require__(521),n=__webpack_require__(556),i=__webpack_require__.n(n),r=__webpack_require__(595),a=__webpack_require__.n(r);"undefined"!=typeof window&&(window.exNotifier=e.exNotifier,window.exWebDocViewer=e.exWebDocViewer,window.exWebDocViewerCtrl=i(),window.QuickCapture=a())})(),__webpack_exports__=__webpack_exports__.default,__webpack_exports__})()));